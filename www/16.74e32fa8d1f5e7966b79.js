(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{UgJg:function(e,t,i){"use strict";i.r(t),i.d(t,"VisitReportPageModule",function(){return H});var o=i("ofXK"),n=i("3Pt+"),r=i("TEn/"),s=i("lDzL"),c=i("tyNb"),a=i("fXoL"),b=i("aHWS"),l=i("dEOI");function d(e,t){if(1&e&&(a.Qb(0,"ion-col"),a.Mb(1,"ion-img",16),a.Pb()),2&e){const e=t.$implicit;a.zb(1),a.gc("src",e.webviewPath)}}let m=(()=>{class e{constructor(e,t,i){this.route=e,this.reportVisitService=t,this.DbReportVisitService=i,this.informe_id=this.route.snapshot.params.id,this.visit_report={codigo:"",comentarios:""}}ngOnInit(){this.load_informe(this.informe_id)}load_informe(e){this.reportVisitService.getOneVisitReport(e).subscribe(e=>{this.visit_report=e,this.visit_report.comentarios=this.replaceLineBreak(this.visit_report.comentarios)})}replaceLineBreak(e){return e.replace("\n","<br />")}mail(e,t,i,o){}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(c.a),a.Lb(b.a),a.Lb(l.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-view-pdf"]],decls:76,vars:11,consts:[[3,"translucent"],["slot","start"],["slot","end"],[1,"page"],[1,"box"],[1,"clearfix_in"],["id","logo",2,"float","left"],["src","/assets/img/logo.png"],["id","logo",2,"float","right"],["id","company",1,"clearfix_in"],["id","project"],[1,"desc",3,"innerHTML"],[2,"text-align","center"],["size","small",3,"click"],[1,"row"],[4,"ngFor","ngForOf"],[3,"src"]],template:function(e,t){1&e&&(a.Qb(0,"ion-header",0),a.Qb(1,"ion-toolbar"),a.Qb(2,"ion-buttons",1),a.Mb(3,"ion-menu-button"),a.Pb(),a.Qb(4,"ion-title"),a.wc(5,"View PDF"),a.Pb(),a.Qb(6,"ion-buttons",2),a.Mb(7,"ion-back-button"),a.Pb(),a.Pb(),a.Pb(),a.Qb(8,"ion-content"),a.Qb(9,"ion-card"),a.Mb(10,"ion-card-header"),a.Qb(11,"ion-card-content"),a.Qb(12,"div",3),a.Mb(13,"div",4),a.Qb(14,"header",5),a.Qb(15,"div",6),a.Mb(16,"img",7),a.Pb(),a.Mb(17,"div",8),a.Mb(18,"br"),a.Mb(19,"br"),a.Mb(20,"br"),a.Qb(21,"h1"),a.wc(22),a.Pb(),a.Qb(23,"div",9),a.Qb(24,"div"),a.Qb(25,"span"),a.wc(26,"REPORT NUMBER:"),a.Pb(),a.wc(27),a.Pb(),a.Qb(28,"div"),a.Qb(29,"span"),a.wc(30,"DATE OF REPORT"),a.Pb(),a.wc(31),a.Pb(),a.Qb(32,"div"),a.Qb(33,"span"),a.wc(34,"REPORT BY"),a.Pb(),a.wc(35),a.Pb(),a.Pb(),a.Qb(36,"div",10),a.Qb(37,"div"),a.Qb(38,"span"),a.wc(39,"GENERAL CONTRACTOR"),a.Pb(),a.wc(40),a.Pb(),a.Qb(41,"div"),a.Qb(42,"span"),a.wc(43,"PRECISION WALL TECH PROJECT"),a.Pb(),a.wc(44),a.Pb(),a.Qb(45,"div"),a.Qb(46,"span"),a.wc(47,"PROJECT NAME"),a.Pb(),a.wc(48),a.Pb(),a.Qb(49,"div"),a.Qb(50,"span"),a.wc(51,"PROJECT ADDRESS"),a.Pb(),a.wc(52),a.Pb(),a.Pb(),a.Pb(),a.Qb(53,"main"),a.Qb(54,"table"),a.Qb(55,"thead"),a.Qb(56,"tr"),a.Qb(57,"th"),a.wc(58,"Comments"),a.Pb(),a.Pb(),a.Pb(),a.Qb(59,"tbody"),a.Qb(60,"tr"),a.Mb(61,"td",11),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Mb(62,"br"),a.Mb(63,"br"),a.Mb(64,"br"),a.Mb(65,"br"),a.Qb(66,"div",12),a.Qb(67,"ion-button",13),a.Yb("click",function(){return t.mail(t.visit_report.informe_proyecto_id,t.visit_report.proyecto_id,t.visit_report.nombre_proyecto,t.visit_report.codigo)}),a.wc(68,"Send by e-mail"),a.Pb(),a.Pb(),a.Pb(),a.Qb(69,"div",3),a.Qb(70,"h5",12),a.wc(71,"Pictures"),a.Pb(),a.Qb(72,"div",14),a.Qb(73,"ion-grid"),a.Qb(74,"ion-row"),a.uc(75,d,2,1,"ion-col",15),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb()),2&e&&(a.gc("translucent",!0),a.zb(22),a.yc("Field Visit Report ",t.visit_report.codigo,""),a.zb(5),a.yc(" ",t.visit_report.codigo,""),a.zb(4),a.yc(" ",t.visit_report.fecha," "),a.zb(4),a.xc(t.visit_report.nombre_empleado),a.zb(5),a.xc(t.visit_report.nombre_empresa),a.zb(4),a.xc(t.visit_report.codigo_proyecto),a.zb(4),a.xc(t.visit_report.nombre_proyecto),a.zb(4),a.yc("",t.visit_report.dirrecion_proyecto," "),a.zb(9),a.gc("innerHTML",t.replaceLineBreak(t.visit_report.comentarios),a.qc),a.zb(14),a.gc("ngForOf",t.visit_report.images))},directives:[r.t,r.Q,r.g,r.C,r.P,r.d,r.e,r.p,r.h,r.j,r.i,r.f,r.s,r.G,o.j,r.o,r.v],styles:['.clearfix_in[_ngcontent-%COMP%]:after{content:"";display:table;clear:both}body[_ngcontent-%COMP%]{position:relative;width:19cm;height:25.7cm;margin:0 auto;color:#001028;background:#fff;font-family:Arial,sans-serif;font-size:12px;font-family:Arial}.clearfix_in[_ngcontent-%COMP%]{padding:10px 0}#logo[_ngcontent-%COMP%]{text-align:center;margin-bottom:10px}#logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:90px}.column[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:6.5cm}.column[_ngcontent-%COMP%]{padding-bottom:10px}.cols[_ngcontent-%COMP%], .column[_ngcontent-%COMP%]{text-align:center}.cols[_ngcontent-%COMP%]{display:table;width:100%;padding-top:50px}.cols[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:table-cell}h1[_ngcontent-%COMP%]{border-top:1px solid #5d6975;border-bottom:1px solid #5d6975;color:#5d6975;font-size:2.4em;line-height:1.4em;font-weight:400;text-align:center;margin:0 0 20px;background:url(https://s3-eu-west-1.amazonaws.com/htmlpdfapi.production/free_html5_invoice_templates/example1/dimension.png)}#project[_ngcontent-%COMP%]{float:left}#company[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:left;width:130px}#company[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], #project[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#5d6975;margin-right:10px;display:inline-block;font-size:.8em}#project[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:right;width:175px}#company[_ngcontent-%COMP%]{float:right}#company[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], #project[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{white-space:nowrap}p[_ngcontent-%COMP%]{margin-top:0;margin-bottom:12px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border-spacing:0;margin-bottom:20px}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n-1)   td[_ngcontent-%COMP%]{background:#f5f5f5}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:5px 10px;color:#5d6975;border-bottom:1px solid #c1ced9;white-space:nowrap;font-weight:400}table[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   .service[_ngcontent-%COMP%]{text-align:left}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:right}table[_ngcontent-%COMP%]   td.desc[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td.service[_ngcontent-%COMP%]{vertical-align:top}table[_ngcontent-%COMP%]   td.qty[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td.total[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td.unit[_ngcontent-%COMP%]{text-align:center;font-size:1em}table[_ngcontent-%COMP%]   td.grand[_ngcontent-%COMP%]{border-top:1px solid #5d6975}#notices[_ngcontent-%COMP%]   .notice[_ngcontent-%COMP%]{color:#5d6975;font-size:1.1em}footer[_ngcontent-%COMP%]{color:#5d6975;width:100%;height:30px;position:absolute;bottom:0;border-top:1px solid #c1ced9;padding:8px 0;text-align:center}@page{margin[_ngcontent-%COMP%]:0   0[_ngcontent-%COMP%];font-size:1em}body[_ngcontent-%COMP%]{margin:2.5cm 1.3cm 1cm}ion-img[_ngcontent-%COMP%]{width:75%}']}),e})();var p=i("mrSG");function u(e,t){if(1&e){const e=a.Rb();a.Qb(0,"ion-item"),a.Qb(1,"ion-label",5),a.Yb("click",function(){a.pc(e);const i=t.$implicit;return a.ac().close(i.id)}),a.wc(2),a.Pb(),a.Pb()}if(2&e){const e=t.$implicit;a.zb(2),a.yc(" ",e.text," ")}}let h=(()=>{class e{constructor(e,t,i,o){this.visitReportService=e,this.modalController=t,this.navParams=i,this.dbVisitReportService=o,this.searchTerm=""}ngOnInit(){this.selectSearchProyecto()}selectSearchProyecto(){this.visitReportService.getAllProyecto().subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.Pro_ID,text:e.Nombre,nombre_empresa:e.empresa,empresa_id:e.Emp_ID,dirrecion:e.dirrecion,codigo_proyecto:e.Codigo}));this.data=t,this.temp=t,this.setFilteredItems()}),e=>Object(p.a)(this,void 0,void 0,function*(){this.dbVisitReportService.getAllProyectos().subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){console.log(e);const t=e.map(e=>({id:e.Pro_ID,text:e.Nombre,nombre_empresa:e.Nombre,empresa_id:e.Emp_ID,dirrecion:`${e.Estado} ${e.Ciudad} ${e.Calle} ${e.Numero}`,codigo_proyecto:e.Codigo}));this.data=t,this.temp=t,this.setFilteredItems()}))}))}setFilteredItems(){this.temp=this.data,this.temp=this.filterItems(this.searchTerm)}filterItems(e){return this.temp.filter(t=>t.text.toLowerCase().indexOf(e.toLowerCase())>-1)}closeModal(){this.modalController.dismiss()}close(e){let t=this.temp.filter(t=>t.id==e);this.modalController.dismiss(t[0])}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(b.a),a.Lb(r.V),a.Lb(r.X),a.Lb(l.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-select-proyectos"]],decls:11,vars:6,consts:[["slot","end","color","light",3,"click"],["slot","icon-only","name","close"],["padding",""],[3,"ngModel","ngModelChange","ionChange"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(a.Qb(0,"ion-header"),a.Qb(1,"ion-toolbar"),a.Qb(2,"ion-title"),a.wc(3,"Select Project"),a.Pb(),a.Qb(4,"ion-button",0),a.Yb("click",function(){return t.closeModal()}),a.Mb(5,"ion-icon",1),a.Pb(),a.Pb(),a.Pb(),a.Qb(6,"ion-content",2),a.Qb(7,"ion-searchbar",3),a.Yb("ngModelChange",function(e){return t.searchTerm=e})("ionChange",function(){return t.setFilteredItems()}),a.Pb(),a.Qb(8,"ion-list"),a.uc(9,u,3,1,"ion-item",4),a.bc(10,"slice"),a.Pb(),a.Pb()),2&e&&(a.zb(7),a.gc("ngModel",t.searchTerm),a.zb(2),a.gc("ngForOf",a.dc(10,2,t.temp,0,90)))},directives:[r.t,r.Q,r.P,r.f,r.u,r.p,r.H,r.cb,n.l,n.n,r.z,o.j,r.x,r.y],pipes:[o.p],styles:[""]}),e})();function g(e,t){if(1&e){const e=a.Rb();a.Qb(0,"ion-item"),a.Qb(1,"ion-label",5),a.Yb("click",function(){a.pc(e);const i=t.$implicit;return a.ac().close(i.id)}),a.wc(2),a.Pb(),a.Pb()}if(2&e){const e=t.$implicit;a.zb(2),a.yc("",e.text," ")}}let f=(()=>{class e{constructor(e,t,i,o){this.visitReportService=e,this.navParams=t,this.modalController=i,this.dbVisitReportService=o,this.searchTerm="",this.tipo=t.get("tipo")}ngOnInit(){switch(this.tipo){case"Where":this.selectWhere();break;case"Problem":this.selectProblema();break;case"Consecuense":this.selectConsecuencia();break;case"Solution":this.selectSolucion()}}selectWhere(){this.visitReportService.getAreasProyecto(this.proyecto_id).subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.Area_ID,text:e.Nombre}));this.data=t,this.temp=t,this.setFilteredItems()}),e=>Object(p.a)(this,void 0,void 0,function*(){this.dbVisitReportService.getAllWhere(this.proyecto_id).subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){console.log(e);const t=e.map(e=>({id:e.Area_ID,text:e.Nombre}));this.data=t,this.temp=t,yield this.setFilteredItems()}))}))}selectProblema(){this.visitReportService.getProblema().subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.id,text:e.descripcion}));this.data=t,this.temp=t,this.setFilteredItems()}),e=>Object(p.a)(this,void 0,void 0,function*(){this.dbVisitReportService.getAllProblema().subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.problema_id,text:e.descripcion}));this.data=t,this.temp=t,yield this.setFilteredItems()}))}))}selectConsecuencia(){this.visitReportService.getConsecuencia(this.proyecto_id).subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.id,text:e.descripcion}));this.data=t,this.temp=t,this.setFilteredItems()}),e=>Object(p.a)(this,void 0,void 0,function*(){this.dbVisitReportService.getAllConsecuencia().subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.consecuencia_id,text:e.descripcion}));this.data=t,this.temp=t,yield this.setFilteredItems()}))}))}selectSolucion(){this.visitReportService.getSolucion(this.proyecto_id).subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.id,text:e.descripcion}));this.data=t,this.temp=t,console.log(this.data),this.setFilteredItems()}),e=>Object(p.a)(this,void 0,void 0,function*(){this.dbVisitReportService.getAllSolucion().subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.solucion_id,text:e.descripcion}));this.data=t,this.temp=t,yield this.setFilteredItems()}))}))}setFilteredItems(){this.temp=this.data,this.temp=this.filterItems(this.searchTerm)}filterItems(e){return this.temp.filter(t=>t.text.toLowerCase().indexOf(e.toLowerCase())>-1)}closeModal(){this.modalController.dismiss()}close(e){let t=this.temp.filter(t=>t.id==e);this.modalController.dismiss(t[0])}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(b.a),a.Lb(r.X),a.Lb(r.V),a.Lb(l.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-select"]],decls:11,vars:7,consts:[["slot","end","color","light",3,"click"],["slot","icon-only","name","close"],["padding",""],[3,"ngModel","ngModelChange","ionChange"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(a.Qb(0,"ion-header"),a.Qb(1,"ion-toolbar"),a.Qb(2,"ion-title"),a.wc(3),a.Pb(),a.Qb(4,"ion-button",0),a.Yb("click",function(){return t.closeModal()}),a.Mb(5,"ion-icon",1),a.Pb(),a.Pb(),a.Pb(),a.Qb(6,"ion-content",2),a.Qb(7,"ion-searchbar",3),a.Yb("ngModelChange",function(e){return t.searchTerm=e})("ionChange",function(){return t.setFilteredItems()}),a.Pb(),a.Qb(8,"ion-list"),a.uc(9,g,3,1,"ion-item",4),a.bc(10,"slice"),a.Pb(),a.Pb()),2&e&&(a.zb(3),a.yc("Select ",t.tipo,""),a.zb(4),a.gc("ngModel",t.searchTerm),a.zb(2),a.gc("ngForOf",a.dc(10,3,t.temp,0,90)))},directives:[r.t,r.Q,r.P,r.f,r.u,r.p,r.H,r.cb,n.l,n.n,r.z,o.j,r.x,r.y],pipes:[o.p],styles:[""]}),e})();function P(e,t){if(1&e){const e=a.Rb();a.Qb(0,"ion-col",4),a.Qb(1,"ion-card",5),a.Mb(2,"ion-img",6),a.Qb(3,"ion-item"),a.Qb(4,"ion-button",7),a.Yb("click",function(){a.pc(e);const i=t.index;return a.ac().delete(i)}),a.Mb(5,"ion-icon",8),a.Pb(),a.Pb(),a.Pb(),a.Pb()}if(2&e){const e=t.$implicit;a.zb(2),a.gc("src",e.webviewPath)}}let _=(()=>{class e{constructor(e){this.visitReportService=e,this.photos=[],this.onChange=e=>{},this.onTouch=()=>{},this.images=new n.a([])}ngOnInit(){}loadImages(){this.images.clear(),this.visitReportService.loadSaved().then(()=>{this.visitReportService.getPhotos().map(e=>{const t=new n.f({filepath:new n.c(e.filepath),webviewPath:new n.c(e.webviewPath)});this.images.push(t)})})}newPhoto(){return Object(p.a)(this,void 0,void 0,function*(){const e=yield this.visitReportService.addNewGalery();console.log(e);const t=new n.f({filepath:new n.c(e.filepath),webviewPath:new n.c(e.webviewPath)});this.images.push(t),this.onTouch(),this.images.valueChanges.subscribe(e=>{this.onChange(e)})})}delete(e){this.images.removeAt(e),this.onTouch(),this.images.valueChanges.subscribe(e=>{this.onChange(e)})}writeValue(e){this.images=new n.a(e.map(e=>new n.f({filepath:new n.c(e.filepath),webviewPath:new n.c(e.webviewPath)}))),this.onTouch(),this.images.valueChanges.subscribe(e=>{this.onChange(e)})}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouch=e}setDisabledState(){}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(b.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-images"]],inputs:{tipo:"tipo"},features:[a.yb([{provide:n.j,multi:!0,useExisting:Object(a.U)(()=>e)}])],decls:7,vars:2,consts:[["size","6",4,"ngFor","ngForOf"],["size","12"],["type","button","expand","full",3,"click"],["name","camera-outline"],["size","6"],[1,"block"],[3,"src"],["fill","outline","slot","end",3,"click"],["name","trash",1,"deleteIcon"]],template:function(e,t){1&e&&(a.Qb(0,"ion-grid"),a.Qb(1,"ion-row"),a.uc(2,P,6,1,"ion-col",0),a.Qb(3,"ion-col",1),a.Qb(4,"ion-button",2),a.Yb("click",function(){return t.newPhoto()}),a.Mb(5,"ion-icon",3),a.wc(6),a.Pb(),a.Pb(),a.Pb(),a.Pb()),2&e&&(a.zb(2),a.gc("ngForOf",t.images.value),a.zb(4),a.yc(" \xa0 Capture ",t.tipo," images "))},directives:[r.s,r.G,o.j,r.o,r.f,r.u,r.h,r.v,r.x],styles:[""]}),e})(),v=(()=>{class e{constructor(e,t,i,o,n,r,s){this.formBuilder=e,this.modalController=t,this.loadingCtrl=i,this.router=o,this.route=n,this.reportVisitService=r,this.DbReportVisitService=s,this.visit_report_id=this.route.snapshot.params.id,this.builderForm(),this.EditTicket()}ngOnInit(){}builderForm(){this.edit_form_visit_report=this.formBuilder.group({informe_proyecto_id:["",[n.q.required]],proyecto_id:["",[n.q.required]],nombre_proyecto:["",[n.q.required]],nombre_empresa:["",[n.q.required]],empresa_id:["",[n.q.required]],report_by:["",[n.q.required]],codigo_proyecto:["",[n.q.required]],empleado_id:["",[n.q.required]],fecha:["",[n.q.required]],comentarios:["",[n.q.required]],dirrecion_proyecto:["",[n.q.required]],images:[[]]})}EditTicket(){return Object(p.a)(this,void 0,void 0,function*(){const e=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Loading visit report"});yield e.present(),this.reportVisitService.getOneVisitReport(this.visit_report_id).subscribe(t=>Object(p.a)(this,void 0,void 0,function*(){this.edit_form_visit_report.setValue({informe_proyecto_id:t.informe_proyecto_id,proyecto_id:t.proyecto_id,nombre_proyecto:t.nombre_proyecto,nombre_empresa:t.nombre_empresa,empresa_id:t.empresa_id,report_by:t.username,codigo_proyecto:t.codigo_proyecto,empleado_id:t.empleado_id,fecha:t.fecha,comentarios:t.comentarios,dirrecion_proyecto:t.dirrecion_proyecto,images:t.images}),yield e.dismiss()}),t=>Object(p.a)(this,void 0,void 0,function*(){const t=yield this.DbReportVisitService.getOneVisitReport(this.visit_report_id).toPromise();console.log(t),this.edit_form_visit_report.setValue({informe_proyecto_id:t.informe_id,proyecto_id:t.proyecto_id,nombre_proyecto:t.nombre_proyecto,nombre_empresa:t.nombre_empresa,empresa_id:t.empresa_id,report_by:t.username,codigo_proyecto:t.codigo_proyecto,empleado_id:t.empleado_id,fecha:t.fecha,comentarios:t.comentarios,dirrecion_proyecto:t.dirrecion,images:[]}),yield e.dismiss()}))})}isFieldValid(e){return!this.edit_form_visit_report.get(e).valid&&this.edit_form_visit_report.get(e).touched}displayFieldCss(e){return{"has-error":this.isFieldValid(e),"has-feedback":this.isFieldValid(e)}}selectProyectModal(){return Object(p.a)(this,void 0,void 0,function*(){yield this.modalController.getTop();const e=yield this.modalController.create({component:h,cssClass:"my-custom-class",swipeToClose:!0,componentProps:{tipo:"staff"}});return e.onDidDismiss().then(e=>{if(e.data){const t=e.data;this.edit_form_visit_report.get("proyecto_id").setValue(t.id),this.edit_form_visit_report.get("nombre_proyecto").setValue(t.text),this.edit_form_visit_report.get("nombre_empresa").setValue(t.nombre_empresa),this.edit_form_visit_report.get("codigo_proyecto").setValue(t.codigo_proyecto),this.edit_form_visit_report.get("dirrecion_proyecto").setValue(t.dirrecion),this.edit_form_visit_report.get("empresa_id").setValue(t.empresa_id)}}),yield e.present()})}save(){return Object(p.a)(this,void 0,void 0,function*(){this.edit_form_visit_report.valid&&this.reportVisitService.getUpdateVisitReport(this.edit_form_visit_report.get("informe_proyecto_id").value,this.edit_form_visit_report.value).subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){this.router.navigate(["/visit-report"])}))})}close(){this.router.navigate(["/visit-report"])}selectModal(e){return Object(p.a)(this,void 0,void 0,function*(){yield this.modalController.getTop();const t=yield this.modalController.create({component:f,cssClass:"my-custom-class",swipeToClose:!0,componentProps:{proyecto_id:this.edit_form_visit_report.get("proyecto_id").value,tipo:e}});return t.onDidDismiss().then(t=>{if(t.data){const i=t.data,o=this.edit_form_visit_report.get("comentarios").value;this.verificandoData(e,o,i)}}),yield t.present()})}verificandoData(e,t,i){switch(e){case"Where":this.edit_form_visit_report.get("comentarios").setValue(`${t.trim()}Floor:${i.text.trim()}`);break;case"Problem":this.edit_form_visit_report.get("comentarios").setValue(`${t.trim()}\nProblem: ${i.text.trim()}`);break;case"Consecuense":this.edit_form_visit_report.get("comentarios").setValue(`${t.trim()}\nConsecuense:${i.text.trim()}`);break;case"Solution":this.edit_form_visit_report.get("comentarios").setValue(`${t.trim()}\nSolution:${i.text.trim()}`)}}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(n.b),a.Lb(r.V),a.Lb(r.T),a.Lb(c.g),a.Lb(c.a),a.Lb(b.a),a.Lb(l.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-edit-report"]],decls:88,vars:8,consts:[[3,"translucent"],["slot","start"],["slot","end"],[3,"formGroup"],["size","12"],["position","stacked"],["formControlName","nombre_proyecto","placeholder","select one",3,"click"],["errorMsg","Assign ticket is required",3,"displayError"],["formControlName","nombre_empresa","value","","readonly","",3,"disabled"],["formControlName","codigo_proyecto","value","","readonly","",3,"disabled"],["formControlName","report_by","value","","readonly","",3,"disabled"],["formControlName","nombre_proyecto","value","","readonly","",3,"disabled"],["formControlName","dirrecion_proyecto","value","","readonly","",3,"disabled"],["displayFormat","MM DD YYYY","formControlName","fecha"],["rows","5","cols","5","formControlName","comentarios"],["expand","full",3,"click"],["formControlName","images"],["expand","full","color","danger",3,"click"]],template:function(e,t){1&e&&(a.Qb(0,"ion-header",0),a.Qb(1,"ion-toolbar"),a.Qb(2,"ion-buttons",1),a.Mb(3,"ion-menu-button"),a.Pb(),a.Qb(4,"ion-title"),a.wc(5,"EDIT VISIT REPORT"),a.Pb(),a.Qb(6,"ion-buttons",2),a.Mb(7,"ion-back-button"),a.Pb(),a.Pb(),a.Pb(),a.Qb(8,"ion-content"),a.Qb(9,"ion-card"),a.Mb(10,"ion-card-header"),a.Qb(11,"ion-card-content"),a.Qb(12,"form",3),a.Qb(13,"ion-grid"),a.Qb(14,"ion-row"),a.Qb(15,"ion-col",4),a.Qb(16,"ion-item"),a.Qb(17,"ion-label",5),a.wc(18,"Project:"),a.Pb(),a.Qb(19,"ion-input",6),a.Yb("click",function(){return t.selectProyectModal()}),a.Pb(),a.Pb(),a.Mb(20,"app-field-error-display",7),a.Pb(),a.Qb(21,"ion-col",4),a.Qb(22,"ion-item"),a.Qb(23,"ion-label",5),a.wc(24,"General Contractor"),a.Pb(),a.Mb(25,"ion-input",8),a.Pb(),a.Pb(),a.Qb(26,"ion-col",4),a.Qb(27,"ion-item"),a.Qb(28,"ion-label",5),a.wc(29,"PRECISION WALL TECH PROJECT"),a.Pb(),a.Mb(30,"ion-input",9),a.Pb(),a.Pb(),a.Qb(31,"ion-col",4),a.Qb(32,"ion-item"),a.Qb(33,"ion-label",5),a.wc(34,"Report by"),a.Pb(),a.Mb(35,"ion-input",10),a.Pb(),a.Pb(),a.Qb(36,"ion-col",4),a.Qb(37,"ion-item"),a.Qb(38,"ion-label",5),a.wc(39,"Project Name"),a.Pb(),a.Mb(40,"ion-input",11),a.Pb(),a.Pb(),a.Qb(41,"ion-col",4),a.Qb(42,"ion-item"),a.Qb(43,"ion-label",5),a.wc(44,"Project Address"),a.Pb(),a.Mb(45,"ion-input",12),a.Pb(),a.Pb(),a.Qb(46,"ion-col",4),a.Qb(47,"ion-item"),a.Qb(48,"ion-label",5),a.wc(49,"Date"),a.Pb(),a.Mb(50,"ion-datetime",13),a.Pb(),a.Pb(),a.Pb(),a.Qb(51,"ion-card-header"),a.Qb(52,"ion-card-subtitle"),a.wc(53,"OTHERS TRADES WORK:"),a.Pb(),a.Pb(),a.Qb(54,"ion-row"),a.Qb(55,"ion-col",4),a.Qb(56,"ion-item"),a.Qb(57,"ion-label",5),a.wc(58,"Quality of the substrates: Drywall / wood / metals / concrete etc."),a.Pb(),a.Mb(59,"ion-textarea",14),a.Pb(),a.Pb(),a.Pb(),a.Qb(60,"ion-row"),a.Qb(61,"ion-col"),a.Qb(62,"ion-button",15),a.Yb("click",function(){return t.selectModal("Where")}),a.wc(63,"Where?"),a.Pb(),a.Pb(),a.Qb(64,"ion-col"),a.Qb(65,"ion-button",15),a.Yb("click",function(){return t.selectModal("Problem")}),a.wc(66,"Problems?"),a.Pb(),a.Pb(),a.Qb(67,"ion-col"),a.Qb(68,"ion-button",15),a.Yb("click",function(){return t.selectModal("Consecuense")}),a.wc(69,"Consequences?"),a.Pb(),a.Pb(),a.Qb(70,"ion-col"),a.Qb(71,"ion-button",15),a.Yb("click",function(){return t.selectModal("Solution")}),a.wc(72,"Suggested solution?"),a.Pb(),a.Pb(),a.Pb(),a.Qb(73,"ion-card-header"),a.Qb(74,"ion-card-subtitle"),a.wc(75,"IMAGES:"),a.Pb(),a.Pb(),a.Qb(76,"ion-row"),a.Qb(77,"ion-col",4),a.Mb(78,"app-images",16),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Qb(79,"ion-footer"),a.Qb(80,"ion-grid"),a.Qb(81,"ion-row"),a.Qb(82,"ion-col"),a.Qb(83,"ion-button",15),a.Yb("click",function(){return t.save()}),a.wc(84,"Save"),a.Pb(),a.Pb(),a.Qb(85,"ion-col"),a.Qb(86,"ion-button",17),a.Yb("click",function(){return t.close()}),a.wc(87,"Close"),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb()),2&e&&(a.gc("translucent",!0),a.zb(12),a.gc("formGroup",t.edit_form_visit_report),a.zb(8),a.gc("displayError",t.isFieldValid("nombre_proyecto")),a.zb(5),a.gc("disabled",!0),a.zb(5),a.gc("disabled",!0),a.zb(5),a.gc("disabled",!0),a.zb(5),a.gc("disabled",!0),a.zb(5),a.gc("disabled",!0))},directives:[r.t,r.Q,r.g,r.C,r.P,r.d,r.e,r.p,r.h,r.j,r.i,n.r,n.m,n.g,r.s,r.G,r.o,r.x,r.y,r.w,r.cb,n.l,n.e,r.q,r.bb,r.k,r.N,r.f,_,r.r],styles:[""]}),e})();function w(e,t){if(1&e){const e=a.Rb();a.Qb(0,"ion-col"),a.Qb(1,"ion-chip"),a.Qb(2,"ion-label"),a.wc(3),a.Pb(),a.Qb(4,"ion-icon",15),a.Yb("click",function(){a.pc(e);const i=t.index;return a.ac().deleteMail(i,"to")}),a.Pb(),a.Pb(),a.Pb()}if(2&e){const e=t.$implicit;a.zb(3),a.xc(e)}}function Q(e,t){if(1&e){const e=a.Rb();a.Qb(0,"ion-col"),a.Qb(1,"ion-chip"),a.Qb(2,"ion-label"),a.wc(3),a.Pb(),a.Qb(4,"ion-icon",15),a.Yb("click",function(){a.pc(e);const i=t.index;return a.ac().deleteMail(i,"cc")}),a.Pb(),a.Pb(),a.Pb()}if(2&e){const e=t.$implicit;a.zb(3),a.xc(e)}}let y=(()=>{class e{constructor(e,t,i,o,r,s){this.serviceVisitReport=e,this.indexDBVisitReport=t,this.modalController=i,this.formBuilder=o,this.loadingCtrl=r,this.toastController=s,this.cc_mail=[],this.to_mail=[],this.mail=this.formBuilder.group({to:["",[n.q.pattern(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)]],cc:["",[n.q.pattern(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)]],title_mail:["",[n.q.required]],body_mail:["",[n.q.required]]}),this.observerCampos(),this.mail.get("to").markAsTouched(),this.mail.get("cc").markAsTouched()}observerCampos(){this.mail.get("to").valueChanges.subscribe(e=>{e.indexOf(" ")>=0&&(this.to_mail.push(e),this.mail.get("to").setValue(""))}),this.mail.get("cc").valueChanges.subscribe(e=>{e.indexOf(" ")>=0&&(this.cc_mail.push(e),this.mail.get("cc").setValue(""))})}ngOnInit(){this.serviceVisitReport.getMail(this.informe_id,this.proyecto_id).subscribe(e=>{this.cc_mail.push(e.emails.Pwtsuper_mail),this.to_mail.push(e.emails.Foreman_mail),this.mail.get("title_mail").setValue(`${e.config.title_ticket_email} ${this.nombre_proyecto} VisitReport${this.codigo}`),this.mail.get("body_mail").setValue("Please find attached visit report for the project mentioned above")},e=>Object(p.a)(this,void 0,void 0,function*(){}))}close(){this.modalController.dismiss({dismissed:!0})}validarVacios(e){return""!==e}save(){return Object(p.a)(this,void 0,void 0,function*(){const e={cc:this.cc_mail,to:this.to_mail,title_m:this.mail.get("title_mail").value,body_m:this.mail.get("body_mail").value};this.serviceVisitReport.sendMail(this.informe_id,e).subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){console.log(e)}),e=>Object(p.a)(this,void 0,void 0,function*(){yield this.alertToast("Error! mail not sent",3e3)}));const t=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Send Mail",duration:1500});yield t.present(),this.modalController.dismiss({dismissed:!0})})}isFieldValid(e){return!this.mail.get(e).valid&&this.mail.get(e).touched}displayFieldCss(e){return{"has-error":this.isFieldValid(e),"has-feedback":this.isFieldValid(e)}}validateAllFormFields(e){Object.keys(e.controls).forEach(t=>{const i=e.get(t);i instanceof n.c?i.markAsTouched({onlySelf:!0}):i instanceof n.f&&this.validateAllFormFields(i)})}deleteMail(e,t){"cc"==t?this.cc_mail.splice(e,1):this.to_mail.splice(e,1)}alertToast(e,t){return Object(p.a)(this,void 0,void 0,function*(){const i=yield this.toastController.create({color:"dark",message:e,duration:t});i.present(),yield i.onDidDismiss()})}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(b.a),a.Lb(l.a),a.Lb(r.V),a.Lb(n.b),a.Lb(r.T),a.Lb(r.db))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-mail"]],inputs:{informe_id:"informe_id",proyecto_id:"proyecto_id",nombre_proyecto:"nombre_proyecto",codigo:"codigo"},decls:47,vars:7,consts:[["slot","end","color","light",3,"click"],["slot","icon-only","name","close"],["padding",""],[3,"formGroup"],["size","12"],["position","stacked"],["formControlName","to","autocomplete","off"],["errorMsg","invalid email",3,"displayError"],[4,"ngFor","ngForOf"],["formControlName","cc","autocomplete","off"],["formControlName","title_mail","autocomplete","disabled"],["errorMsg","Mail Title is required",3,"displayError"],["formControlName","body_mail","autocomplete","disabled"],["errorMsg","Mail Body is required",3,"displayError"],["expand","full",3,"click"],["name","close-circle",3,"click"]],template:function(e,t){1&e&&(a.Qb(0,"ion-header"),a.Qb(1,"ion-toolbar"),a.Qb(2,"ion-title"),a.wc(3,"Send Visit Report "),a.Pb(),a.Qb(4,"ion-button",0),a.Yb("click",function(){return t.close()}),a.Mb(5,"ion-icon",1),a.Pb(),a.Pb(),a.Pb(),a.Qb(6,"ion-content",2),a.Qb(7,"form",3),a.Qb(8,"ion-grid"),a.Qb(9,"ion-row"),a.Qb(10,"ion-col",4),a.Qb(11,"ion-item"),a.Qb(12,"ion-label",5),a.wc(13,"TO:"),a.Pb(),a.Mb(14,"ion-input",6),a.Pb(),a.Mb(15,"app-field-error-display",7),a.Pb(),a.Qb(16,"ion-col",4),a.uc(17,w,5,1,"ion-col",8),a.Pb(),a.Qb(18,"ion-col",4),a.Qb(19,"ion-item"),a.Qb(20,"ion-label",5),a.wc(21,"CC:"),a.Pb(),a.Mb(22,"ion-input",9),a.Pb(),a.Mb(23,"app-field-error-display",7),a.Pb(),a.Qb(24,"ion-col",4),a.uc(25,Q,5,1,"ion-col",8),a.Pb(),a.Qb(26,"ion-col",4),a.Qb(27,"ion-item"),a.Qb(28,"ion-label",5),a.wc(29,"Mail Title:"),a.Pb(),a.Mb(30,"ion-input",10),a.Pb(),a.Mb(31,"app-field-error-display",11),a.Pb(),a.Qb(32,"ion-col",4),a.Qb(33,"ion-item"),a.Qb(34,"ion-label",5),a.wc(35,"Mail Body:"),a.Pb(),a.Mb(36,"ion-input",12),a.Pb(),a.Mb(37,"app-field-error-display",13),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Qb(38,"ion-footer"),a.Qb(39,"ion-grid"),a.Qb(40,"ion-row"),a.Qb(41,"ion-col"),a.Qb(42,"ion-button",14),a.Yb("click",function(){return t.save()}),a.wc(43,"Send Mail"),a.Pb(),a.Pb(),a.Qb(44,"ion-col"),a.Qb(45,"ion-button",14),a.Yb("click",function(){return t.close()}),a.wc(46,"Close"),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb()),2&e&&(a.zb(7),a.gc("formGroup",t.mail),a.zb(8),a.gc("displayError",t.isFieldValid("to")),a.zb(2),a.gc("ngForOf",t.to_mail),a.zb(6),a.gc("displayError",t.isFieldValid("cc")),a.zb(2),a.gc("ngForOf",t.cc_mail),a.zb(6),a.gc("displayError",t.isFieldValid("title_mail")),a.zb(6),a.gc("displayError",t.isFieldValid("body_mail")))},directives:[r.t,r.Q,r.P,r.f,r.u,r.p,n.r,n.m,n.g,r.s,r.G,r.o,r.x,r.y,r.w,r.cb,n.l,n.e,o.j,r.r,r.n],styles:[""]}),e})();function C(e,t){if(1&e&&(a.Qb(0,"ion-card",8),a.Mb(1,"ion-img",9),a.Pb()),2&e){const e=t.$implicit;a.zb(1),a.gc("src",e)}}function M(e,t){if(1&e&&(a.Qb(0,"ion-grid"),a.Qb(1,"ion-row"),a.Qb(2,"ion-col",6),a.uc(3,C,2,1,"ion-card",7),a.Pb(),a.Pb(),a.Pb()),2&e){const e=a.ac();a.zb(3),a.gc("ngForOf",e.images)}}function O(e,t){1&e&&(a.Qb(0,"ion-card",8),a.Mb(1,"ion-img",9),a.Pb()),2&e&&(a.zb(1),a.gc("src","assets/img/Internet-Access-Error.jpg"))}let x=(()=>{class e{constructor(e,t,i){this.serviceVisitReport=e,this.dbVisitReport=t,this.modalController=i,this.acessInternet=!0}ngOnInit(){this.serviceVisitReport.getImage(this.informe_id).subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){this.images=e.initialPreview}),()=>Object(p.a)(this,void 0,void 0,function*(){this.acessInternet=!1}))}close(){this.modalController.dismiss({dismissed:!0})}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(b.a),a.Lb(l.a),a.Lb(r.V))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-preview-images"]],inputs:{informe_id:"informe_id"},decls:16,vars:2,consts:[["slot","end","color","light",3,"click"],["slot","icon-only","name","close"],["padding",""],[4,"ngIf","ngIfElse"],["NoacessInternet",""],["expand","full",3,"click"],["size","6"],["class","block",4,"ngFor","ngForOf"],[1,"block"],[3,"src"]],template:function(e,t){if(1&e&&(a.Qb(0,"ion-header"),a.Qb(1,"ion-toolbar"),a.Qb(2,"ion-title"),a.wc(3,"Preview imagen"),a.Pb(),a.Qb(4,"ion-button",0),a.Yb("click",function(){return t.close()}),a.Mb(5,"ion-icon",1),a.Pb(),a.Pb(),a.Pb(),a.Qb(6,"ion-content",2),a.uc(7,M,4,1,"ion-grid",3),a.uc(8,O,2,1,"ng-template",null,4,a.vc),a.Pb(),a.Qb(10,"ion-footer"),a.Qb(11,"ion-grid"),a.Qb(12,"ion-row"),a.Qb(13,"ion-col"),a.Qb(14,"ion-button",5),a.Yb("click",function(){return t.close()}),a.wc(15,"Close"),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb()),2&e){const e=a.nc(9);a.zb(7),a.gc("ngIf",t.acessInternet)("ngIfElse",e)}},directives:[r.t,r.Q,r.P,r.f,r.u,r.p,o.k,r.r,r.s,r.G,r.o,o.j,r.h,r.v],styles:[""]}),e})();var k=i("wd/R");const V=function(e){return["/visit-report/edit",e]},R=function(e){return["/visit-report/view-pdf",e]};function z(e,t){if(1&e){const e=a.Rb();a.Qb(0,"ion-grid"),a.Qb(1,"ion-row"),a.Qb(2,"ion-col"),a.Qb(3,"small"),a.wc(4,"Actions"),a.Pb(),a.Mb(5,"br"),a.Qb(6,"ion-button",26),a.wc(7," Edit \xa0 "),a.Mb(8,"ion-icon",27),a.Pb(),a.Pb(),a.Qb(9,"ion-col"),a.Mb(10,"small"),a.Mb(11,"br"),a.Qb(12,"ion-button",28),a.Yb("click",function(){a.pc(e);const i=t.row;return a.ac().delete(i.informe_id)}),a.wc(13," Delete \xa0 "),a.Mb(14,"ion-icon",29),a.Pb(),a.Pb(),a.Qb(15,"ion-col"),a.Mb(16,"small"),a.Mb(17,"br"),a.Qb(18,"ion-button",28),a.Yb("click",function(){a.pc(e);const i=t.row;return a.ac().mail(i.informe_id,i.Pro_ID,i.nombre_proyecto,i.Codigo)}),a.wc(19," Send Mail \xa0 "),a.Mb(20,"ion-icon",30),a.Pb(),a.Pb(),a.Qb(21,"ion-col"),a.Qb(22,"small"),a.wc(23,"Images"),a.Pb(),a.Mb(24,"br"),a.Qb(25,"ion-button",28),a.Yb("click",function(){a.pc(e);const i=t.row;return a.ac().imagesPreview(i.informe_id)}),a.wc(26," View \xa0 "),a.Mb(27,"ion-icon",31),a.Pb(),a.Pb(),a.Qb(28,"ion-col"),a.Qb(29,"small"),a.wc(30,"Images"),a.Pb(),a.Mb(31,"br"),a.Qb(32,"ion-button",26),a.wc(33," View PDF \xa0 "),a.Mb(34,"ion-icon",32),a.Pb(),a.Pb(),a.Pb(),a.Pb()}if(2&e){const e=t.row;a.zb(6),a.gc("routerLink",a.jc(2,V,e.informe_id)),a.zb(26),a.gc("routerLink",a.jc(4,R,e.informe_id))}}function L(e,t){if(1&e){const e=a.Rb();a.Qb(0,"a",33),a.Yb("click",function(){a.pc(e);const i=t.row;return a.ac().toggleExpandRow(i)}),a.Pb()}if(2&e){const e=t.expanded;a.Db("datatable-icon-right",!e)("datatable-icon-down",e)}}function F(e,t){1&e&&a.Mb(0,"i",34),2&e&&a.gc("innerHTML",t.row.codigo,a.qc)}function S(e,t){1&e&&a.Mb(0,"i",34),2&e&&a.gc("innerHTML",t.row.codigo_proyecto,a.qc)}function T(e,t){1&e&&a.Mb(0,"i",34),2&e&&a.gc("innerHTML",t.row.fecha,a.qc)}function Y(e,t){1&e&&a.Mb(0,"i",34),2&e&&a.gc("innerHTML",t.row.nombre_proyecto,a.qc)}function D(e,t){1&e&&a.Mb(0,"i",34),2&e&&a.gc("innerHTML",t.row.estado,a.qc)}function j(e,t){1&e&&a.Mb(0,"i",34),2&e&&a.gc("innerHTML",t.row.fecha_inicio,a.qc)}function I(e,t){1&e&&a.Mb(0,"i",34),2&e&&a.gc("innerHTML",t.row.nombre_empresa,a.qc)}function q(e,t){1&e&&a.Mb(0,"i",34),2&e&&a.gc("innerHTML",t.row.username,a.qc)}const E=function(){return["/visit-report/new"]};let A=(()=>{class e{constructor(e,t,i,o){this.ReportVisitService=e,this.DbReportVisitService=t,this.alertCtrl=i,this.modalController=o,this.loadingIndicator=!0,this.fecha_inicio=k().format("YYYY-MM-DD"),this.fecha_fin=k().format("YYYY-MM-DD"),this.columns=[{prop:"proyecto_id",name:"Pro_ID"},{prop:"codigo",name:"Cod"},{prop:"codigo_proyecto",name:"Cod Proyect"},{prop:"fecha",name:"Creation date"},{prop:"nombre_proyecto",name:"Name Proyect"},{prop:"status",name:"Status"},{prop:"fecha_incio_Proyecto",name:"Start date of Proyect"},{prop:"images",name:"Images"},{prop:"nombre_empresa",name:"Nombre Company"},{prop:"username",name:"Created by"}],this.expanded={},this.scrollBarHorizontal=window.innerWidth<1200,this.ColumnMode=s.a,window.onresize=()=>{this.scrollBarHorizontal=window.innerWidth<1200},this.auth_user=this.DbReportVisitService.getAuthUser()}ngOnInit(){this.datatable(this.auth_user.empleado_id)}onPage(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{console.log("paged!",e)},1e3)}toggleExpandRow(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}onDetailToggle(e){console.log("Detail Toggled",e)}datatable(e){this.ReportVisitService.getAllVisitReport(e).subscribe(e=>Object(p.a)(this,void 0,void 0,function*(){this.rows=e,this.temp=e,this.loadingIndicator=!1}),e=>Object(p.a)(this,void 0,void 0,function*(){this.DbReportVisitService.getAllVisitReport(this.auth_user.empleado_id).subscribe(e=>{console.log("extrayendo data offline",e),this.rows=e,this.temp=e,this.loadingIndicator=!1})}))}imagesPreview(e){return Object(p.a)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:x,componentProps:{informe_id:e},cssClass:"my-custom-class"});return yield t.present()})}mail(e,t,i,o){return Object(p.a)(this,void 0,void 0,function*(){const n=yield this.modalController.create({component:y,componentProps:{informe_id:e,proyecto_id:t,nombre_proyecto:i,codigo:o},cssClass:"my-custom-class"});return yield n.present()})}updateFilterAll(e){const t=e.target.value.toLowerCase(),i=this.temp.filter(({nombre_proyecto:e,codigo:i,codigo_proyecto:o,fecha:n,fecha_incio_Proyecto:r,nombre_empresa:s,username:c})=>e.toLowerCase().indexOf(t.toLowerCase())>-1||String(i).toLowerCase().indexOf(t.toLowerCase())>-1||String(o).toLowerCase().indexOf(t.toLowerCase())>-1||String(n).toLowerCase().indexOf(t.toLowerCase())>-1||String(r).toLowerCase().indexOf(t.toLowerCase())>-1||String(s).toLowerCase().indexOf(t.toLowerCase())>-1||c.toLowerCase().indexOf(t.toLowerCase())>-1);this.rows=i,this.table.offset=7}updateFilterProyecto(e){const t=e.target.value.toLowerCase();console.log(t);const i=this.temp.filter(({nombre_proyecto:e})=>e.toLowerCase().indexOf(t.toLowerCase())>-1);this.rows=i,this.table.offset=3}updateFilterCodVisitReport(e){const t=e.target.value.toLowerCase(),i=this.temp.filter(({codigo:e})=>String(e).toLowerCase().indexOf(t.toLowerCase())>-1);this.rows=i,this.table.offset=0}updateFilterFecha(e){const t=k(this.fecha_inicio).format("YYYY-MM-DD"),i=k(this.fecha_fin).format("YYYY-MM-DD"),o=this.temp.filter(({fecha:e})=>e>i&&e<t);this.rows=o,this.table.offset=0}delete(e){}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(b.a),a.Lb(l.a),a.Lb(r.a),a.Lb(r.V))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-datatable"]],viewQuery:function(e,t){if(1&e&&a.Bc(s.d,1),2&e){let e;a.mc(e=a.Zb())&&(t.table=e.first)}},decls:50,vars:25,consts:[["size","6"],["type","button","expand","full",3,"routerLink"],["placeholder","From date","displayFormat","MM/DD/YYYY",3,"ngModel","ngModelChange","ionChange"],["placeholder","To Date","displayFormat","MM/DD/YYYY",3,"ngModel","ngModelChange","ionChange"],["placeholder","Proyect",3,"keyup"],["placeholder","Code Visit Report",3,"keyup"],["size","12"],["expand","full"],["name","repeat-outline"],["position","floating"],["type","text",3,"keyup"],["rowHeight","auto",1,"material","expandable",3,"loadingIndicator","rows","limit","columnMode","headerHeight","footerHeight","scrollbarH","page"],["table",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","Cod",3,"width"],["name","Code Proyect",3,"width"],["name","Created date",3,"width"],["name","Name Proyect",3,"width"],["name","Status",3,"width"],["name","Start date project",3,"width"],["name","Name Company",3,"width"],["name","Create by",3,"width"],["size","small",3,"routerLink"],["name","create-outline"],["size","small",3,"click"],["name","trash-outline"],["name","mail-outline"],["name","images-outline"],["name","eye-outline"],["title","Expand/Collapse Row",3,"click"],[3,"innerHTML"]],template:function(e,t){1&e&&(a.Qb(0,"ion-row"),a.Mb(1,"ion-col",0),a.Qb(2,"ion-col",0),a.Qb(3,"ion-button",1),a.wc(4," Add field visit report "),a.Pb(),a.Pb(),a.Qb(5,"ion-col",0),a.Qb(6,"ion-item"),a.Qb(7,"ion-datetime",2),a.Yb("ngModelChange",function(e){return t.fecha_fin=e})("ionChange",function(e){return t.updateFilterFecha(e)}),a.Pb(),a.Pb(),a.Pb(),a.Qb(8,"ion-col",0),a.Qb(9,"ion-item"),a.Qb(10,"ion-datetime",3),a.Yb("ngModelChange",function(e){return t.fecha_inicio=e})("ionChange",function(e){return t.updateFilterFecha(e)}),a.Pb(),a.Pb(),a.Pb(),a.Qb(11,"ion-col",0),a.Qb(12,"ion-item"),a.Qb(13,"ion-input",4),a.Yb("keyup",function(e){return t.updateFilterProyecto(e)}),a.Pb(),a.Pb(),a.Pb(),a.Qb(14,"ion-col",0),a.Qb(15,"ion-item"),a.Qb(16,"ion-input",5),a.Yb("keyup",function(e){return t.updateFilterCodVisitReport(e)}),a.Pb(),a.Pb(),a.Pb(),a.Qb(17,"ion-col",6),a.Qb(18,"ion-button",7),a.Mb(19,"ion-icon",8),a.Pb(),a.Pb(),a.Pb(),a.Mb(20,"hr"),a.Qb(21,"ion-item"),a.Qb(22,"ion-label",9),a.wc(23,"Search"),a.Pb(),a.Qb(24,"ion-input",10),a.Yb("keyup",function(e){return t.updateFilterAll(e)}),a.Pb(),a.Pb(),a.Mb(25,"br"),a.Qb(26,"ngx-datatable",11,12),a.Yb("page",function(e){return t.onPage(e)}),a.Qb(28,"ngx-datatable-row-detail",13,14),a.Yb("toggle",function(e){return t.onDetailToggle(e)}),a.uc(30,z,35,6,"ng-template",15),a.Pb(),a.wc(31," --\x3e "),a.Qb(32,"ngx-datatable-column",16),a.uc(33,L,1,4,"ng-template",17),a.Pb(),a.Qb(34,"ngx-datatable-column",18),a.uc(35,F,1,1,"ng-template",17),a.Pb(),a.Qb(36,"ngx-datatable-column",19),a.uc(37,S,1,1,"ng-template",17),a.Pb(),a.Qb(38,"ngx-datatable-column",20),a.uc(39,T,1,1,"ng-template",17),a.Pb(),a.Qb(40,"ngx-datatable-column",21),a.uc(41,Y,1,1,"ng-template",17),a.Pb(),a.Qb(42,"ngx-datatable-column",22),a.uc(43,D,1,1,"ng-template",17),a.Pb(),a.Qb(44,"ngx-datatable-column",23),a.uc(45,j,1,1,"ng-template",17),a.Pb(),a.Qb(46,"ngx-datatable-column",24),a.uc(47,I,1,1,"ng-template",17),a.Pb(),a.Qb(48,"ngx-datatable-column",25),a.uc(49,q,1,1,"ng-template",17),a.Pb(),a.Pb()),2&e&&(a.zb(3),a.gc("routerLink",a.ic(24,E)),a.zb(4),a.gc("ngModel",t.fecha_fin),a.zb(3),a.gc("ngModel",t.fecha_inicio),a.zb(16),a.gc("loadingIndicator",t.loadingIndicator)("rows",t.rows)("limit",15)("columnMode",t.ColumnMode.force)("headerHeight",50)("footerHeight",50)("scrollbarH",t.scrollBarHorizontal),a.zb(2),a.gc("rowHeight",95),a.zb(4),a.gc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),a.zb(2),a.gc("width",180),a.zb(2),a.gc("width",180),a.zb(2),a.gc("width",180),a.zb(2),a.gc("width",220),a.zb(2),a.gc("width",180),a.zb(2),a.gc("width",180),a.zb(2),a.gc("width",220),a.zb(2),a.gc("width",200))},directives:[r.G,r.o,r.f,r.ab,c.h,r.x,r.q,r.bb,n.l,n.n,r.w,r.cb,r.u,r.y,s.d,s.e,s.f,s.c,s.b,r.s],styles:[""]}),e})();const N=[{path:"",component:(()=>{class e{constructor(e){this.menuCrtl=e}ngOnInit(){}ionViewWillEnter(){this.menuCrtl.enable(!0)}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(r.U))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-list-report"]],decls:13,vars:1,consts:[[3,"translucent"],["slot","start"],["color","black"]],template:function(e,t){1&e&&(a.Qb(0,"ion-header",0),a.Qb(1,"ion-toolbar"),a.Qb(2,"ion-buttons",1),a.Mb(3,"ion-menu-button"),a.Pb(),a.Qb(4,"ion-title"),a.wc(5,"Visit Report - list"),a.Pb(),a.Pb(),a.Pb(),a.Qb(6,"ion-content"),a.Qb(7,"ion-grid"),a.Qb(8,"ion-row"),a.Qb(9,"ion-col"),a.Qb(10,"ion-label",2),a.wc(11,"List Visit Reporte"),a.Pb(),a.Mb(12,"app-datatable"),a.Pb(),a.Pb(),a.Pb(),a.Pb()),2&e&&a.gc("translucent",!0)},directives:[r.t,r.Q,r.g,r.C,r.P,r.p,r.s,r.G,r.o,r.y,A],styles:[""]}),e})(),pathMatch:"full"},{path:"new",component:(()=>{class e{constructor(e,t,i,o,n,r,s){this.formBuilder=e,this.modalController=t,this.router=i,this.reportVisitService=o,this.DbReportVisitService=n,this.loadingCtrl=r,this.alertCtrl=s,this.auth_user=this.DbReportVisitService.getAuthUser(),this.builderForm(this.auth_user)}ngOnInit(){}builderForm(e){this.new_form_visit_report=this.formBuilder.group({proyecto_id:["",[n.q.required]],nombre_proyecto:["",[n.q.required]],nombre_empresa:["",[n.q.required]],empresa_id:["",[n.q.required]],report_by:[e.descripcion,[n.q.required]],codigo_proyecto:["",[n.q.required]],empleado_id:[e.empleado_id,[n.q.required]],fecha:[k().format("MM/DD/YYYY"),[n.q.required]],comentarios:["",[n.q.required]],dirrecion_proyecto:["",[n.q.required]],images:[[]]})}isFieldValid(e){return!this.new_form_visit_report.get(e).valid&&this.new_form_visit_report.get(e).touched}displayFieldCss(e){return{"has-error":this.isFieldValid(e),"has-feedback":this.isFieldValid(e)}}selectProyectModal(){return Object(p.a)(this,void 0,void 0,function*(){yield this.modalController.getTop();const e=yield this.modalController.create({component:h,cssClass:"my-custom-class",swipeToClose:!0,componentProps:{tipo:"staff"}});return e.onDidDismiss().then(e=>{if(e.data){const t=e.data;this.new_form_visit_report.get("proyecto_id").setValue(t.id),this.new_form_visit_report.get("nombre_proyecto").setValue(t.text),this.new_form_visit_report.get("nombre_empresa").setValue(t.nombre_empresa),this.new_form_visit_report.get("codigo_proyecto").setValue(t.codigo_proyecto),this.new_form_visit_report.get("dirrecion_proyecto").setValue(t.dirrecion),this.new_form_visit_report.get("empresa_id").setValue(t.empresa_id)}}),yield e.present()})}save(){return Object(p.a)(this,void 0,void 0,function*(){if(this.new_form_visit_report.valid){const e=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Loading",duration:2});yield e.present(),this.reportVisitService.SaveVisitReport(this.new_form_visit_report.value).subscribe(t=>Object(p.a)(this,void 0,void 0,function*(){yield e.dismiss(),yield this.alert("Successfully saved"),this.router.navigate(["/visit-report"]),this.new_form_visit_report.reset()}),t=>Object(p.a)(this,void 0,void 0,function*(){this.DbReportVisitService.addNewVisitReportPendiente(this.new_form_visit_report.value).subscribe(t=>Object(p.a)(this,void 0,void 0,function*(){this.new_form_visit_report.value.images.forEach(e=>{this.DbReportVisitService.addNewImage(e,t).subscribe(e=>{})}),yield e.dismiss(),yield this.alert("Successfully saved device"),this.router.navigate(["/visit-report"]),this.new_form_visit_report.reset()}))}))}})}close(){this.router.navigate(["/visit-report"])}selectModal(e){return Object(p.a)(this,void 0,void 0,function*(){yield this.modalController.getTop();const t=yield this.modalController.create({component:f,cssClass:"my-custom-class",swipeToClose:!0,componentProps:{proyecto_id:this.new_form_visit_report.get("proyecto_id").value,tipo:e}});return t.onDidDismiss().then(t=>{if(t.data){const i=t.data,o=this.new_form_visit_report.get("comentarios").value;this.verificandoData(e,o,i)}}),yield t.present()})}verificandoData(e,t,i){switch(e){case"Where":this.new_form_visit_report.get("comentarios").setValue(`${t.trim()}Floor:${i.text.trim()}`);break;case"Problem":this.new_form_visit_report.get("comentarios").setValue(`${t.trim()}\nProblem: ${i.text.trim()}`);break;case"Consecuense":this.new_form_visit_report.get("comentarios").setValue(`${t.trim()}\nConsecuense:${i.text.trim()}`);break;case"Solution":this.new_form_visit_report.get("comentarios").setValue(`${t.trim()}\nSolution:${i.text.trim()}`)}}alert(e){return Object(p.a)(this,void 0,void 0,function*(){const t=yield this.alertCtrl.create({cssClass:"my-custom-class",header:"Alert",subHeader:e,message:"",buttons:["OK"]});yield t.present(),yield t.onDidDismiss()})}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(n.b),a.Lb(r.V),a.Lb(c.g),a.Lb(b.a),a.Lb(l.a),a.Lb(r.T),a.Lb(r.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-new-report"]],decls:88,vars:8,consts:[[3,"translucent"],["slot","start"],["slot","end"],[3,"formGroup"],["size","12"],["position","stacked"],["formControlName","nombre_proyecto","placeholder","select one",3,"click"],["errorMsg","Assign ticket is required",3,"displayError"],["formControlName","nombre_empresa","value","","readonly","",3,"disabled"],["formControlName","codigo_proyecto","value","","readonly","",3,"disabled"],["formControlName","report_by","value","","readonly","",3,"disabled"],["formControlName","nombre_proyecto","value","","readonly","",3,"disabled"],["formControlName","dirrecion_proyecto","value","","readonly","",3,"disabled"],["displayFormat","MM DD YYYY","formControlName","fecha"],["rows","5","cols","5","formControlName","comentarios"],["expand","full",3,"click"],["formControlName","images"],["expand","full","color","danger",3,"click"]],template:function(e,t){1&e&&(a.Qb(0,"ion-header",0),a.Qb(1,"ion-toolbar"),a.Qb(2,"ion-buttons",1),a.Mb(3,"ion-menu-button"),a.Pb(),a.Qb(4,"ion-title"),a.wc(5,"CREATE VISIT REPORT"),a.Pb(),a.Qb(6,"ion-buttons",2),a.Mb(7,"ion-back-button"),a.Pb(),a.Pb(),a.Pb(),a.Qb(8,"ion-content"),a.Qb(9,"ion-card"),a.Mb(10,"ion-card-header"),a.Qb(11,"ion-card-content"),a.Qb(12,"form",3),a.Qb(13,"ion-grid"),a.Qb(14,"ion-row"),a.Qb(15,"ion-col",4),a.Qb(16,"ion-item"),a.Qb(17,"ion-label",5),a.wc(18,"Project:"),a.Pb(),a.Qb(19,"ion-input",6),a.Yb("click",function(){return t.selectProyectModal()}),a.Pb(),a.Pb(),a.Mb(20,"app-field-error-display",7),a.Pb(),a.Qb(21,"ion-col",4),a.Qb(22,"ion-item"),a.Qb(23,"ion-label",5),a.wc(24,"General Contractor"),a.Pb(),a.Mb(25,"ion-input",8),a.Pb(),a.Pb(),a.Qb(26,"ion-col",4),a.Qb(27,"ion-item"),a.Qb(28,"ion-label",5),a.wc(29,"PRECISION WALL TECH PROJECT"),a.Pb(),a.Mb(30,"ion-input",9),a.Pb(),a.Pb(),a.Qb(31,"ion-col",4),a.Qb(32,"ion-item"),a.Qb(33,"ion-label",5),a.wc(34,"Report by"),a.Pb(),a.Mb(35,"ion-input",10),a.Pb(),a.Pb(),a.Qb(36,"ion-col",4),a.Qb(37,"ion-item"),a.Qb(38,"ion-label",5),a.wc(39,"Project Name"),a.Pb(),a.Mb(40,"ion-input",11),a.Pb(),a.Pb(),a.Qb(41,"ion-col",4),a.Qb(42,"ion-item"),a.Qb(43,"ion-label",5),a.wc(44,"Project Address"),a.Pb(),a.Mb(45,"ion-input",12),a.Pb(),a.Pb(),a.Qb(46,"ion-col",4),a.Qb(47,"ion-item"),a.Qb(48,"ion-label",5),a.wc(49,"Date"),a.Pb(),a.Mb(50,"ion-datetime",13),a.Pb(),a.Pb(),a.Pb(),a.Qb(51,"ion-card-header"),a.Qb(52,"ion-card-subtitle"),a.wc(53,"OTHERS TRADES WORK:"),a.Pb(),a.Pb(),a.Qb(54,"ion-row"),a.Qb(55,"ion-col",4),a.Qb(56,"ion-item"),a.Qb(57,"ion-label",5),a.wc(58,"Quality of the substrates: Drywall / wood / metals / concrete etc."),a.Pb(),a.Mb(59,"ion-textarea",14),a.Pb(),a.Pb(),a.Pb(),a.Qb(60,"ion-row"),a.Qb(61,"ion-col"),a.Qb(62,"ion-button",15),a.Yb("click",function(){return t.selectModal("Where")}),a.wc(63,"Where?"),a.Pb(),a.Pb(),a.Qb(64,"ion-col"),a.Qb(65,"ion-button",15),a.Yb("click",function(){return t.selectModal("Problem")}),a.wc(66,"Problems?"),a.Pb(),a.Pb(),a.Qb(67,"ion-col"),a.Qb(68,"ion-button",15),a.Yb("click",function(){return t.selectModal("Consecuense")}),a.wc(69,"Consequences?"),a.Pb(),a.Pb(),a.Qb(70,"ion-col"),a.Qb(71,"ion-button",15),a.Yb("click",function(){return t.selectModal("Solution")}),a.wc(72,"Suggested solution?"),a.Pb(),a.Pb(),a.Pb(),a.Qb(73,"ion-card-header"),a.Qb(74,"ion-card-subtitle"),a.wc(75,"IMAGES:"),a.Pb(),a.Pb(),a.Qb(76,"ion-row"),a.Qb(77,"ion-col",4),a.Mb(78,"app-images",16),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Qb(79,"ion-footer"),a.Qb(80,"ion-grid"),a.Qb(81,"ion-row"),a.Qb(82,"ion-col"),a.Qb(83,"ion-button",15),a.Yb("click",function(){return t.save()}),a.wc(84,"Save"),a.Pb(),a.Pb(),a.Qb(85,"ion-col"),a.Qb(86,"ion-button",17),a.Yb("click",function(){return t.close()}),a.wc(87,"Close"),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb()),2&e&&(a.gc("translucent",!0),a.zb(12),a.gc("formGroup",t.new_form_visit_report),a.zb(8),a.gc("displayError",t.isFieldValid("nombre_proyecto")),a.zb(5),a.gc("disabled",!0),a.zb(5),a.gc("disabled",!0),a.zb(5),a.gc("disabled",!0),a.zb(5),a.gc("disabled",!0),a.zb(5),a.gc("disabled",!0))},directives:[r.t,r.Q,r.g,r.C,r.P,r.d,r.e,r.p,r.h,r.j,r.i,n.r,n.m,n.g,r.s,r.G,r.o,r.x,r.y,r.w,r.cb,n.l,n.e,r.q,r.bb,r.k,r.N,r.f,_,r.r],styles:[""]}),e})()},{path:"edit/:id",component:v},{path:"view-pdf/:id",component:m}];let $=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.Jb({type:e}),e.\u0275inj=a.Ib({imports:[[c.j.forChild(N)],c.j]}),e})(),H=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.Jb({type:e}),e.\u0275inj=a.Ib({imports:[[o.c,n.h,r.R,$,s.g,n.o]]}),e})()}}]);