(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{X3zk:function(e,t,o){"use strict";o.r(t),o.d(t,"LoginPageModule",function(){return S});var n=o("ofXK"),i=o("3Pt+"),r=o("TEn/"),s=o("tyNb"),a=o("mrSG"),l=o("fXoL"),c=o("gcOT"),u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(t){r(t)}}function a(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,a)}l((n=n.apply(e,t||[])).next())})};const d=new class extends c.f{constructor(){super({name:"CapacitorSQLite",platforms:["web"]})}echo(e){return u(this,void 0,void 0,function*(){return console.log("ECHO in Web plugin",e),e})}open(e){return u(this,void 0,void 0,function*(){return console.log("open",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}close(e){return u(this,void 0,void 0,function*(){return console.log("close",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}execute(e){return u(this,void 0,void 0,function*(){return console.log("execute",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}executeSet(e){return u(this,void 0,void 0,function*(){return console.log("execute",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}run(e){return u(this,void 0,void 0,function*(){return console.log("run",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}query(e){return u(this,void 0,void 0,function*(){return console.log("query",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}isDBExists(e){return u(this,void 0,void 0,function*(){return console.log("in Web isDBExists",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}deleteDatabase(e){return u(this,void 0,void 0,function*(){return console.log("deleteDatabase",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}isJsonValid(e){return u(this,void 0,void 0,function*(){return console.log("isJsonValid",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}importFromJson(e){return u(this,void 0,void 0,function*(){return console.log("importFromJson",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}exportToJson(e){return u(this,void 0,void 0,function*(){return console.log("exportToJson",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}createSyncTable(){return u(this,void 0,void 0,function*(){return console.log("createSyncTable"),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}setSyncDate(e){return u(this,void 0,void 0,function*(){return console.log("setSyncDate",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}addUpgradeStatement(e){return u(this,void 0,void 0,function*(){return console.log("addUpgradeStatement",e),Promise.resolve({result:!1,message:"Not implemented on Web Platform"})})}};Object(c.g)(d);var b=o("2Vo4"),m=o("LRne"),g=o("Cfvw"),p=o("eIep"),h=o("tk/3");const{CapacitorSQLite:v,Device:f,Storage:P}=c.e,y="first_db_setup",w="db_name";let x=(()=>{class e{constructor(e,t){this.http=e,this.alertCtrl=t,this.dbReady=new b.a(!1),this.dbName=""}init(){return Object(a.a)(this,void 0,void 0,function*(){if("android"===(yield f.getInfo()).platform)try{const e=v;yield e.requestPermissions(),this.setupDatabase()}catch(e){const t=yield this.alertCtrl.create({header:"No DB access",message:"This app can't work without Database access.",buttons:["OK"]});yield t.present()}else this.setupDatabase()})}setupDatabase(){return Object(a.a)(this,void 0,void 0,function*(){(yield P.get({key:y})).value?(this.dbName=(yield P.get({key:w})).value,yield v.open({database:this.dbName}),this.dbReady.next(!0)):this.downloadDatabase()})}downloadDatabase(e=!1){this.http.get("https://api.anniix.com/api-anime/anniix/ejemplo-db").subscribe(t=>Object(a.a)(this,void 0,void 0,function*(){const o=JSON.stringify(t);(yield v.isJsonValid({jsonstring:o})).result&&(this.dbName=t.database,yield P.set({key:w,value:this.dbName}),yield v.importFromJson({jsonstring:o}),yield P.set({key:y,value:"1"}),e?yield v.setSyncDate({syncdate:""+(new Date).getTime()}):yield v.createSyncTable(),this.dbReady.next(!0))}))}getProductList(){return this.dbReady.pipe(Object(p.a)(e=>{if(e){const e="SELECT * FROM ticket;";return Object(g.a)(v.query({statement:e,values:[]}))}return Object(m.a)({values:[]})}))}getTicketById(e){return Object(a.a)(this,void 0,void 0,function*(){const t=`SELECT * FROM ticket WHERE ticket.ticket_id=${e} ;`;return(yield v.query({statement:t,values:[]})).values[0]})}getDatabaseExport(e){return v.exportToJson({jsonexportmode:e})}addTicket(e){return v.execute({statements:"INSERT INTO ticket (num, foreman_name, superintendent_name, horario,descripcion) VALUES ('1','1','jorge', '06:15','bla bla');"})}deleteTicket(e){return v.execute({statements:`DELETE FROM ticket WHERE ticket_id = ${e};`})}deleteDatabase(){return Object(a.a)(this,void 0,void 0,function*(){const e=yield P.get({key:w});return yield P.set({key:y,value:null}),v.deleteDatabase({database:e.value})})}}return e.\u0275fac=function(t){return new(t||e)(l.Ub(h.a),l.Ub(r.a))},e.\u0275prov=l.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var N=o("XNvx");const k=[{path:"",component:(()=>{class e{constructor(e,t,o,n,i,r){this.route=e,this.menuCrtl=t,this.databaseService=o,this.loginService=n,this.formBuilder=i,this.alertCtrl=r,this.products=[],this.builderForm()}builderForm(){this.form_login=this.formBuilder.group({username:["",[i.q.required]],password:["",[i.q.required]]})}ngOnInit(){}ionViewWillEnter(){this.menuCrtl.enable(!1)}ionViewWillLeave(){this.menuCrtl.enable(!1)}save(){this.loginService.login(this.form_login.get("username").value,this.form_login.get("password").value).subscribe(e=>{console.log(e),"error"==e.status?this.alert(e.message):(this.loginService.setToken(e.token),this.loginService.setUser(e.nombre_completo),this.loginService.setNickName(e.Nick_Name),this.loginService.addAuthUser(e),this.route.navigate(["/ticket"]))},e=>{this.alert("your internet connection failed")})}alert(e){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.alertCtrl.create({cssClass:"my-custom-class",header:"Alert",subHeader:"solicitud hecha",message:e,buttons:["OK"]});yield t.present(),yield t.onDidDismiss()})}loadProducts(){this.databaseService.getProductList().subscribe(e=>{this.products=e.values})}}return e.\u0275fac=function(t){return new(t||e)(l.Lb(s.g),l.Lb(r.M),l.Lb(x),l.Lb(N.a),l.Lb(i.b),l.Lb(r.a))},e.\u0275cmp=l.Fb({type:e,selectors:[["app-login"]],decls:36,vars:1,consts:[[1,"grid1"],[1,"row1"],[1,"row2"],[1,"contaier-login"],[3,"formGroup","ngSubmit"],["src","assets/img/logo.png","alt","logo",1,"rounded","logo"],["name","person",1,"icon-login"],["name","usuario","formControlName","username","type","text","required","","placeholder","User"],["name","lock",1,"icon-login"],["name","password","formControlName","password","type","password","required","","placeholder","password"],["type","submit","fill","solid","expand","full"]],template:function(e,t){1&e&&(l.Qb(0,"ion-header"),l.Qb(1,"ion-toolbar"),l.Qb(2,"ion-title"),l.vc(3,"Login"),l.Pb(),l.Pb(),l.Pb(),l.Qb(4,"ion-content"),l.Qb(5,"ion-grid",0),l.Qb(6,"ion-row",1),l.Mb(7,"ion-col"),l.Pb(),l.Qb(8,"ion-row",2),l.Mb(9,"ion-col"),l.Pb(),l.Pb(),l.Qb(10,"ion-slide"),l.Qb(11,"div",3),l.Qb(12,"ion-grid"),l.Qb(13,"form",4),l.Yb("ngSubmit",function(){return t.save()}),l.Qb(14,"ion-row"),l.Qb(15,"ion-col"),l.Mb(16,"img",5),l.Pb(),l.Pb(),l.Qb(17,"ion-row"),l.Qb(18,"ion-col"),l.Qb(19,"ion-list"),l.Qb(20,"ion-item"),l.Mb(21,"ion-icon",6),l.Mb(22,"ion-input",7),l.Pb(),l.Mb(23,"br"),l.Qb(24,"ion-item"),l.Mb(25,"ion-icon",8),l.Mb(26,"ion-input",9),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(27,"ion-row"),l.Qb(28,"ion-col"),l.Qb(29,"ion-button",10),l.vc(30," Enter "),l.Pb(),l.Pb(),l.Pb(),l.Qb(31,"ion-row"),l.Qb(32,"ion-col"),l.Qb(33,"ion-label"),l.Qb(34,"h3"),l.vc(35,"\xbfOlvido la contrase\xf1a?"),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb()),2&e&&(l.zb(13),l.fc("formGroup",t.form_login))},directives:[r.m,r.I,r.H,r.j,r.l,r.z,r.i,r.D,i.r,i.m,i.g,r.s,r.q,r.n,r.p,r.T,i.l,i.e,i.p,r.c,r.r],styles:[".grid1[_ngcontent-%COMP%]{height:100%;padding:0}.contaier-login[_ngcontent-%COMP%]{width:90%;padding:10px;background:#fff;border-radius:5px;box-shadow:0 0 10px 1px rgba(0,0,0,.75)}.row1[_ngcontent-%COMP%]{background:linear-gradient(45deg,#3039e9,rgba(34,88,238,.8) 50%)}.row1[_ngcontent-%COMP%], .row2[_ngcontent-%COMP%]{height:50%}ion-icon[_ngcontent-%COMP%]{margin-right:15px}ion-button[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:15px}ion-slide[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute!important;top:0!important}.logo[_ngcontent-%COMP%]{max-width:50%;height:auto}"]}),e})()}];let O=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.Jb({type:e}),e.\u0275inj=l.Ib({imports:[[s.j.forChild(k)],s.j]}),e})(),S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.Jb({type:e}),e.\u0275inj=l.Ib({imports:[[n.c,i.h,r.J,O,i.o]]}),e})()}}]);