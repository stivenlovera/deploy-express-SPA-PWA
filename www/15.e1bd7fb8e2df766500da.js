(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{ROBH:function(e,t,i){"use strict";i.r(t),i.d(t,"TicketPageModule",function(){return Qe});var a=i("ofXK"),o=i("3Pt+"),n=i("lDzL"),r=i("TEn/"),s=i("tk/3"),l=i("tyNb"),c=i("mrSG"),d=i("fXoL"),b=i("JwAU");function u(e,t){if(1&e){const e=d.Rb();d.Qb(0,"ion-col",4),d.Qb(1,"ion-card",5),d.Mb(2,"ion-img",6),d.Qb(3,"ion-item"),d.Qb(4,"ion-button",7),d.Yb("click",function(){d.pc(e);const i=t.index;return d.ac().delete(i)}),d.Mb(5,"ion-icon",8),d.Pb(),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit;d.zb(2),d.gc("src",e.webviewPath)}}let h=(()=>{class e{constructor(e){this.ticketService=e,this.photos=[],this.onChange=e=>{},this.onTouch=()=>{},this.images=new o.a([])}ngOnInit(){return Object(c.a)(this,void 0,void 0,function*(){})}loadImages(){this.images.clear(),this.ticketService.loadSaved(this.tipo).then(()=>{this.ticketService.getPhotos(this.tipo).map(e=>{const t=new o.f({filepath:new o.c(e.filepath),webviewPath:new o.c(e.webviewPath)});this.images.push(t)})})}newPhoto(){return Object(c.a)(this,void 0,void 0,function*(){console.log(this.tipo);const e=yield this.ticketService.addNewGalery(this.tipo);console.log(e);const t=new o.f({filepath:new o.c(e.filepath),webviewPath:new o.c(e.webviewPath)});this.images.push(t),this.onTouch(),this.images.valueChanges.subscribe(e=>{this.onChange(e)})})}delete(e){this.images.removeAt(e),this.onTouch(),this.images.valueChanges.subscribe(e=>{this.onChange(e)})}writeValue(e){this.images=new o.a(e.map(e=>new o.f({filepath:new o.c(e.filepath),webviewPath:new o.c(e.webviewPath)}))),this.onTouch(),this.images.valueChanges.subscribe(e=>{this.onChange(e)})}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouch=e}setDisabledState(){}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(b.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-images"]],inputs:{tipo:"tipo"},features:[d.yb([{provide:o.j,multi:!0,useExisting:Object(d.U)(()=>e)}])],decls:7,vars:2,consts:[["size","6",4,"ngFor","ngForOf"],["size","12"],["type","button","expand","full",3,"click"],["name","camera-outline"],["size","6"],[1,"block"],[3,"src"],["fill","outline","slot","end",3,"click"],["name","trash",1,"deleteIcon"]],template:function(e,t){1&e&&(d.Qb(0,"ion-grid"),d.Qb(1,"ion-row"),d.uc(2,u,6,1,"ion-col",0),d.Qb(3,"ion-col",1),d.Qb(4,"ion-button",2),d.Yb("click",function(){return t.newPhoto()}),d.Mb(5,"ion-icon",3),d.wc(6),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.zb(2),d.gc("ngForOf",t.images.value),d.zb(4),d.yc(" \xa0 Capture ",t.tipo," images "))},directives:[r.q,r.E,a.j,r.m,r.e,r.s,r.g,r.t,r.v],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#000}"]}),e})();var m=i("IDvd");function p(e,t){if(1&e){const e=d.Rb();d.Qb(0,"ion-item"),d.Qb(1,"ion-label",5),d.Yb("click",function(){d.pc(e);const i=t.$implicit;return d.ac().close(i.id)}),d.wc(2),d.Mb(3,"br"),d.Qb(4,"p"),d.wc(5),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit;d.zb(2),d.yc("",e.text," "),d.zb(3),d.yc(" ",e.descripcion_traduccion,"")}}let g=(()=>{class e{constructor(e,t,i,a){this.ticketService=e,this.modalController=t,this.navParams=i,this.dbPwaService=a,this.searchTerm="",this.tipo=i.get("tipo")}ngOnInit(){return Object(c.a)(this,void 0,void 0,function*(){switch(this.tipo){case"staff":yield this.selectPersona();break;case"what":this.selectSearchWhat();break;case"where":this.selectSearchWhere();break;case"why":this.selectSearchWhy();break;case"class Worker":this.selectSearchClassWorker();break;case"materials":const e=this.navParams.get("id");this.selectSearchMateriales(e)}})}selectPersona(){return Object(c.a)(this,void 0,void 0,function*(){this.ticketService.getSelectAllPersonal().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.empleado_id,text:e.descripcion}));this.data=t,this.temp=t,yield this.setFilteredItems()}),e=>Object(c.a)(this,void 0,void 0,function*(){this.dbPwaService.getallpersonal().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.empleado_id,text:e.descripcion}));this.data=t,this.temp=t,yield this.setFilteredItems()}))}))})}selectSearchWhat(){return Object(c.a)(this,void 0,void 0,function*(){this.ticketService.getSelectAllWhat().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.id_question,text:e.descripcion,descripcion_traduccion:e.descripcion_traduccion}));this.data=t,this.temp=t,yield this.setFilteredItems()}),e=>Object(c.a)(this,void 0,void 0,function*(){this.dbPwaService.getallWhat().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.id_question,text:e.descripcion,descripcion_traduccion:e.descripcion_traduccion}));this.data=t,this.temp=t,yield this.setFilteredItems()}))}))})}selectSearchWhere(){return Object(c.a)(this,void 0,void 0,function*(){this.ticketService.getSelectAllWhere().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.area_id,text:e.descripcion}));this.data=t,this.temp=t,yield this.setFilteredItems()}),e=>Object(c.a)(this,void 0,void 0,function*(){this.dbPwaService.getallWhere().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.area_id,text:e.descripcion}));this.data=t,this.temp=t,yield this.setFilteredItems()}))}))})}selectSearchClassWorker(){return Object(c.a)(this,void 0,void 0,function*(){this.ticketService.getSelectAllClassWorker().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){console.log(e);const t=e.map(e=>({id:e.id_trabajo,text:e.nombre}));this.data=t,this.temp=t,yield this.setFilteredItems()}),e=>Object(c.a)(this,void 0,void 0,function*(){this.dbPwaService.getallClassWorker().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.id_trabajo,text:e.nombre}));this.data=t,this.temp=t,yield this.setFilteredItems()}))}))})}selectSearchWhy(){return Object(c.a)(this,void 0,void 0,function*(){this.ticketService.getSelectAllWhy().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.id_question,text:e.descripcion,descripcion_traduccion:e.descripcion_traduccion}));this.data=t,this.temp=t,yield this.setFilteredItems()}),e=>Object(c.a)(this,void 0,void 0,function*(){this.dbPwaService.getallWhy().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.id_question,text:e.descripcion,descripcion_traduccion:e.descripcion_traduccion}));this.data=t,this.temp=t,yield this.setFilteredItems()}))}))})}selectSearchMateriales(e){return Object(c.a)(this,void 0,void 0,function*(){this.ticketService.getSelectSearchMaterial(e).subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.id_material,text:e.denominacion,unidad_medida:e.unidad_medida}));this.data=t,this.temp=t,this.setFilteredItems()}),e=>Object(c.a)(this,void 0,void 0,function*(){this.dbPwaService.getallMateriales().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){const t=e.map(e=>({id:e.id_material,text:e.denominacion,unidad_medida:e.unidad_medida}));this.data=t,this.temp=t,yield this.setFilteredItems()}))}))})}setFilteredItems(){return Object(c.a)(this,void 0,void 0,function*(){this.temp=this.data,this.temp=this.filterItems(this.searchTerm)})}filterItems(e){return this.temp.filter(t=>t.text.toLowerCase().indexOf(e.toLowerCase())>-1)}close(e){let t=this.temp.filter(t=>t.id==e);this.modalController.dismiss(t[0])}closeModal(){this.modalController.dismiss()}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(b.a),d.Lb(r.T),d.Lb(r.V),d.Lb(m.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-select-search"]],decls:11,vars:7,consts:[["slot","end","color","light",3,"click"],["slot","icon-only","name","close"],["padding",""],[3,"ngModel","ngModelChange","ionChange"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(d.Qb(0,"ion-header"),d.Qb(1,"ion-toolbar"),d.Qb(2,"ion-title"),d.wc(3),d.Pb(),d.Qb(4,"ion-button",0),d.Yb("click",function(){return t.closeModal()}),d.Mb(5,"ion-icon",1),d.Pb(),d.Pb(),d.Pb(),d.Qb(6,"ion-content",2),d.Qb(7,"ion-searchbar",3),d.Yb("ngModelChange",function(e){return t.searchTerm=e})("ionChange",function(){return t.setFilteredItems()}),d.Pb(),d.Qb(8,"ion-list"),d.uc(9,p,6,2,"ion-item",4),d.bc(10,"slice"),d.Pb(),d.Pb()),2&e&&(d.zb(3),d.yc("Select ",t.tipo,""),d.zb(4),d.gc("ngModel",t.searchTerm),d.zb(2),d.gc("ngForOf",d.dc(10,3,t.temp,0,90)))},directives:[r.r,r.O,r.N,r.e,r.s,r.n,r.F,r.ab,o.l,o.n,r.x,a.j,r.v,r.w],pipes:[a.p],styles:[""]}),e})();var f=i("AytR");class w{constructor(e,t,i){this.x=e,this.y=t,this.time=i||Date.now()}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}equals(e){return this.x===e.x&&this.y===e.y&&this.time===e.time}velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}}class v{constructor(e,t,i,a,o,n){this.startPoint=e,this.control2=t,this.control1=i,this.endPoint=a,this.startWidth=o,this.endWidth=n}static fromPoints(e,t){const i=this.calculateControlPoints(e[0],e[1],e[2]).c2,a=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new v(e[1],i,a,e[2],t.start,t.end)}static calculateControlPoints(e,t,i){const a=e.x-t.x,o=e.y-t.y,n=t.x-i.x,r=t.y-i.y,s=(e.x+t.x)/2,l=(e.y+t.y)/2,c=(t.x+i.x)/2,d=(t.y+i.y)/2,b=Math.sqrt(a*a+o*o),u=Math.sqrt(n*n+r*r),h=u/(b+u),m=t.x-(c+(s-c)*h),p=t.y-(d+(l-d)*h);return{c1:new w(s+m,l+p),c2:new w(c+m,d+p)}}length(){let e,t,i=0;for(let a=0;a<=10;a+=1){const o=a/10,n=this.point(o,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),r=this.point(o,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(a>0){const a=n-e,o=r-t;i+=Math.sqrt(a*a+o*o)}e=n,t=r}return i}point(e,t,i,a,o){return t*(1-e)*(1-e)*(1-e)+3*i*(1-e)*(1-e)*e+3*a*(1-e)*e*e+o*e*e*e}}class y{constructor(e,t={}){this.canvas=e,this.options=t,this._handleMouseDown=e=>{1===e.which&&(this._mouseButtonDown=!0,this._strokeBegin(e))},this._handleMouseMove=e=>{this._mouseButtonDown&&this._strokeMoveUpdate(e)},this._handleMouseUp=e=>{1===e.which&&this._mouseButtonDown&&(this._mouseButtonDown=!1,this._strokeEnd(e))},this._handleTouchStart=e=>{e.preventDefault(),1===e.targetTouches.length&&this._strokeBegin(e.changedTouches[0])},this._handleTouchMove=e=>{e.preventDefault(),this._strokeMoveUpdate(e.targetTouches[0])},this._handleTouchEnd=e=>{e.target===this.canvas&&(e.preventDefault(),this._strokeEnd(e.changedTouches[0]))},this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle="throttle"in t?t.throttle:16,this.minDistance="minDistance"in t?t.minDistance:5,this.dotSize=t.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.onBegin=t.onBegin,this.onEnd=t.onEnd,this._strokeMoveUpdate=this.throttle?function(e,t=250){let i,a,o,n=0,r=null;const s=()=>{n=Date.now(),r=null,i=e.apply(a,o),r||(a=null,o=[])};return function(...l){const c=Date.now(),d=t-(c-n);return a=this,o=l,d<=0||d>t?(r&&(clearTimeout(r),r=null),n=c,i=e.apply(a,o),r||(a=null,o=[])):r||(r=window.setTimeout(s,d)),i}}(y.prototype._strokeUpdate,this.throttle):y.prototype._strokeUpdate,this._ctx=e.getContext("2d"),this.clear(),this.on()}clear(){const{_ctx:e,canvas:t}=this;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(),this._isEmpty=!0}fromDataURL(e,t={},i){const a=new Image,o=t.ratio||window.devicePixelRatio||1,n=t.width||this.canvas.width/o,r=t.height||this.canvas.height/o;this._reset(),a.onload=()=>{this._ctx.drawImage(a,0,0,n,r),i&&i()},a.onerror=e=>{i&&i(e)},a.src=e,this._isEmpty=!1}toDataURL(e="image/png",t){switch(e){case"image/svg+xml":return this._toSVG();default:return this.canvas.toDataURL(e,t)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",window.PointerEvent?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.removeEventListener("pointerdown",this._handleMouseDown),this.canvas.removeEventListener("pointermove",this._handleMouseMove),document.removeEventListener("pointerup",this._handleMouseUp),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(e){this.clear(),this._fromData(e,({color:e,curve:t})=>this._drawCurve({color:e,curve:t}),({color:e,point:t})=>this._drawDot({color:e,point:t})),this._data=e}toData(){return this._data}_strokeBegin(e){const t={color:this.penColor,points:[]};"function"==typeof this.onBegin&&this.onBegin(e),this._data.push(t),this._reset(),this._strokeUpdate(e)}_strokeUpdate(e){if(0===this._data.length)return void this._strokeBegin(e);const t=this._createPoint(e.clientX,e.clientY),i=this._data[this._data.length-1],a=i.points,o=a.length>0&&a[a.length-1],n=!!o&&t.distanceTo(o)<=this.minDistance,r=i.color;if(!o||!o||!n){const e=this._addPoint(t);o?e&&this._drawCurve({color:r,curve:e}):this._drawDot({color:r,point:t}),a.push({time:t.time,x:t.x,y:t.y})}}_strokeEnd(e){this._strokeUpdate(e),"function"==typeof this.onEnd&&this.onEnd(e)}_handlePointerEvents(){this._mouseButtonDown=!1,this.canvas.addEventListener("pointerdown",this._handleMouseDown),this.canvas.addEventListener("pointermove",this._handleMouseMove),document.addEventListener("pointerup",this._handleMouseUp)}_handleMouseEvents(){this._mouseButtonDown=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)}_reset(){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor}_createPoint(e,t){const i=this.canvas.getBoundingClientRect();return new w(e-i.left,t-i.top,(new Date).getTime())}_addPoint(e){const{_lastPoints:t}=this;if(t.push(e),t.length>2){3===t.length&&t.unshift(t[0]);const e=this._calculateCurveWidths(t[1],t[2]),i=v.fromPoints(t,e);return t.shift(),i}return null}_calculateCurveWidths(e,t){const i=this.velocityFilterWeight*t.velocityFrom(e)+(1-this.velocityFilterWeight)*this._lastVelocity,a=this._strokeWidth(i),o={end:a,start:this._lastWidth};return this._lastVelocity=i,this._lastWidth=a,o}_strokeWidth(e){return Math.max(this.maxWidth/(e+1),this.minWidth)}_drawCurveSegment(e,t,i){const a=this._ctx;a.moveTo(e,t),a.arc(e,t,i,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve({color:e,curve:t}){const i=this._ctx,a=t.endWidth-t.startWidth,o=2*Math.floor(t.length());i.beginPath(),i.fillStyle=e;for(let n=0;n<o;n+=1){const e=n/o,i=e*e,r=i*e,s=1-e,l=s*s,c=l*s;let d=c*t.startPoint.x;d+=3*l*e*t.control1.x,d+=3*s*i*t.control2.x,d+=r*t.endPoint.x;let b=c*t.startPoint.y;b+=3*l*e*t.control1.y,b+=3*s*i*t.control2.y,b+=r*t.endPoint.y;const u=Math.min(t.startWidth+r*a,this.maxWidth);this._drawCurveSegment(d,b,u)}i.closePath(),i.fill()}_drawDot({color:e,point:t}){const i=this._ctx,a="function"==typeof this.dotSize?this.dotSize():this.dotSize;i.beginPath(),this._drawCurveSegment(t.x,t.y,a),i.closePath(),i.fillStyle=e,i.fill()}_fromData(e,t,i){for(const a of e){const{color:e,points:o}=a;if(o.length>1)for(let i=0;i<o.length;i+=1){const a=o[i],n=new w(a.x,a.y,a.time);this.penColor=e,0===i&&this._reset();const r=this._addPoint(n);r&&t({color:e,curve:r})}else this._reset(),i({color:e,point:o[0]})}}_toSVG(){const e=this._data,t=Math.max(window.devicePixelRatio||1,1),i=this.canvas.width/t,a=this.canvas.height/t,o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("width",this.canvas.width.toString()),o.setAttribute("height",this.canvas.height.toString()),this._fromData(e,({color:e,curve:t})=>{const i=document.createElement("path");if(!(isNaN(t.control1.x)||isNaN(t.control1.y)||isNaN(t.control2.x)||isNaN(t.control2.y))){const a=`M ${t.startPoint.x.toFixed(3)},${t.startPoint.y.toFixed(3)} C ${t.control1.x.toFixed(3)},${t.control1.y.toFixed(3)} ${t.control2.x.toFixed(3)},${t.control2.y.toFixed(3)} ${t.endPoint.x.toFixed(3)},${t.endPoint.y.toFixed(3)}`;i.setAttribute("d",a),i.setAttribute("stroke-width",(2.25*t.endWidth).toFixed(3)),i.setAttribute("stroke",e),i.setAttribute("fill","none"),i.setAttribute("stroke-linecap","round"),o.appendChild(i)}},({color:e,point:t})=>{const i=document.createElement("circle"),a="function"==typeof this.dotSize?this.dotSize():this.dotSize;i.setAttribute("r",a.toString()),i.setAttribute("cx",t.x.toString()),i.setAttribute("cy",t.y.toString()),i.setAttribute("fill",e),o.appendChild(i)});const n=`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 ${i} ${a}" width="${i}" height="${a}">`;let r=o.innerHTML;if(void 0===r){const e=document.createElement("dummy"),t=o.childNodes;e.innerHTML="";for(let i=0;i<t.length;i+=1)e.appendChild(t[i].cloneNode(!0));r=e.innerHTML}return"data:image/svg+xml;base64,"+btoa(n+r+"</svg>")}}var P=y;const k=["canvas"];let _=(()=>{class e{constructor(e,t){this.modalController=e,this.navParams=t}ngOnInit(){}ngAfterViewInit(){this.signaturePad=new P(this.signaturePadElement.nativeElement),""!=this.data&&this.signaturePad.fromDataURL(this.data)}save(){const e=this.signaturePad.toDataURL();this.modalController.dismiss(e)}close(){this.modalController.dismiss()}clear(){this.signaturePad.clear()}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(r.T),d.Lb(r.V))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-signature"]],viewQuery:function(e,t){if(1&e&&d.Bc(k,3),2&e){let e;d.mc(e=d.Zb())&&(t.signaturePadElement=e.first)}},inputs:{tipo:"tipo",data:"data"},decls:23,vars:0,consts:[["slot","end","color","light",3,"click"],["slot","icon-only","name","close"],["padding",""],["size","12","text-center",""],[1,"signature-pad--body"],["width","500","height","450",2,"touch-action","none"],["canvas",""],["expand","full",3,"click"],["expand","full","color","warning",3,"click"],["color","danger","expand","full",3,"click"]],template:function(e,t){1&e&&(d.Qb(0,"ion-header"),d.Qb(1,"ion-toolbar"),d.Qb(2,"ion-title"),d.wc(3,"Tap to sign "),d.Pb(),d.Qb(4,"ion-button",0),d.Yb("click",function(){return t.close()}),d.Mb(5,"ion-icon",1),d.Pb(),d.Pb(),d.Pb(),d.Qb(6,"ion-content",2),d.Qb(7,"ion-col",3),d.Qb(8,"ion-item"),d.Qb(9,"div",4),d.Mb(10,"canvas",5,6),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(12,"ion-footer"),d.Qb(13,"ion-row"),d.Qb(14,"ion-col"),d.Qb(15,"ion-button",7),d.Yb("click",function(){return t.save()}),d.wc(16,"Save"),d.Pb(),d.Pb(),d.Qb(17,"ion-col"),d.Qb(18,"ion-button",8),d.Yb("click",function(){return t.clear()}),d.wc(19,"Clear"),d.Pb(),d.Pb(),d.Qb(20,"ion-col"),d.Qb(21,"ion-button",9),d.Yb("click",function(){return t.close()}),d.wc(22,"Close"),d.Pb(),d.Pb(),d.Pb(),d.Pb())},directives:[r.r,r.O,r.N,r.e,r.s,r.n,r.m,r.v,r.p,r.E],styles:[".signature-pad[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;font-size:10px;width:100%;height:100%;max-width:900px;max-height:600px;border:1px solid #e8e8e8;background-color:#fff;box-shadow:0 1px 4px rgba(0,0,0,.27),inset 0 0 40px rgba(0,0,0,.08);border-radius:4px;padding:16px}.signature-pad--body[_ngcontent-%COMP%]{position:relative;flex:1;border:1px solid #f4f4f4}"]}),e})();var x=i("Y6JD");function Q(e,t){if(1&e&&(d.Qb(0,"div"),d.Ob(1),d.Qb(2,"small",1),d.wc(3),d.Pb(),d.Nb(),d.Pb()),2&e){const e=d.ac();d.zb(3),d.xc(e.errorMsg)}}let M=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=d.Fb({type:e,selectors:[["app-field-error-display"]],inputs:{errorMsg:"errorMsg",displayError:"displayError"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"error-message"]],template:function(e,t){1&e&&d.uc(0,Q,4,1,"div",0),2&e&&d.gc("ngIf",t.displayError)},directives:[a.k],styles:[".error-message[_ngcontent-%COMP%]{color:var(--ion-color-danger)}"]}),e})();function C(e,t){if(1&e){const e=d.Rb();d.Qb(0,"ion-card"),d.Qb(1,"ion-card-content"),d.Ob(2,4),d.Qb(3,"ion-col",5),d.Qb(4,"ion-item"),d.Qb(5,"ion-label",6),d.wc(6,"MATERIAL DESCRIPTION"),d.Pb(),d.Qb(7,"ion-input",7),d.Yb("click",function(){d.pc(e);const i=t.index;return d.ac().selectMaterialModal(i)}),d.Pb(),d.Pb(),d.Mb(8,"app-field-error-display",8),d.Pb(),d.Qb(9,"ion-col",5),d.Qb(10,"ion-item"),d.Qb(11,"ion-label",6),d.wc(12,"UNIT OF MEASUREMENT"),d.Pb(),d.Mb(13,"ion-input",9),d.Pb(),d.Pb(),d.Qb(14,"ion-col",5),d.Qb(15,"ion-item"),d.Qb(16,"ion-label",6),d.wc(17,"QTY"),d.Pb(),d.Mb(18,"ion-input",10),d.Pb(),d.Mb(19,"app-field-error-display",11),d.Pb(),d.Nb(),d.Qb(20,"ion-button",12),d.Yb("click",function(){d.pc(e);const i=t.index;return d.ac().removeMaterial(i)}),d.wc(21,"delete"),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=t.index,i=d.ac();d.zb(2),d.gc("formGroup",i.getFormGroupAt(e)),d.zb(6),d.gc("displayError",i.isFieldValid("descripcion",e)),d.zb(5),d.gc("disabled",!0),d.zb(6),d.gc("displayError",i.isFieldValid("cantidad",e))}}function O(e,t){1&e&&(d.Qb(0,"ion-card"),d.Qb(1,"ion-card-content"),d.Qb(2,"ion-col",5),d.Qb(3,"ion-label"),d.wc(4,"I don't add anything"),d.Pb(),d.Pb(),d.Pb(),d.Pb())}let F=(()=>{class e{constructor(e){this.modalController=e,this.onChange=e=>{},this.onTouch=()=>{}}ngOnInit(){}addMaterial(){const e=new o.f({id_material:new o.c("",[o.q.required]),descripcion:new o.c("",[o.q.required]),unidad_medida:new o.c("",[o.q.required]),cantidad:new o.c(0,[o.q.required,o.q.min(1),o.q.max(15e3)])});if(this.materiales.push(e),this.materiales.valid)console.log("form material");else{this.materiales.at(0);for(let e=0;e<this.materiales.length;e++)this.validateAllFormFields(this.materiales.at(e))}this.onTouch(),this.materiales.valueChanges.subscribe(e=>{this.onChange(e)})}getFormGroupAt(e){return this.materiales.at(e)}removeMaterial(e){this.materiales.removeAt(e),this.onTouch(),this.materiales.valueChanges.subscribe(e=>{this.onChange(e)})}isFieldValid(e,t){return!this.materiales.at(t).get(e).valid&&this.materiales.at(t).get(e).touched}validateAllFormFields(e){Object.keys(e.controls).forEach(t=>{const i=e.get(t);i instanceof o.c?i.markAsTouched({onlySelf:!0}):i instanceof o.f&&this.validateAllFormFields(i)})}selectMaterialModal(e){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:g,cssClass:"my-custom-class",componentProps:{tipo:"materials",id:1506}});return t.onDidDismiss().then(t=>{if(t.data){const i=t.data;this.materiales.at(e).get("id_material").setValue(i.id),this.materiales.at(e).get("descripcion").setValue(i.text),this.materiales.at(e).get("unidad_medida").setValue(i.unidad_medida)}}),yield t.present()})}writeValue(e){this.materiales=new o.a(e.map(e=>new o.f({id_material:new o.c(e.id_material,[o.q.required]),descripcion:new o.c(e.descripcion,[o.q.required]),unidad_medida:new o.c(e.unidad_medida,[o.q.required]),cantidad:new o.c(e.cantidad,[o.q.required,o.q.min(1),o.q.max(15e3)])}))),this.materiales.valueChanges.subscribe(e=>{this.onChange(e)})}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouch=e}setDisabledState(){}validate({}){return!this.materiales||this.materiales.valid?null:{error:"error"}}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(r.T))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-material"]],features:[d.yb([{provide:o.j,multi:!0,useExisting:Object(d.U)(()=>e)},{provide:o.i,multi:!0,useExisting:Object(d.U)(()=>e)}])],decls:12,vars:3,consts:[[4,"ngFor","ngForOf"],[4,"ngIf"],["type","button","expand","full",3,"click"],["expand","full",3,"disabled"],[3,"formGroup"],["size","12"],["position","stacked"],["formControlName","descripcion","value","",3,"click"],["errorMsg","description is required",3,"displayError"],["formControlName","unidad_medida","value","","readonly","",3,"disabled"],["type","number","formControlName","cantidad","value",""],["errorMsg","quantity is required and greater 0",3,"displayError"],["expand","full",3,"click"]],template:function(e,t){1&e&&(d.Qb(0,"ion-card-header"),d.Qb(1,"ion-card-subtitle"),d.wc(2,"Material"),d.Pb(),d.Pb(),d.uc(3,C,22,4,"ion-card",0),d.uc(4,O,5,0,"ion-card",1),d.Qb(5,"ion-row"),d.Qb(6,"ion-col"),d.Qb(7,"ion-button",2),d.Yb("click",function(){return t.addMaterial()}),d.wc(8,"Add Material"),d.Pb(),d.Pb(),d.Qb(9,"ion-col"),d.Qb(10,"ion-button",3),d.wc(11,"Create Material"),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.zb(3),d.gc("ngForOf",t.materiales.controls),d.zb(1),d.gc("ngIf",0===t.materiales.length),d.zb(6),d.gc("disabled",!0))},directives:[r.i,r.j,a.j,a.k,r.E,r.m,r.e,r.g,r.h,o.m,o.g,r.v,r.w,r.u,r.ab,o.l,o.e,M,r.W],styles:[""]}),e})();function z(e,t){if(1&e){const e=d.Rb();d.Qb(0,"ion-card"),d.Qb(1,"ion-card-content"),d.Ob(2,4),d.Qb(3,"ion-col",5),d.Qb(4,"ion-item"),d.Qb(5,"ion-label",6),d.wc(6,"N\xb0 WORKERS"),d.Pb(),d.Mb(7,"ion-input",7),d.Pb(),d.Mb(8,"app-field-error-display",8),d.Pb(),d.Qb(9,"ion-col",5),d.Qb(10,"ion-item"),d.Qb(11,"ion-label",6),d.wc(12,"CLASS"),d.Pb(),d.Qb(13,"ion-input",9),d.Yb("click",function(){d.pc(e);const i=t.index;return d.ac().selectClassWorker(i)}),d.Pb(),d.Pb(),d.Mb(14,"app-field-error-display",10),d.Pb(),d.Qb(15,"ion-col",5),d.Qb(16,"ion-item"),d.Qb(17,"ion-label",6),d.wc(18,"REG HOURS"),d.Pb(),d.Qb(19,"ion-input",11),d.Yb("keyup",function(){d.pc(e);const i=t.index,a=d.ac();return a.valueChange(a.workers.at(i).get("n_worker").value,a.workers.at(i).get("reg_hours").value,i,"horas")}),d.Pb(),d.Pb(),d.Mb(20,"app-field-error-display",12),d.Pb(),d.Qb(21,"ion-col",5),d.Qb(22,"ion-item"),d.Qb(23,"ion-label",6),d.wc(24,"TOTAL REG HOURS"),d.Pb(),d.Mb(25,"ion-input",13),d.Pb(),d.Pb(),d.Qb(26,"ion-col",5),d.Qb(27,"ion-item"),d.Qb(28,"ion-label",6),d.wc(29,"PREMIUM HOURS"),d.Pb(),d.Qb(30,"ion-input",14),d.Yb("keyup",function(){d.pc(e);const i=t.index,a=d.ac();return a.valueChange(a.workers.at(i).get("n_worker").value,a.workers.at(i).get("premium_hours").value,i,"premium_horas")}),d.Pb(),d.Pb(),d.Mb(31,"app-field-error-display",15),d.Pb(),d.Qb(32,"ion-col",5),d.Qb(33,"ion-item"),d.Qb(34,"ion-label",6),d.wc(35,"TOTAL PREMIUM HOURS"),d.Pb(),d.Mb(36,"ion-input",16),d.Pb(),d.Pb(),d.Qb(37,"ion-col",5),d.Qb(38,"ion-item"),d.Qb(39,"ion-label",6),d.wc(40,"OUT HOURS"),d.Pb(),d.Qb(41,"ion-input",17),d.Yb("keyup",function(){d.pc(e);const i=t.index,a=d.ac();return a.valueChange(a.workers.at(i).get("n_worker").value,a.workers.at(i).get("out_hours").value,i,"out_horas")}),d.Pb(),d.Pb(),d.Mb(42,"app-field-error-display",18),d.Pb(),d.Qb(43,"ion-col",5),d.Qb(44,"ion-item"),d.Qb(45,"ion-label",6),d.wc(46,"TOTAL OUT HOURS"),d.Pb(),d.Mb(47,"ion-input",19),d.Pb(),d.Pb(),d.Qb(48,"ion-col",5),d.Qb(49,"ion-item"),d.Qb(50,"ion-label",6),d.wc(51,"PREPAID HOURS"),d.Pb(),d.Qb(52,"ion-input",20),d.Yb("keyup",function(){d.pc(e);const i=t.index,a=d.ac();return a.valueChange(a.workers.at(i).get("n_worker").value,a.workers.at(i).get("prepaid_hours").value,i,"prepaid_horas")}),d.Pb(),d.Pb(),d.Mb(53,"app-field-error-display",21),d.Pb(),d.Qb(54,"ion-col",5),d.Qb(55,"ion-item"),d.Qb(56,"ion-label",6),d.wc(57,"TOTAL PREPAID HOURS"),d.Pb(),d.Mb(58,"ion-input",22),d.Pb(),d.Pb(),d.Qb(59,"ion-button",2),d.Yb("click",function(){d.pc(e);const i=t.index;return d.ac().removeWorker(i)}),d.wc(60,"delete"),d.Pb(),d.Nb(),d.Pb(),d.Pb()}if(2&e){const e=t.index,i=d.ac();d.zb(2),d.gc("formGroup",i.getFormGroupAt(e)),d.zb(6),d.gc("displayError",i.isFieldValid("n_worker",e)),d.zb(6),d.gc("displayError",i.isFieldValid("n_class_worker",e)),d.zb(6),d.gc("displayError",i.isFieldValid("reg_hours",e)),d.zb(5),d.gc("disabled",!0),d.zb(6),d.gc("displayError",i.isFieldValid("premium_hours",e)),d.zb(5),d.gc("disabled",!0),d.zb(6),d.gc("displayError",i.isFieldValid("out_hours",e)),d.zb(5),d.gc("disabled",!0),d.zb(6),d.gc("displayError",i.isFieldValid("prepaid_hours",e)),d.zb(5),d.gc("disabled",!0)}}function q(e,t){1&e&&(d.Qb(0,"ion-card-content"),d.Qb(1,"ion-col",5),d.Qb(2,"ion-label"),d.wc(3,"I don't add anything"),d.Pb(),d.Pb(),d.Pb())}let T=(()=>{class e{constructor(e){this.modalController=e,this.onChange=e=>{},this.onTouch=()=>{}}ngOnInit(){}addWorker(){const e=new o.f({n_worker:new o.c(0,[o.q.required,o.q.min(1),o.q.max(99)]),n_class_worker:new o.c("",[o.q.required]),id_class_worker:new o.c("",[o.q.required]),reg_hours:new o.c(0,[o.q.min(0),o.q.max(99)]),total_reg_hours:new o.c("",[o.q.required]),premium_hours:new o.c(0,[o.q.min(0),o.q.max(99)]),total_premium_hours:new o.c("",[]),out_hours:new o.c(0,[o.q.min(0),o.q.max(99)]),total_out_hours:new o.c("",[]),prepaid_hours:new o.c(0,[,o.q.min(0),o.q.max(99)]),total_prepaid_hours:new o.c("",[])});if(this.workers.push(e),this.workers.valid)console.log("form material");else{this.workers.at(0);for(let e=0;e<this.workers.length;e++)this.validateAllFormFields(this.workers.at(e))}this.onTouch(),this.workers.valueChanges.subscribe(e=>{this.onChange(e)})}isFieldValid(e,t){return!this.workers.at(t).get(e).valid&&this.workers.at(t).get(e).touched}validateAllFormFields(e){Object.keys(e.controls).forEach(t=>{const i=e.get(t);i instanceof o.c?i.markAsTouched({onlySelf:!0}):i instanceof o.f&&this.validateAllFormFields(i)})}removeWorker(e){this.workers.removeAt(e),this.onTouch(),this.workers.valueChanges.subscribe(e=>{this.onChange(e)})}getFormGroupAt(e){return this.workers.at(e)}selectClassWorker(e){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:g,cssClass:"my-custom-class",componentProps:{tipo:"class Worker",id:""}});return t.onDidDismiss().then(t=>{if(t.data){const i=t.data;this.workers.at(e).get("n_class_worker").setValue(i.text),this.workers.at(e).get("id_class_worker").setValue(i.id)}}),yield t.present()})}valueChange(e,t,i,a){switch(a){case"horas":this.workers.at(i).get("total_reg_hours").setValue(e*t);break;case"premium_horas":this.workers.at(i).get("total_premium_hours").setValue(e*t);break;case"out_horas":this.workers.at(i).get("total_out_hours").setValue(e*t);break;case"prepaid_horas":this.workers.at(i).get("total_prepaid_hours").setValue(e*t)}}writeValue(e){this.workers=new o.a(e.map(e=>new o.f({n_worker:new o.c(e.n_worker,[o.q.required,o.q.min(1),o.q.max(99)]),n_class_worker:new o.c(e.n_class_worker,[o.q.required]),id_class_worker:new o.c(e.id_class_worker,[o.q.required]),reg_hours:new o.c(e.reg_hours,[o.q.min(0),o.q.max(99)]),total_reg_hours:new o.c(e.total_reg_hours,[o.q.required]),premium_hours:new o.c(e.premium_hours,[o.q.min(0),o.q.max(99)]),total_premium_hours:new o.c(e.total_premium_hours,[]),out_hours:new o.c(e.out_hours,[o.q.min(0),o.q.max(99)]),total_out_hours:new o.c(e.total_out_hours,[]),prepaid_hours:new o.c(e.prepaid_hours,[,o.q.min(0),o.q.max(99)]),total_prepaid_hours:new o.c(e.total_prepaid_hours,[])}))),this.workers.valueChanges.subscribe(e=>{this.onChange(e)})}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouch=e}setDisabledState(){}validate({}){return!this.workers||this.workers.valid?null:{error:"error"}}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(r.T))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-workers"]],features:[d.yb([{provide:o.j,multi:!0,useExisting:Object(d.U)(()=>e)},{provide:o.i,multi:!0,useExisting:Object(d.U)(()=>e)}])],decls:13,vars:3,consts:[[4,"ngFor","ngForOf"],[4,"ngIf"],["expand","full",3,"click"],["expand","full",3,"disabled"],[3,"formGroup"],["size","12"],["position","stacked"],["type","number","min","0","formControlName","n_worker","value",""],["errorMsg","WORKERS is required and greater 0",3,"displayError"],["formControlName","n_class_worker","value","","readonly","",3,"click"],["errorMsg","CLASS is required",3,"displayError"],["formControlName","reg_hours","type","number","min","0","value","",3,"keyup"],["errorMsg","REG HOURS is required and greater 0",3,"displayError"],["formControlName","total_reg_hours","readonly","","value","",3,"disabled"],["formControlName","premium_hours","type","number","min","0","value","",3,"keyup"],["errorMsg","PREMIUM HOURS is required and greater 0",3,"displayError"],["formControlName","total_premium_hours","readonly","","value","",3,"disabled"],["formControlName","out_hours","type","number","min","0","value","",3,"keyup"],["errorMsg","OUT HOURS is required and greater 0",3,"displayError"],["formControlName","total_out_hours","readonly","","value","",3,"disabled"],["formControlName","prepaid_hours","type","number","min","0","value","",3,"keyup"],["errorMsg","PREPAID HOURS is required and greater 0",3,"displayError"],["formControlName","total_prepaid_hours","readonly","","value","",3,"disabled"]],template:function(e,t){1&e&&(d.Qb(0,"ion-card-header"),d.Qb(1,"ion-card-subtitle"),d.wc(2,"workers"),d.Pb(),d.Pb(),d.uc(3,z,61,11,"ion-card",0),d.Qb(4,"ion-card"),d.uc(5,q,4,0,"ion-card-content",1),d.Pb(),d.Qb(6,"ion-row"),d.Qb(7,"ion-col"),d.Qb(8,"ion-button",2),d.Yb("click",function(){return t.addWorker()}),d.wc(9,"Add Worker"),d.Pb(),d.Pb(),d.Qb(10,"ion-col"),d.Qb(11,"ion-button",3),d.wc(12,"Create Profession"),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.zb(3),d.gc("ngForOf",t.workers.controls),d.zb(2),d.gc("ngIf",0===t.workers.length),d.zb(6),d.gc("disabled",!0))},directives:[r.i,r.j,a.j,r.g,a.k,r.E,r.m,r.e,r.h,o.m,o.g,r.v,r.w,r.u,r.W,o.l,o.e,M,r.ab],styles:[""]}),e})(),D=(()=>{class e{constructor(e,t,i,a,o,n,r,s,l){this.route=e,this.router=t,this.formBuilder=i,this.serviceTicket=a,this.loadingCtrl=o,this.modalController=n,this.alertCtrl=r,this.indexDBTicket=s,this.sicronizacionDb=l,this.id_ticket=this.route.snapshot.params.id,this.store=f.a.store.precisionWall,this.builderForm(),this.EditTicket(),this.sicronizacionDb.ticketPendiente(),this.sicronizacionDb.postSyncronizacion()}builderForm(){this.edit_form_ticket=this.formBuilder.group({assignTicket:[""],empleado_id:["",[o.q.required]],general_contractor:["",[o.q.required]],proyect:["",[o.q.required]],proyect_nombre:["",[o.q.required]],proyect_address:["",[o.q.required]],date_work:["",[o.q.required]],foreman_name:["",[o.q.required]],pco:["",[o.q.required]],horario:["",[o.q.required]],descripcion:["",[o.q.required]],id_proyecto:["",[o.q.required]],superintendente_name:["",[o.q.required]],finish_date:[null,[o.q.required]],materiales:[[]],imagesInicio:[[]],imagesFinal:[[]],workers:[[]],signarute_foreman:[""],signature_superintendente:[""]})}ngOnInit(){}EditTicket(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Loading Ticket"});yield e.present(),this.serviceTicket.getOneTicket(this.id_ticket).subscribe(t=>Object(c.a)(this,void 0,void 0,function*(){console.log(t),this.edit_form_ticket.setValue({assignTicket:t.assignTicket,empleado_id:t.empleado_id,general_contractor:t.general_contractor,proyect:t.proyect,proyect_nombre:t.proyect_nombre,proyect_address:t.proyect_address,date_work:t.date_work,foreman_name:t.foreman_name,pco:t.pco,horario:t.horario,descripcion:t.descripcion,id_proyecto:t.id_proyecto,superintendente_name:t.superintendente_name,finish_date:t.finish_date,materiales:t.materiales,imagesInicio:t.imagesInicio,imagesFinal:t.imagesFinal,workers:t.workers,signarute_foreman:t.signarute_foreman,signature_superintendente:t.signature_superintendente}),yield e.dismiss()}),t=>Object(c.a)(this,void 0,void 0,function*(){const t=yield this.indexDBTicket.getOneTicket(this.id_ticket).toPromise(),i=yield this.indexDBTicket.getAllTicketMaterial(this.id_ticket).toPromise(),a=yield this.indexDBTicket.getAllTicketWorkers(this.id_ticket).toPromise(),o=yield this.indexDBTicket.getAllTicketImages(this.id_ticket).toPromise();console.log(o),console.log(t),this.edit_form_ticket.setValue({assignTicket:t.assignTicket,empleado_id:t.empleado_id,general_contractor:t.general_contractor,proyect:t.proyect,proyect_nombre:t.proyect_nombre,proyect_address:t.proyect_address,date_work:t.date_work,foreman_name:t.foreman_name,pco:t.pco,horario:t.horario,descripcion:t.descripcion,id_proyecto:t.id_proyecto,superintendente_name:t.superintendente_name,finish_date:t.finish_date,materiales:i,imagesInicio:yield this.imagesOrdenar(o,"inicio"),imagesFinal:yield this.imagesOrdenar(o,"final"),workers:a,signarute_foreman:t.signarute_foreman,signature_superintendente:t.signature_superintendente}),yield e.dismiss()}))})}getFirmaSignarute_Foreman(){return""===this.edit_form_ticket.get("signarute_foreman").value?"assets/img/signature.png":this.edit_form_ticket.get("signarute_foreman").value}getFirmaSignature_Superintendente(){return""===this.edit_form_ticket.get("signature_superintendente").value?"assets/img/signature.png":this.edit_form_ticket.get("signature_superintendente").value}imagesOrdenar(e,t){return Object(c.a)(this,void 0,void 0,function*(){let i=[];for(const a of e)a.tipo===t&&i.push(a);return i})}selectPersonalModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:g,cssClass:"my-custom-class",swipeToClose:!0,componentProps:{tipo:"staff"}});return e.onDidDismiss().then(e=>{if(e.data){const t=e.data;this.edit_form_ticket.get("empleado_id").setValue(t.id),this.edit_form_ticket.get("assignTicket").setValue(t.text)}}),yield e.present()})}selectWhereModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:g,cssClass:"my-custom-class",componentProps:{tipo:"where"}});return e.onDidDismiss().then(e=>{if(e.data){const t=e.data.text,i=this.edit_form_ticket.get("descripcion").value;this.edit_form_ticket.get("descripcion").setValue(`${i}\n${t}`)}}),yield e.present()})}selectWhatModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:g,cssClass:"my-custom-class",componentProps:{tipo:"what"}});return e.onDidDismiss().then(e=>{if(e.data){const t=e.data.text,i=this.edit_form_ticket.get("descripcion").value;this.edit_form_ticket.get("descripcion").setValue(`${i}\n${t}`)}}),yield e.present()})}selectWhyModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:g,cssClass:"my-custom-class",componentProps:{tipo:"why"}});return e.onDidDismiss().then(e=>{if(e.data){const t=e.data.text,i=this.edit_form_ticket.get("descripcion").value;this.edit_form_ticket.get("descripcion").setValue(`${i}\n${t}`)}}),yield e.present()})}isFieldValid(e){return!this.edit_form_ticket.get(e).valid&&this.edit_form_ticket.get(e).touched}displayFieldCss(e){return{"has-error":this.isFieldValid(e),"has-feedback":this.isFieldValid(e)}}validateAllFormFields(e){Object.keys(e.controls).forEach(t=>{const i=e.get(t);i instanceof o.c?i.markAsTouched({onlySelf:!0}):i instanceof o.f&&this.validateAllFormFields(i)})}FirmaSuperIntententeModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:_,cssClass:"my-custom-class",componentProps:{tipo:"edit",data:this.edit_form_ticket.get("signature_superintendente").value}});return e.onDidDismiss().then(e=>{e.data&&this.edit_form_ticket.get("signature_superintendente").setValue(e.data)}),yield e.present()})}FirmaForemanModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:_,cssClass:"my-custom-class",componentProps:{tipo:"superintendete",data:this.edit_form_ticket.get("signarute_foreman").value}});return e.onDidDismiss().then(e=>{e.data&&this.edit_form_ticket.get("signarute_foreman").setValue(e.data)}),yield e.present()})}save(){return Object(c.a)(this,void 0,void 0,function*(){if(console.log(this.edit_form_ticket.value),console.log(this.edit_form_ticket.status),this.edit_form_ticket.valid){if(console.log("form submitted"),this.edit_form_ticket.status){const e=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Loading"});yield e.present(),this.serviceTicket.updateTicket(this.edit_form_ticket.value,this.id_ticket).subscribe(t=>Object(c.a)(this,void 0,void 0,function*(){console.log(t),yield e.dismiss(),yield this.alert("Successfully modified"),this.router.navigate(["/ticket/list-Activitys"]),this.edit_form_ticket.reset()}),t=>Object(c.a)(this,void 0,void 0,function*(){yield e.dismiss(),yield this.alert("Required internet")}))}}else this.validateAllFormFields(this.edit_form_ticket),yield this.alert("Required fields")})}alert(e){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.alertCtrl.create({cssClass:"my-custom-class",header:"Alert",subHeader:e,message:"",buttons:["OK"]});yield t.present(),yield t.onDidDismiss()})}close(){this.router.navigate(["/ticket/list-Activitys"])}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(l.a),d.Lb(l.g),d.Lb(o.b),d.Lb(b.a),d.Lb(r.R),d.Lb(r.T),d.Lb(r.a),d.Lb(m.a),d.Lb(x.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-edit-ticket"]],decls:151,vars:19,consts:[[3,"translucent"],["slot","start"],["slot","end"],[3,"formGroup"],["size","12"],["position","stacked"],["formControlName","assignTicket","placeholder","select one",3,"disabled","click"],["errorMsg","Assign ticket is required",3,"displayError"],["formControlName","general_contractor","value","","readonly","",3,"disabled"],["formControlName","proyect","value","","readonly","",3,"disabled"],["formControlName","proyect_nombre","value","","readonly","",3,"disabled"],["formControlName","proyect_address","value","","readonly","",3,"disabled"],["formControlName","date_work","placeholder","From date","displayFormat","MM/DD/YYYY"],["errorMsg","date work is required",3,"displayError"],["formControlName","foreman_name","value",""],["errorMsg","foreman name is required",3,"displayError"],["formControlName","pco","value",""],["errorMsg","pco is required",3,"displayError"],["formControlName","horario","placeholder","Select One"],["value","day"],["value","night"],["value","overtime"],["value","premium time"],["errorMsg","Total hours is required",3,"displayError"],["type","text","rows","4","formControlName","descripcion","value",""],["errorMsg","Description of work is required",3,"displayError"],["expand","full",3,"click"],["formControlName","materiales"],["formControlName","workers"],["formControlName","superintendente_name","value","","placeholder","name"],["errorMsg","superintendente name of work is required",3,"displayError"],["formControlName","finish_date","placeholder","From date","displayFormat","MM/DD/YYYY"],["errorMsg","finish date is required",3,"displayError"],["formControlName","imagesInicio",3,"tipo"],["formControlName","imagesFinal",3,"tipo"],[3,"src"],["fill","outline","slot","end",3,"click"],["name","pencil-outline"],["expand","full","color","danger",3,"click"]],template:function(e,t){1&e&&(d.Qb(0,"ion-header",0),d.Qb(1,"ion-toolbar"),d.Qb(2,"ion-buttons",1),d.Mb(3,"ion-menu-button"),d.Pb(),d.Qb(4,"ion-title"),d.wc(5,"Edit ticket"),d.Pb(),d.Qb(6,"ion-buttons",2),d.Mb(7,"ion-back-button"),d.Pb(),d.Pb(),d.Pb(),d.Qb(8,"ion-content"),d.Qb(9,"ion-card"),d.Qb(10,"ion-card-content"),d.Qb(11,"form",3),d.Qb(12,"ion-grid"),d.Qb(13,"ion-row"),d.Qb(14,"ion-col",4),d.Qb(15,"ion-item"),d.Qb(16,"ion-label",5),d.wc(17,"Assign ticket to:"),d.Pb(),d.Qb(18,"ion-input",6),d.Yb("click",function(){return t.selectPersonalModal()}),d.Pb(),d.Pb(),d.Mb(19,"app-field-error-display",7),d.Pb(),d.Qb(20,"ion-card-header"),d.Qb(21,"ion-card-subtitle"),d.wc(22,"Extra Work Orden"),d.Pb(),d.Pb(),d.Qb(23,"ion-col",4),d.Qb(24,"ion-item"),d.Qb(25,"ion-label",5),d.wc(26,"General Contractor"),d.Pb(),d.Mb(27,"ion-input",8),d.Pb(),d.Pb(),d.Pb(),d.Qb(28,"ion-col",4),d.Qb(29,"ion-item"),d.Qb(30,"ion-label",5),d.wc(31,"PRECISION WALL TECH PROJECT"),d.Pb(),d.Mb(32,"ion-input",9),d.Pb(),d.Pb(),d.Qb(33,"ion-col",4),d.Qb(34,"ion-item"),d.Qb(35,"ion-label",5),d.wc(36,"Project Name"),d.Pb(),d.Mb(37,"ion-input",10),d.Pb(),d.Pb(),d.Qb(38,"ion-col",4),d.Qb(39,"ion-item"),d.Qb(40,"ion-label",5),d.wc(41,"Project Address"),d.Pb(),d.Mb(42,"ion-input",11),d.Pb(),d.Pb(),d.Qb(43,"ion-col",4),d.Qb(44,"ion-item"),d.Qb(45,"ion-label",5),d.wc(46,"Date of Work"),d.Pb(),d.Mb(47,"ion-datetime",12),d.Pb(),d.Mb(48,"app-field-error-display",13),d.Pb(),d.Qb(49,"ion-col",4),d.Qb(50,"ion-item"),d.Qb(51,"ion-label",5),d.wc(52,"Foreman Name"),d.Pb(),d.Mb(53,"ion-input",14),d.Pb(),d.Mb(54,"app-field-error-display",15),d.Pb(),d.Qb(55,"ion-col",4),d.Qb(56,"ion-item"),d.Qb(57,"ion-label",5),d.wc(58,"PCO#"),d.Pb(),d.Mb(59,"ion-input",16),d.Pb(),d.Mb(60,"app-field-error-display",17),d.Pb(),d.Qb(61,"ion-col",4),d.Qb(62,"ion-item"),d.Qb(63,"ion-label",5),d.wc(64,"Total hours before this ticket"),d.Pb(),d.Qb(65,"ion-select",18),d.Qb(66,"ion-select-option",19),d.wc(67,"Day"),d.Pb(),d.Qb(68,"ion-select-option",20),d.wc(69,"Night"),d.Pb(),d.Qb(70,"ion-select-option",21),d.wc(71,"Overtime"),d.Pb(),d.Qb(72,"ion-select-option",22),d.wc(73,"Premium Time"),d.Pb(),d.Pb(),d.Pb(),d.Mb(74,"app-field-error-display",23),d.Pb(),d.Qb(75,"ion-col",4),d.Qb(76,"ion-item"),d.Qb(77,"ion-label",5),d.wc(78,"Description of work: What? / Where? / Why?"),d.Pb(),d.Mb(79,"ion-textarea",24),d.Pb(),d.Mb(80,"app-field-error-display",25),d.Qb(81,"ion-row"),d.Qb(82,"ion-col"),d.Qb(83,"ion-button",26),d.Yb("click",function(){return t.selectWhatModal()}),d.wc(84,"what?"),d.Pb(),d.Pb(),d.Qb(85,"ion-col"),d.Qb(86,"ion-button",26),d.Yb("click",function(){return t.selectWhereModal()}),d.wc(87,"where?"),d.Pb(),d.Pb(),d.Qb(88,"ion-col"),d.Qb(89,"ion-button",26),d.Yb("click",function(){return t.selectWhyModal()}),d.wc(90,"why?"),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Mb(91,"app-material",27),d.Mb(92,"app-workers",28),d.Qb(93,"ion-card-header"),d.Qb(94,"ion-card-subtitle"),d.wc(95,"Signer verifies PWT, has completed the work stated above under my supervision. Time and material listed above are accurate and approved"),d.Pb(),d.Pb(),d.Qb(96,"ion-row"),d.Qb(97,"ion-col",4),d.Qb(98,"ion-item"),d.Qb(99,"ion-label",5),d.wc(100,"Superintendent's Name:"),d.Pb(),d.Mb(101,"ion-input",29),d.Pb(),d.Mb(102,"app-field-error-display",30),d.Pb(),d.Qb(103,"ion-col",4),d.Qb(104,"ion-item"),d.Qb(105,"ion-label",5),d.wc(106,"Finish Date"),d.Pb(),d.Mb(107,"ion-datetime",31),d.Pb(),d.Mb(108,"app-field-error-display",32),d.Pb(),d.Pb(),d.Qb(109,"ion-card-header"),d.Qb(110,"ion-card-subtitle"),d.wc(111,"Pictures taken"),d.Pb(),d.Pb(),d.Qb(112,"ion-item"),d.Qb(113,"ion-label",5),d.wc(114,"Previous Images"),d.Pb(),d.Pb(),d.Qb(115,"ion-col",4),d.Mb(116,"app-images",33),d.Pb(),d.Qb(117,"ion-item"),d.Qb(118,"ion-label",5),d.wc(119,"Final Images"),d.Pb(),d.Pb(),d.Qb(120,"ion-col",4),d.Mb(121,"app-images",34),d.Pb(),d.Qb(122,"ion-col",4),d.Qb(123,"ion-row"),d.Qb(124,"ion-col"),d.Qb(125,"ion-card"),d.Qb(126,"ion-card-header"),d.Qb(127,"ion-card-subtitle"),d.wc(128,"Superintendent's Signature"),d.Pb(),d.Pb(),d.Mb(129,"ion-img",35),d.Qb(130,"ion-item"),d.Qb(131,"ion-button",36),d.Yb("click",function(){return t.FirmaSuperIntententeModal()}),d.Mb(132,"ion-icon",37),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(133,"ion-col"),d.Qb(134,"ion-card"),d.Qb(135,"ion-card-header"),d.Qb(136,"ion-card-subtitle"),d.wc(137,"Foreman Signature"),d.Pb(),d.Pb(),d.Mb(138,"ion-img",35),d.Qb(139,"ion-item"),d.Qb(140,"ion-button",36),d.Yb("click",function(){return t.FirmaForemanModal()}),d.Mb(141,"ion-icon",37),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(142,"ion-footer"),d.Qb(143,"ion-grid"),d.Qb(144,"ion-row"),d.Qb(145,"ion-col"),d.Qb(146,"ion-button",26),d.Yb("click",function(){return t.save()}),d.wc(147,"Save"),d.Pb(),d.Pb(),d.Qb(148,"ion-col"),d.Qb(149,"ion-button",38),d.Yb("click",function(){return t.close()}),d.wc(150,"Close"),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.gc("translucent",!0),d.zb(11),d.gc("formGroup",t.edit_form_ticket),d.zb(7),d.gc("disabled",!0),d.zb(1),d.gc("displayError",t.isFieldValid("assignTicket")),d.zb(8),d.gc("disabled",!0),d.zb(5),d.gc("disabled",!0),d.zb(5),d.gc("disabled",!0),d.zb(5),d.gc("disabled",!0),d.zb(6),d.gc("displayError",t.isFieldValid("date_work")),d.zb(6),d.gc("displayError",t.isFieldValid("foreman_name")),d.zb(6),d.gc("displayError",t.isFieldValid("pco")),d.zb(14),d.gc("displayError",t.isFieldValid("horario")),d.zb(6),d.gc("displayError",t.isFieldValid("descripcion")),d.zb(22),d.gc("displayError",t.isFieldValid("superintendente_name")),d.zb(6),d.gc("displayError",t.isFieldValid("finish_date")),d.zb(8),d.gc("tipo","Previous"),d.zb(5),d.gc("tipo","Final"),d.zb(8),d.gc("src",t.getFirmaSignature_Superintendente()),d.zb(9),d.gc("src",t.getFirmaSignarute_Foreman()))},directives:[r.r,r.O,r.f,r.A,r.N,r.c,r.d,r.n,r.g,r.h,o.r,o.m,o.g,r.q,r.E,r.m,r.v,r.w,r.u,r.ab,o.l,o.e,M,r.i,r.j,r.o,r.Z,r.G,r.H,r.L,r.e,F,T,h,r.t,r.s,r.p],styles:[""]}),e})();var E=i("VRyK"),S=i("xgIS"),A=i("HDdC"),L=i("lJxs"),j=i("ahca"),I=i("wd/R");const N=function(e){return["/ticket/list-tickets",e]},V=function(e,t,i,a,o,n,r){return{proyect:e,nameForeman:t,id_proyecto:i,nameProyecto:a,codigo:o,dirrecion:n,generalContractor:r}};function W(e,t){if(1&e&&(d.Qb(0,"ion-grid"),d.Qb(1,"ion-row"),d.Qb(2,"ion-col"),d.Qb(3,"small"),d.wc(4,"list tickets"),d.Pb(),d.Mb(5,"br"),d.Qb(6,"ion-button",19),d.wc(7," View tickets \xa0 "),d.Mb(8,"ion-icon",20),d.Pb(),d.Pb(),d.Qb(9,"ion-col"),d.Qb(10,"small"),d.wc(11,"Foreman"),d.Pb(),d.Mb(12,"br"),d.wc(13),d.Pb(),d.Qb(14,"ion-col"),d.Qb(15,"small"),d.wc(16,"Lead"),d.Pb(),d.Mb(17,"br"),d.wc(18),d.Pb(),d.Pb(),d.Pb()),2&e){const e=t.row;d.zb(6),d.gc("routerLink",d.jc(4,N,e.Actividad_ID))("queryParams",d.lc(6,V,e.Nombre,e.Foreman,e.Pro_ID,e.Nombre,e.Codigo,e.dirrecion,e.empresa)),d.zb(7),d.yc(" ",e.Foreman," "),d.zb(5),d.yc(" ",e.Lead," ")}}function Y(e,t){if(1&e){const e=d.Rb();d.Qb(0,"a",21),d.Yb("click",function(){d.pc(e);const i=t.row;return d.ac().toggleExpandRow(i)}),d.Pb()}if(2&e){const e=t.expanded;d.Db("datatable-icon-right",!e)("datatable-icon-down",e)}}function R(e,t){1&e&&d.Mb(0,"i",22),2&e&&d.gc("innerHTML",t.row.Fecha,d.qc)}function H(e,t){1&e&&d.Mb(0,"i",22),2&e&&d.gc("innerHTML",t.row.empresa,d.qc)}function U(e,t){1&e&&d.Mb(0,"i",22),2&e&&d.gc("innerHTML",t.row.Nombre,d.qc)}function B(e,t){1&e&&d.Mb(0,"i",22),2&e&&d.gc("innerHTML",t.row.dirrecion,d.qc)}function $(e,t){1&e&&d.Mb(0,"i",22),2&e&&d.gc("innerHTML",t.row.Coordinador_Obra,d.qc)}let G=(()=>{class e{constructor(e,t,i,a,r){this.ticketService=e,this.loadingCtrl=t,this.alertCtrl=i,this.dbPwaService=a,this.toastController=r,this.columns=[{prop:"Fecha",name:"Date"},{prop:"empresa",name:"Company"},{prop:"Nombre",name:"Name"},{prop:"dirrecion",name:"Dirrecion"},{prop:"Coordinador_Obra",name:"Coordinador_Obra"},{prop:"Foreman",name:"Foreman"},{prop:"Lead",name:"Lead"},{prop:"Pwtsuper",name:"Pwt super"},{prop:"empleados",name:"empleados"}],this.expanded={},this.loadingIndicator=!0,this.alerta=!1,this.scrollBarHorizontal=window.innerWidth<1200,this.ColumnMode=n.a,window.onresize=()=>{this.scrollBarHorizontal=window.innerWidth<1200};const s=I().format("YYYY-MM-DD");this.fecha=new o.c(s),this.fecha.valueChanges.subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){}))}ngOnInit(){return Object(c.a)(this,void 0,void 0,function*(){this.datatable()})}getDBListActivities(e){e=I(e).format("YYYY-MM-DD"),this.dbPwaService.getallActividades(e).subscribe(e=>{console.log(e),this.rows=e,this.temp=e,this.alerta=!0,this.loadingIndicator=!1})}buscar(){return Object(c.a)(this,void 0,void 0,function*(){this.loadingIndicator=!0,yield this.datatable()})}onPage(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{},1e3)}toggleExpandRow(e){this.table.rowDetail.toggleExpandRow(e)}onDetailToggle(e){}datatable(){return Object(c.a)(this,void 0,void 0,function*(){this.ticketService.getDataTableListActivitis(this.fecha.value).subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){e&&(this.rows=e,this.temp=e,this.alerta=!0,this.loadingIndicator=!1)}),e=>Object(c.a)(this,void 0,void 0,function*(){this.getDBListActivities(this.fecha.value)}))})}alert(e){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.alertCtrl.create({cssClass:"my-custom-class",header:"Alert",subHeader:"no hay coneccion a internet",message:"db local activado",buttons:["OK"]});yield e.present(),yield e.onDidDismiss()})}presentToast(e){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.toastController.create({color:"success",message:e,duration:3e3});t.present(),yield t.onDidDismiss()})}updateFilter(e){const t=e.target.value.toLowerCase(),i=this.temp.filter(({empresa:e,Coordinador_Obra:i,Nombre:a})=>e.toLowerCase().indexOf(t.toLowerCase())>-1||i.toLowerCase().indexOf(t.toLowerCase())>-1||a.toLowerCase().indexOf(t.toLowerCase())>-1);this.rows=i,this.table.offset=3}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(b.a),d.Lb(r.R),d.Lb(r.a),d.Lb(m.a),d.Lb(r.bb))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-datatable-list-activity"]],viewQuery:function(e,t){if(1&e&&d.Bc(n.d,1),2&e){let e;d.mc(e=d.Zb())&&(t.table=e.first)}},decls:30,vars:19,consts:[["size","9"],["displayFormat","DDDD MMM DD, YYYY",3,"formControl"],["size","3",1,"ion-align-self-center"],["expand","full",3,"click"],["name","search"],["position","floating"],["type","text",3,"keyup"],["rowHeight","auto",1,"material","expandable",3,"loadingIndicator","rows","limit","columnMode","headerHeight","footerHeight","scrollbarH","page"],["table",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","Date",3,"width"],["name","Company",3,"width"],["name","Name",3,"width"],["name","Dirrection",3,"width"],["name","Contact",3,"width"],["size","small",3,"routerLink","queryParams"],["name","list-circle-outline"],["title","Expand/Collapse Row",3,"click"],[3,"innerHTML"]],template:function(e,t){1&e&&(d.Qb(0,"ion-row"),d.Qb(1,"ion-col",0),d.Qb(2,"ion-item"),d.Mb(3,"ion-datetime",1),d.Pb(),d.Pb(),d.Qb(4,"ion-col",2),d.Qb(5,"ion-button",3),d.Yb("click",function(){return t.buscar()}),d.Mb(6,"ion-icon",4),d.Pb(),d.Pb(),d.Pb(),d.Mb(7,"hr"),d.Qb(8,"ion-item"),d.Qb(9,"ion-label",5),d.wc(10,"Search"),d.Pb(),d.Qb(11,"ion-input",6),d.Yb("keyup",function(e){return t.updateFilter(e)}),d.Pb(),d.Pb(),d.Mb(12,"br"),d.Qb(13,"ngx-datatable",7,8),d.Yb("page",function(e){return t.onPage(e)}),d.Qb(15,"ngx-datatable-row-detail",9,10),d.Yb("toggle",function(e){return t.onDetailToggle(e)}),d.uc(17,W,19,14,"ng-template",11),d.Pb(),d.Qb(18,"ngx-datatable-column",12),d.uc(19,Y,1,4,"ng-template",13),d.Pb(),d.Qb(20,"ngx-datatable-column",14),d.uc(21,R,1,1,"ng-template",13),d.Pb(),d.Qb(22,"ngx-datatable-column",15),d.uc(23,H,1,1,"ng-template",13),d.Pb(),d.Qb(24,"ngx-datatable-column",16),d.uc(25,U,1,1,"ng-template",13),d.Pb(),d.Qb(26,"ngx-datatable-column",17),d.uc(27,B,1,1,"ng-template",13),d.Pb(),d.Qb(28,"ngx-datatable-column",18),d.uc(29,$,1,1,"ng-template",13),d.Pb(),d.Pb()),2&e&&(d.zb(3),d.gc("formControl",t.fecha),d.zb(10),d.gc("loadingIndicator",t.loadingIndicator)("rows",t.rows)("limit",15)("columnMode",t.ColumnMode.force)("headerHeight",50)("footerHeight",50)("scrollbarH",t.scrollBarHorizontal),d.zb(2),d.gc("rowHeight",95),d.zb(3),d.gc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),d.zb(2),d.gc("width",100),d.zb(2),d.gc("width",150),d.zb(2),d.gc("width",200),d.zb(2),d.gc("width",200),d.zb(2),d.gc("width",200))},directives:[r.E,r.m,r.v,r.o,r.Z,o.l,o.d,r.e,r.s,r.w,r.u,r.ab,n.d,n.e,n.f,n.c,n.b,r.q,r.Y,l.h],styles:["_index.scss[_ngcontent-%COMP%]   _material.scss[_ngcontent-%COMP%]   _bootstrap.scss[_ngcontent-%COMP%]   .datatable-row-detail[_ngcontent-%COMP%]{width:720px!important}"]}),e})();function J(e,t){if(1&e&&(d.Qb(0,"ion-buttons",4),d.Qb(1,"ion-button",5),d.wc(2),d.Mb(3,"ion-spinner",6),d.Pb(),d.Pb()),2&e){const e=d.ac();d.zb(2),d.yc(" ",e.sincronizar.message," ")}}let Z=(()=>{class e{constructor(e,t,i,a,o,n,r,s,l){this.ticketService=e,this.menuCrtl=t,this.dbPwaService=i,this.alertCtrl=a,this.toastController=o,this.loadingCtrl=n,this.indexdDb=r,this.syncIndexdDb=s,this.sicronizacionDb=l,this.sincronizar={status:!1,message:"Synchronize"},this.sicronizacionDb.verificarConection(),this.sicronizacionDb.postSyncronizacion()}ngOnInit(){return Object(c.a)(this,void 0,void 0,function*(){})}syncronizacion(){return Object(c.a)(this,void 0,void 0,function*(){if(this.isConnected=!0){let t;yield this.indexdDb.countRegister().toPromise().then(e=>{t=e}).catch(e=>t=e);try{if("version 1"===t.codigo)this.syncIndexdDb.postSyncronizacion();else{const e=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Loading Database"});yield e.present(),this.indexdDb.getDbApp().subscribe(t=>Object(c.a)(this,void 0,void 0,function*(){yield this.indexdDb.loadDatabase(t),yield e.dismiss()}),e=>Object(c.a)(this,void 0,void 0,function*(){}))}}catch(e){const t=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Loading Database"});yield t.present(),this.indexdDb.getDbApp().subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){yield this.indexdDb.loadDatabase(e),yield t.dismiss()}),e=>Object(c.a)(this,void 0,void 0,function*(){}))}}})}createOnline$(){return Object(E.a)(Object(S.a)(window,"offline").pipe(Object(L.a)(()=>!1)),Object(S.a)(window,"online").pipe(Object(L.a)(()=>!0)),new A.a(e=>{e.next(navigator.onLine),e.complete()}))}alert(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.alertCtrl.create({cssClass:"my-custom-class",header:"Alert",subHeader:"no hay coneccion a internet",message:"db local activado",buttons:["OK"]});yield e.present(),yield e.onDidDismiss()})}presentToast(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.toastController.create({header:"Synchronization",message:this.sincronizar.message,position:"bottom",buttons:[{side:"start",icon:"sync-outline"}],duration:9e3});yield e.present();const{role:t}=yield e.onDidDismiss();console.log("onDidDismiss resolved with role",t)})}alertToast(e,t){return Object(c.a)(this,void 0,void 0,function*(){const i=yield this.toastController.create({color:"dark",message:e,duration:t});i.present(),yield i.onDidDismiss()})}ionViewWillEnter(){this.menuCrtl.enable(!0)}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(b.a),d.Lb(r.S),d.Lb(m.a),d.Lb(r.a),d.Lb(r.bb),d.Lb(r.R),d.Lb(j.a),d.Lb(x.a),d.Lb(x.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-list-activity"]],decls:14,vars:2,consts:[[3,"translucent"],["slot","start"],["slot","primary",4,"ngIf"],["color","black"],["slot","primary"],["fill","solid","color","secondary"],["icon","circular","slot","end"]],template:function(e,t){1&e&&(d.Qb(0,"ion-header",0),d.Qb(1,"ion-toolbar"),d.Qb(2,"ion-buttons",1),d.Mb(3,"ion-menu-button"),d.Pb(),d.Qb(4,"ion-title"),d.wc(5,"Ticket - activities list"),d.Pb(),d.uc(6,J,4,1,"ion-buttons",2),d.Pb(),d.Pb(),d.Qb(7,"ion-content"),d.Qb(8,"ion-grid"),d.Qb(9,"ion-row"),d.Qb(10,"ion-col"),d.Qb(11,"ion-label",3),d.wc(12,"Activities list"),d.Pb(),d.Mb(13,"app-datatable-list-activity"),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.gc("translucent",!0),d.zb(6),d.gc("ngIf",t.sincronizar.status))},directives:[r.r,r.O,r.f,r.A,r.N,a.k,r.n,r.q,r.E,r.m,r.w,G,r.e,r.J],styles:["ion-spinner[_ngcontent-%COMP%]{width:1em;height:1em}"]}),e})();function K(e,t){if(1&e){const e=d.Rb();d.Qb(0,"ion-col"),d.Qb(1,"ion-chip"),d.Qb(2,"ion-label"),d.wc(3),d.Pb(),d.Qb(4,"ion-icon",15),d.Yb("click",function(){d.pc(e);const i=t.index;return d.ac().deleteMail(i,"to")}),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit;d.zb(3),d.xc(e)}}function X(e,t){if(1&e){const e=d.Rb();d.Qb(0,"ion-col"),d.Qb(1,"ion-chip"),d.Qb(2,"ion-label"),d.wc(3),d.Pb(),d.Qb(4,"ion-icon",15),d.Yb("click",function(){d.pc(e);const i=t.index;return d.ac().deleteMail(i,"cc")}),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit;d.zb(3),d.xc(e)}}let ee=(()=>{class e{constructor(e,t,i,a,n,r){this.serviceTicket=e,this.modalController=t,this.formBuilder=i,this.indexDBTicket=a,this.loadingCtrl=n,this.toastController=r,this.cc_mail=[],this.to_mail=[],this.mail=this.formBuilder.group({to:["",[o.q.pattern(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)]],cc:["",[o.q.pattern(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)]],title_mail:["",[o.q.required]],body_mail:["",[o.q.required]]}),this.observerCampos(),this.mail.get("to").markAsTouched(),this.mail.get("cc").markAsTouched()}observerCampos(){this.mail.get("to").valueChanges.subscribe(e=>{e.indexOf(" ")>=0&&(this.to_mail.push(e),this.mail.get("to").setValue(""))}),this.mail.get("cc").valueChanges.subscribe(e=>{e.indexOf(" ")>=0&&(this.cc_mail.push(e),this.mail.get("cc").setValue(""))})}ngOnInit(){this.serviceTicket.getMail(this.id_project).subscribe(e=>{this.cc_mail.push(e.emails.Pwtsuper_mail),this.to_mail.push(e.emails.Foreman_mail),console.log(e.emails.Pwtsuper_mail),this.mail.get("title_mail").setValue(`${e.config.title_ticket_email} ${this.name_project} Ticket #${this.num_ticket}`),this.mail.get("body_mail").setValue(e.config.body_ticket_email)},e=>Object(c.a)(this,void 0,void 0,function*(){const e=yield this.indexDBTicket.getAllMailProyect(this.id_project).toPromise();yield this.indexDBTicket.getAllMailContact(this.id_project).toPromise(),console.log(e),yield Promise.all([e.map(e=>{this.cc_mail.push(e.Pwtsuper_mail),this.to_mail.push(e.Foreman_mail)})]),this.mail.get("title_mail").setValue(`Job: ${this.name_project} Ticket #${this.num_ticket}`),this.mail.get("body_mail").setValue("Please find attached ticket for the project mention above ")}))}validarVacios(e){return""!==e}close(){this.modalController.dismiss({dismissed:!0})}save(){return Object(c.a)(this,void 0,void 0,function*(){const e={cc:this.cc_mail,to:this.to_mail,title_m:this.mail.get("title_mail").value,body_m:this.mail.get("body_mail").value};console.log(e),console.log(this.mail.status),this.serviceTicket.sendMail(this.id_ticket,e).subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){console.log(e)}),e=>Object(c.a)(this,void 0,void 0,function*(){yield this.alertToast("Error! mail not sent",3e3)}));const t=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Send Mail",duration:1500});yield t.present(),this.modalController.dismiss({dismissed:!0})})}isFieldValid(e){return!this.mail.get(e).valid&&this.mail.get(e).touched}displayFieldCss(e){return{"has-error":this.isFieldValid(e),"has-feedback":this.isFieldValid(e)}}validateAllFormFields(e){Object.keys(e.controls).forEach(t=>{const i=e.get(t);i instanceof o.c?i.markAsTouched({onlySelf:!0}):i instanceof o.f&&this.validateAllFormFields(i)})}deleteMail(e,t){"cc"==t?this.cc_mail.splice(e,1):this.to_mail.splice(e,1)}alertToast(e,t){return Object(c.a)(this,void 0,void 0,function*(){const i=yield this.toastController.create({color:"dark",message:e,duration:t});i.present(),yield i.onDidDismiss()})}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(b.a),d.Lb(r.T),d.Lb(o.b),d.Lb(m.a),d.Lb(r.R),d.Lb(r.bb))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-mail"]],inputs:{id_project:"id_project",name_project:"name_project",num_ticket:"num_ticket",id_ticket:"id_ticket"},decls:47,vars:7,consts:[["slot","end","color","light",3,"click"],["slot","icon-only","name","close"],["padding",""],[3,"formGroup"],["size","12"],["position","stacked"],["formControlName","to","autocomplete","off"],["errorMsg","invalid email",3,"displayError"],[4,"ngFor","ngForOf"],["formControlName","cc","autocomplete","off"],["formControlName","title_mail","autocomplete","disabled"],["errorMsg","Mail Title is required",3,"displayError"],["formControlName","body_mail","autocomplete","disabled"],["errorMsg","Mail Body is required",3,"displayError"],["expand","full",3,"click"],["name","close-circle",3,"click"]],template:function(e,t){1&e&&(d.Qb(0,"ion-header"),d.Qb(1,"ion-toolbar"),d.Qb(2,"ion-title"),d.wc(3,"Send tickets to emails "),d.Pb(),d.Qb(4,"ion-button",0),d.Yb("click",function(){return t.close()}),d.Mb(5,"ion-icon",1),d.Pb(),d.Pb(),d.Pb(),d.Qb(6,"ion-content",2),d.Qb(7,"form",3),d.Qb(8,"ion-grid"),d.Qb(9,"ion-row"),d.Qb(10,"ion-col",4),d.Qb(11,"ion-item"),d.Qb(12,"ion-label",5),d.wc(13,"TO:"),d.Pb(),d.Mb(14,"ion-input",6),d.Pb(),d.Mb(15,"app-field-error-display",7),d.Pb(),d.Qb(16,"ion-col",4),d.uc(17,K,5,1,"ion-col",8),d.Pb(),d.Qb(18,"ion-col",4),d.Qb(19,"ion-item"),d.Qb(20,"ion-label",5),d.wc(21,"CC:"),d.Pb(),d.Mb(22,"ion-input",9),d.Pb(),d.Mb(23,"app-field-error-display",7),d.Pb(),d.Qb(24,"ion-col",4),d.uc(25,X,5,1,"ion-col",8),d.Pb(),d.Qb(26,"ion-col",4),d.Qb(27,"ion-item"),d.Qb(28,"ion-label",5),d.wc(29,"Mail Title:"),d.Pb(),d.Mb(30,"ion-input",10),d.Pb(),d.Mb(31,"app-field-error-display",11),d.Pb(),d.Qb(32,"ion-col",4),d.Qb(33,"ion-item"),d.Qb(34,"ion-label",5),d.wc(35,"Mail Body:"),d.Pb(),d.Mb(36,"ion-input",12),d.Pb(),d.Mb(37,"app-field-error-display",13),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(38,"ion-footer"),d.Qb(39,"ion-grid"),d.Qb(40,"ion-row"),d.Qb(41,"ion-col"),d.Qb(42,"ion-button",14),d.Yb("click",function(){return t.save()}),d.wc(43,"Send Mail"),d.Pb(),d.Pb(),d.Qb(44,"ion-col"),d.Qb(45,"ion-button",14),d.Yb("click",function(){return t.close()}),d.wc(46,"Close"),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.zb(7),d.gc("formGroup",t.mail),d.zb(8),d.gc("displayError",t.isFieldValid("to")),d.zb(2),d.gc("ngForOf",t.to_mail),d.zb(6),d.gc("displayError",t.isFieldValid("cc")),d.zb(2),d.gc("ngForOf",t.cc_mail),d.zb(6),d.gc("displayError",t.isFieldValid("title_mail")),d.zb(6),d.gc("displayError",t.isFieldValid("body_mail")))},directives:[r.r,r.O,r.N,r.e,r.s,r.n,o.r,o.m,o.g,r.q,r.E,r.m,r.v,r.w,r.u,r.ab,o.l,o.e,M,a.j,r.p,r.l],styles:[""]}),e})();function te(e,t){if(1&e&&(d.Qb(0,"ion-card",8),d.Mb(1,"ion-img",9),d.Pb()),2&e){const e=t.$implicit;d.zb(1),d.gc("src",e)}}function ie(e,t){if(1&e&&(d.Qb(0,"ion-grid"),d.Qb(1,"ion-row"),d.Qb(2,"ion-col",6),d.uc(3,te,2,1,"ion-card",7),d.Pb(),d.Pb(),d.Pb()),2&e){const e=d.ac();d.zb(3),d.gc("ngForOf",e.images)}}function ae(e,t){1&e&&(d.Qb(0,"ion-card",8),d.Mb(1,"ion-img",9),d.Pb()),2&e&&(d.zb(1),d.gc("src","assets/img/Internet-Access-Error.jpg"))}let oe=(()=>{class e{constructor(e,t,i){this.serviceTicket=e,this.modalController=t,this.alertCtrl=i,this.acessInternet=!0}ngOnInit(){this.serviceTicket.getImage(this.id_ticket,this.type).subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){this.images=e.initialPreview}),()=>Object(c.a)(this,void 0,void 0,function*(){this.acessInternet=!1}))}close(){this.modalController.dismiss({dismissed:!0})}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(b.a),d.Lb(r.T),d.Lb(r.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-preview-images"]],inputs:{id_ticket:"id_ticket",type:"type"},decls:16,vars:3,consts:[["slot","end","color","light",3,"click"],["slot","icon-only","name","close"],["padding",""],[4,"ngIf","ngIfElse"],["NoacessInternet",""],["expand","full",3,"click"],["size","6"],["class","block",4,"ngFor","ngForOf"],[1,"block"],[3,"src"]],template:function(e,t){if(1&e&&(d.Qb(0,"ion-header"),d.Qb(1,"ion-toolbar"),d.Qb(2,"ion-title"),d.wc(3),d.Pb(),d.Qb(4,"ion-button",0),d.Yb("click",function(){return t.close()}),d.Mb(5,"ion-icon",1),d.Pb(),d.Pb(),d.Pb(),d.Qb(6,"ion-content",2),d.uc(7,ie,4,1,"ion-grid",3),d.uc(8,ae,2,1,"ng-template",null,4,d.vc),d.Pb(),d.Qb(10,"ion-footer"),d.Qb(11,"ion-grid"),d.Qb(12,"ion-row"),d.Qb(13,"ion-col"),d.Qb(14,"ion-button",5),d.Yb("click",function(){return t.close()}),d.wc(15,"Close"),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&e){const e=d.nc(9);d.zb(3),d.yc("Preview imagen ",t.type,""),d.zb(4),d.gc("ngIf",t.acessInternet)("ngIfElse",e)}},directives:[r.r,r.O,r.N,r.e,r.s,r.n,a.k,r.p,r.q,r.E,r.m,a.j,r.g,r.t],styles:[""]}),e})();function ne(e,t){1&e&&(d.Qb(0,"ion-chip",28),d.Qb(1,"ion-label",28),d.wc(2,"no"),d.Pb(),d.Pb())}function re(e,t){1&e&&(d.Qb(0,"ion-chip",29),d.Qb(1,"ion-label",29),d.wc(2,"si"),d.Pb(),d.Pb())}function se(e,t){1&e&&(d.Qb(0,"ion-chip",28),d.Qb(1,"ion-label",28),d.wc(2,"no"),d.Pb(),d.Pb())}function le(e,t){1&e&&(d.Qb(0,"ion-chip",29),d.Qb(1,"ion-label",29),d.wc(2,"si"),d.Pb(),d.Pb())}const ce=function(e){return["/ticket/edit",e]};function de(e,t){if(1&e){const e=d.Rb();d.Qb(0,"ion-grid"),d.Qb(1,"ion-row"),d.Qb(2,"ion-col"),d.Qb(3,"small"),d.wc(4,"Actions"),d.Pb(),d.Mb(5,"br"),d.Qb(6,"ion-button",19),d.wc(7," Edit \xa0 "),d.Mb(8,"ion-icon",20),d.Pb(),d.Pb(),d.Qb(9,"ion-col"),d.Mb(10,"small"),d.Mb(11,"br"),d.Qb(12,"ion-button",21),d.Yb("click",function(){d.pc(e);const i=t.row;return d.ac().delete(i.ticket_id)}),d.wc(13," Delete \xa0 "),d.Mb(14,"ion-icon",22),d.Pb(),d.Pb(),d.Qb(15,"ion-col"),d.Mb(16,"small"),d.Mb(17,"br"),d.Qb(18,"ion-button",21),d.Yb("click",function(){d.pc(e);const i=t.row;return d.ac().mail(i.Num,i.ticket_id)}),d.wc(19," Send Mail \xa0 "),d.Mb(20,"ion-icon",23),d.Pb(),d.Pb(),d.Qb(21,"ion-col"),d.Qb(22,"small"),d.wc(23,"Foreman's signature"),d.Pb(),d.Mb(24,"br"),d.uc(25,ne,3,0,"ion-chip",24),d.uc(26,re,3,0,"ng-template",null,25,d.vc),d.Pb(),d.Qb(28,"ion-col"),d.Qb(29,"small"),d.wc(30,"client's signature"),d.Pb(),d.Mb(31,"br"),d.uc(32,se,3,0,"ion-chip",24),d.uc(33,le,3,0,"ng-template",null,26,d.vc),d.Pb(),d.Qb(35,"ion-col"),d.Qb(36,"small"),d.wc(37,"Startup images"),d.Pb(),d.Mb(38,"br"),d.Qb(39,"ion-button",21),d.Yb("click",function(){d.pc(e);const i=t.row;return d.ac().imageStart(i.ticket_id,"inicio")}),d.wc(40," View \xa0 "),d.Mb(41,"ion-icon",27),d.Pb(),d.Pb(),d.Qb(42,"ion-col"),d.Qb(43,"small"),d.wc(44,"Final images"),d.Pb(),d.Mb(45,"br"),d.Qb(46,"ion-button",21),d.Yb("click",function(){d.pc(e);const i=t.row;return d.ac().imageEnd(i.ticket_id,"final")}),d.wc(47," View \xa0 "),d.Mb(48,"ion-icon",27),d.Pb(),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=t.row,i=d.nc(27),a=d.nc(34);d.zb(6),d.gc("routerLink",d.jc(5,ce,e.ticket_id)),d.zb(19),d.gc("ngIf",""===e.signarute_foreman)("ngIfElse",i),d.zb(7),d.gc("ngIf",""===e.signature_superintendente)("ngIfElse",a)}}function be(e,t){if(1&e){const e=d.Rb();d.Qb(0,"a",30),d.Yb("click",function(){d.pc(e);const i=t.row;return d.ac().toggleExpandRow(i)}),d.Pb()}if(2&e){const e=t.expanded;d.Db("datatable-icon-right",!e)("datatable-icon-down",e)}}function ue(e,t){1&e&&d.Mb(0,"i",31),2&e&&d.gc("innerHTML",t.row.proyect,d.qc)}function he(e,t){1&e&&d.Mb(0,"i",31),2&e&&d.gc("innerHTML",t.row.proyect_nombre,d.qc)}function me(e,t){1&e&&d.Mb(0,"i",31),2&e&&d.gc("innerHTML",t.row.Num,d.qc)}function pe(e,t){1&e&&d.Mb(0,"i",31),2&e&&d.gc("innerHTML",t.row.pco,d.qc)}function ge(e,t){1&e&&d.Mb(0,"i",31),2&e&&d.gc("innerHTML",t.row.date_work,d.qc)}function fe(e,t){1&e&&d.Mb(0,"i",31),2&e&&d.gc("innerHTML",t.row.horario,d.qc)}function we(e,t){1&e&&d.Mb(0,"i",31),2&e&&d.gc("innerHTML",t.row.assignTicket,d.qc)}const ve=function(){return["/ticket/new"]},ye=function(e,t,i,a,o,n,r){return{nameProyecto:e,dirrecion:t,nameForeman:i,id_actividad:a,id_proyecto:o,generalContractor:n,codigo:r}};let Pe=(()=>{class e{constructor(e,t,i,a,o){this.ticketService=e,this.route=t,this.dbPwaService=i,this.alertCtrl=a,this.modalController=o,this.expanded={},this.loadingIndicator=!0,this.columns=[{prop:"proyect",name:"Cod Proyect"},{prop:"proyect_nombre",name:"Name Proyect"},{prop:"Num",name:"Num"},{prop:"pco",name:"PCO#"},{prop:"date_work",name:"Date Ticket"},{prop:"horario",name:"Schelude"},{prop:"assignTicket",name:"User"}],this.ColumnMode=n.a,this.scrollBarHorizontal=window.innerWidth<1200,window.onresize=()=>{this.scrollBarHorizontal=window.innerWidth<1200},this.param_id=parseInt(this.route.snapshot.paramMap.get("id")),this.proyect=this.route.snapshot.queryParams.proyect,this.nameForeman=this.route.snapshot.queryParams.nameForeman,this.id_proyecto=this.route.snapshot.queryParams.id_proyecto,this.generalContractor=this.route.snapshot.queryParams.generalContractor,this.codigo=this.route.snapshot.queryParams.codigo,this.nameProyecto=this.route.snapshot.queryParams.nameProyecto,this.dirrecion=this.route.snapshot.queryParams.dirrecion}ngOnInit(){this.datatable()}datatable(){return Object(c.a)(this,void 0,void 0,function*(){this.ticketService.getDataTableListTicket(this.param_id).subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){e&&(this.rows=e,this.temp=e,this.loadingIndicator=!1)}),e=>Object(c.a)(this,void 0,void 0,function*(){this.dbPwaService.getallTicketById(this.param_id).subscribe(e=>{e&&(console.log(e),this.rows=e,this.temp=e,this.loadingIndicator=!1,console.log(this.rows))})}))})}onPage(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{},1e3)}toggleExpandRow(e){this.table.rowDetail.toggleExpandRow(e)}onDetailToggle(e){}updateFilter(e){const t=e.target.value.toLowerCase(),i=this.temp.filter(({proyect:e,proyect_nombre:i})=>e.toLowerCase().indexOf(t.toLowerCase())>-1||i.toLowerCase().indexOf(t.toLowerCase())>-1);this.rows=i,this.table.offset=3}alert(e){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.alertCtrl.create({cssClass:"my-custom-class",header:"Confirm!",message:"Are you sure to delete?",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Ok",handler:()=>{this.ticketService.deleteTicket(e).subscribe(e=>Object(c.a)(this,void 0,void 0,function*(){this.datatable()}))}}]});yield t.present(),yield t.onDidDismiss()})}delete(e){this.alert(e)}mail(e,t){return Object(c.a)(this,void 0,void 0,function*(){const i=yield this.modalController.create({component:ee,componentProps:{id_project:this.id_proyecto,name_project:this.nameProyecto,num_ticket:e,id_ticket:t},cssClass:"my-custom-class"});return yield i.present()})}imageStart(e,t){return Object(c.a)(this,void 0,void 0,function*(){const i=yield this.modalController.create({component:oe,componentProps:{id_ticket:e,type:t},cssClass:"my-custom-class"});return yield i.present()})}imageEnd(e,t){return Object(c.a)(this,void 0,void 0,function*(){const i=yield this.modalController.create({component:oe,componentProps:{id_ticket:e,type:t},cssClass:"my-custom-class"});return yield i.present()})}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(b.a),d.Lb(l.a),d.Lb(m.a),d.Lb(r.a),d.Lb(r.T))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-datatable-ticket"]],viewQuery:function(e,t){if(1&e&&d.Bc(n.d,1),2&e){let e;d.mc(e=d.Zb())&&(t.table=e.first)}},decls:41,vars:33,consts:[["size","8"],["size","4"],["type","button","expand","full",3,"routerLink","queryParams"],["position","floating"],["type","text",3,"keyup"],["rowHeight","auto",1,"material","expandable",3,"loadingIndicator","rows","limit","columnMode","headerHeight","footerHeight","scrollbarH","page"],["table",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","Cod Proyect",3,"width"],["name","Name Proyect",3,"width"],["name","Num",3,"width"],["name","PCO#",3,"width"],["name","Date Ticket",3,"width"],["name","Schelude",3,"width"],["name","User",3,"width"],["size","small",3,"routerLink"],["name","create-outline"],["size","small",3,"click"],["name","trash-outline"],["name","mail-outline"],["color","danger",4,"ngIf","ngIfElse"],["noFirmaForeman",""],["noFirmaClient",""],["name","images-outline"],["color","danger"],["color","primary"],["title","Expand/Collapse Row",3,"click"],[3,"innerHTML"]],template:function(e,t){1&e&&(d.Qb(0,"ion-row"),d.Qb(1,"ion-col",0),d.Qb(2,"h5"),d.Qb(3,"strong"),d.wc(4,"Ticket - Proyect :"),d.Pb(),d.Mb(5,"br"),d.wc(6),d.Mb(7,"br"),d.Qb(8,"strong"),d.wc(9,"Id :"),d.Pb(),d.wc(10),d.Pb(),d.Pb(),d.Qb(11,"ion-col",1),d.Mb(12,"br"),d.Qb(13,"ion-button",2),d.wc(14," New ticket"),d.Pb(),d.Pb(),d.Pb(),d.Qb(15,"ion-item"),d.Qb(16,"ion-label",3),d.wc(17,"Search"),d.Pb(),d.Qb(18,"ion-input",4),d.Yb("keyup",function(e){return t.updateFilter(e)}),d.Pb(),d.Pb(),d.Mb(19,"br"),d.Qb(20,"ngx-datatable",5,6),d.Yb("page",function(e){return t.onPage(e)}),d.Qb(22,"ngx-datatable-row-detail",7,8),d.Yb("toggle",function(e){return t.onDetailToggle(e)}),d.uc(24,de,49,7,"ng-template",9),d.Pb(),d.Qb(25,"ngx-datatable-column",10),d.uc(26,be,1,4,"ng-template",11),d.Pb(),d.Qb(27,"ngx-datatable-column",12),d.uc(28,ue,1,1,"ng-template",11),d.Pb(),d.Qb(29,"ngx-datatable-column",13),d.uc(30,he,1,1,"ng-template",11),d.Pb(),d.Qb(31,"ngx-datatable-column",14),d.uc(32,me,1,1,"ng-template",11),d.Pb(),d.Qb(33,"ngx-datatable-column",15),d.uc(34,pe,1,1,"ng-template",11),d.Pb(),d.Qb(35,"ngx-datatable-column",16),d.uc(36,ge,1,1,"ng-template",11),d.Pb(),d.Qb(37,"ngx-datatable-column",17),d.uc(38,fe,1,1,"ng-template",11),d.Pb(),d.Qb(39,"ngx-datatable-column",18),d.uc(40,we,1,1,"ng-template",11),d.Pb(),d.Pb()),2&e&&(d.zb(6),d.yc("",t.proyect," "),d.zb(4),d.yc(" ",t.param_id," "),d.zb(3),d.gc("routerLink",d.ic(24,ve))("queryParams",d.lc(25,ye,t.nameProyecto,t.dirrecion,t.nameForeman,t.param_id,t.id_proyecto,t.generalContractor,t.codigo)),d.zb(7),d.gc("loadingIndicator",t.loadingIndicator)("rows",t.rows)("limit",15)("columnMode",t.ColumnMode.force)("headerHeight",50)("footerHeight",50)("scrollbarH",t.scrollBarHorizontal),d.zb(2),d.gc("rowHeight",95),d.zb(3),d.gc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),d.zb(2),d.gc("width",100),d.zb(2),d.gc("width",200),d.zb(2),d.gc("width",60),d.zb(2),d.gc("width",100),d.zb(2),d.gc("width",110),d.zb(2),d.gc("width",100),d.zb(2),d.gc("width",200))},directives:[r.E,r.m,r.e,r.Y,l.h,r.v,r.w,r.u,r.ab,n.d,n.e,n.f,n.c,n.b,r.q,r.s,a.k,r.l],styles:['.ngx-datatable{display:block;overflow:hidden;justify-content:center;position:relative;transform:translateZ(0)}.ngx-datatable [hidden]{display:none!important}.ngx-datatable *,.ngx-datatable :after,.ngx-datatable :before{box-sizing:border-box}.ngx-datatable.scroll-vertical .datatable-body{overflow-y:auto}.ngx-datatable.scroll-vertical.virtualized .datatable-body .datatable-row-wrapper{position:absolute}.ngx-datatable.scroll-horz .datatable-body{overflow-x:auto;-webkit-overflow-scrolling:touch}.ngx-datatable.fixed-header .datatable-header .datatable-header-inner{white-space:nowrap}.ngx-datatable.fixed-header .datatable-header .datatable-header-inner .datatable-header-cell{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ngx-datatable.fixed-row .datatable-scroll,.ngx-datatable.fixed-row .datatable-scroll .datatable-body-row{white-space:nowrap}.ngx-datatable.fixed-row .datatable-scroll .datatable-body-row .datatable-body-cell,.ngx-datatable.fixed-row .datatable-scroll .datatable-body-row .datatable-body-group-cell{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ngx-datatable .datatable-body-row,.ngx-datatable .datatable-header-inner,.ngx-datatable .datatable-row-center{display:flex;flex-direction:row;-o-flex-flow:row;flex-flow:row}.ngx-datatable .datatable-body-cell,.ngx-datatable .datatable-header-cell{overflow-x:hidden;vertical-align:top;display:inline-block;line-height:1.625}.ngx-datatable .datatable-body-cell:focus,.ngx-datatable .datatable-header-cell:focus{outline:none}.ngx-datatable .datatable-row-left,.ngx-datatable .datatable-row-right{z-index:9}.ngx-datatable .datatable-row-center,.ngx-datatable .datatable-row-group,.ngx-datatable .datatable-row-left,.ngx-datatable .datatable-row-right{position:relative}.ngx-datatable .datatable-header{display:block;overflow:hidden}.ngx-datatable .datatable-header .datatable-header-inner{align-items:stretch;-webkit-align-items:stretch}.ngx-datatable .datatable-header .datatable-header-cell{position:relative;display:inline-block}.ngx-datatable .datatable-header .datatable-header-cell.sortable .datatable-header-cell-wrapper{cursor:pointer}.ngx-datatable .datatable-header .datatable-header-cell.longpress .datatable-header-cell-wrapper{cursor:move}.ngx-datatable .datatable-header .datatable-header-cell .sort-btn{line-height:100%;vertical-align:middle;display:inline-block;cursor:pointer}.ngx-datatable .datatable-header .datatable-header-cell .resize-handle,.ngx-datatable .datatable-header .datatable-header-cell .resize-handle--not-resizable{display:inline-block;position:absolute;right:0;top:0;bottom:0;width:5px;padding:0 4px;visibility:hidden}.ngx-datatable .datatable-header .datatable-header-cell .resize-handle{cursor:ew-resize}.ngx-datatable .datatable-header .datatable-header-cell.resizeable:hover .resize-handle,.ngx-datatable .datatable-header .datatable-header-cell:hover .resize-handle--not-resizable{visibility:visible}.ngx-datatable .datatable-header .datatable-header-cell .targetMarker{position:absolute;top:0;bottom:0}.ngx-datatable .datatable-header .datatable-header-cell .targetMarker.dragFromLeft{right:0}.ngx-datatable .datatable-header .datatable-header-cell .targetMarker.dragFromRight{left:0}.ngx-datatable .datatable-header .datatable-header-cell .datatable-header-cell-template-wrap{height:inherit}.ngx-datatable .datatable-body{position:relative;z-index:10;display:block}.ngx-datatable .datatable-body .datatable-scroll{display:inline-block}.ngx-datatable .datatable-body .datatable-row-detail{overflow-y:hidden}.ngx-datatable .datatable-body .datatable-row-wrapper{display:flex;flex-direction:column}.ngx-datatable .datatable-body .datatable-body-row{outline:none}.ngx-datatable .datatable-body .datatable-body-row>div{display:flex}.ngx-datatable .datatable-footer{display:block;width:100%;overflow:auto}.ngx-datatable .datatable-footer .datatable-footer-inner{display:flex;align-items:center;width:100%}.ngx-datatable .datatable-footer .selected-count .page-count{flex:1 1 40%}.ngx-datatable .datatable-footer .selected-count .datatable-pager{flex:1 1 60%}.ngx-datatable .datatable-footer .page-count{flex:1 1 20%}.ngx-datatable .datatable-footer .datatable-pager{flex:1 1 80%;text-align:right}.ngx-datatable .datatable-footer .datatable-pager .pager,.ngx-datatable .datatable-footer .datatable-pager .pager li{padding:0;margin:0;display:inline-block;list-style:none}.ngx-datatable .datatable-footer .datatable-pager .pager li,.ngx-datatable .datatable-footer .datatable-pager .pager li a{outline:none}.ngx-datatable .datatable-footer .datatable-pager .pager li a{cursor:pointer;display:inline-block}.ngx-datatable .datatable-footer .datatable-pager .pager li.disabled a{cursor:not-allowed}@font-face{font-family:data-table;src:url(data-table.40742b4faed98d0250a5.eot);src:url(data-table.40742b4faed98d0250a5.eot?#iefix) format("embedded-opentype"),url(data-table.53c319729491b7686d65.woff) format("woff"),url(data-table.93be7e0fc94594d266a2.ttf) format("truetype"),url(data-table.7eda0c04830dac128c76.svg#data-table) format("svg");font-weight:400;font-style:normal}[data-icon]:before{content:attr(data-icon)}[class*=" datatable-icon-"]:before,[class^=datatable-icon-]:before,[data-icon]:before{font-family:data-table!important;font-style:normal!important;font-weight:400!important;font-variant:normal!important;text-transform:none!important;speak:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.datatable-icon-filter:before{content:"\\62"}.datatable-icon-collapse:before{content:"\\61"}.datatable-icon-expand:before{content:"\\63"}.datatable-icon-close:before{content:"\\64"}.datatable-icon-up:before{content:"\\65"}.datatable-icon-down:before{content:"\\66"}.datatable-icon-sort-unset:before{content:"\\63";opacity:.5}.datatable-icon-sort:before{content:"\\67"}.datatable-icon-done:before{content:"\\68"}.datatable-icon-done-all:before{content:"\\69"}.datatable-icon-search:before{content:"\\6a"}.datatable-icon-pin:before{content:"\\6b"}.datatable-icon-add:before{content:"\\6d"}.datatable-icon-left:before{content:"\\6f"}.datatable-icon-right:before{content:"\\70"}.datatable-icon-skip:before{content:"\\71"}.datatable-icon-prev:before{content:"\\72"}.ngx-datatable.material{background:#fff;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.ngx-datatable.material.striped .datatable-row-odd{background:#eee}.ngx-datatable.material.multi-click-selection .datatable-body-row.active,.ngx-datatable.material.multi-click-selection .datatable-body-row.active .datatable-row-group,.ngx-datatable.material.multi-selection .datatable-body-row.active,.ngx-datatable.material.multi-selection .datatable-body-row.active .datatable-row-group,.ngx-datatable.material.single-selection .datatable-body-row.active,.ngx-datatable.material.single-selection .datatable-body-row.active .datatable-row-group{background-color:#304ffe;color:#fff}.ngx-datatable.material.multi-click-selection .datatable-body-row.active:hover,.ngx-datatable.material.multi-click-selection .datatable-body-row.active:hover .datatable-row-group,.ngx-datatable.material.multi-selection .datatable-body-row.active:hover,.ngx-datatable.material.multi-selection .datatable-body-row.active:hover .datatable-row-group,.ngx-datatable.material.single-selection .datatable-body-row.active:hover,.ngx-datatable.material.single-selection .datatable-body-row.active:hover .datatable-row-group{background-color:#193ae4;color:#fff}.ngx-datatable.material.multi-click-selection .datatable-body-row.active:focus,.ngx-datatable.material.multi-click-selection .datatable-body-row.active:focus .datatable-row-group,.ngx-datatable.material.multi-selection .datatable-body-row.active:focus,.ngx-datatable.material.multi-selection .datatable-body-row.active:focus .datatable-row-group,.ngx-datatable.material.single-selection .datatable-body-row.active:focus,.ngx-datatable.material.single-selection .datatable-body-row.active:focus .datatable-row-group{background-color:#2041ef;color:#fff}.ngx-datatable.material:not(.cell-selection) .datatable-body-row:hover,.ngx-datatable.material:not(.cell-selection) .datatable-body-row:hover .datatable-row-group{background-color:#eee;transition-property:background;transition-duration:.3s;transition-timing-function:linear}.ngx-datatable.material:not(.cell-selection) .datatable-body-row:focus,.ngx-datatable.material:not(.cell-selection) .datatable-body-row:focus .datatable-row-group{background-color:#ddd}.ngx-datatable.material.cell-selection .datatable-body-cell:hover,.ngx-datatable.material.cell-selection .datatable-body-cell:hover .datatable-row-group{background-color:#eee;transition-property:background;transition-duration:.3s;transition-timing-function:linear}.ngx-datatable.material.cell-selection .datatable-body-cell:focus,.ngx-datatable.material.cell-selection .datatable-body-cell:focus .datatable-row-group{background-color:#ddd}.ngx-datatable.material.cell-selection .datatable-body-cell.active,.ngx-datatable.material.cell-selection .datatable-body-cell.active .datatable-row-group{background-color:#304ffe;color:#fff}.ngx-datatable.material.cell-selection .datatable-body-cell.active:hover,.ngx-datatable.material.cell-selection .datatable-body-cell.active:hover .datatable-row-group{background-color:#193ae4;color:#fff}.ngx-datatable.material.cell-selection .datatable-body-cell.active:focus,.ngx-datatable.material.cell-selection .datatable-body-cell.active:focus .datatable-row-group{background-color:#2041ef;color:#fff}.ngx-datatable.material .empty-row{height:50px}.ngx-datatable.material .empty-row,.ngx-datatable.material .loading-row{text-align:left;padding:.5rem 1.2rem;vertical-align:top;border-top:0}.ngx-datatable.material .datatable-body .datatable-row-left,.ngx-datatable.material .datatable-header .datatable-row-left{background-color:#fff;background-position:100% 0;background-repeat:repeat-y;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABCAYAAAD5PA/NAAAAFklEQVQIHWPSkNeSBmJhTQVtbiDNCgASagIIuJX8OgAAAABJRU5ErkJggg==)}.ngx-datatable.material .datatable-body .datatable-row-right,.ngx-datatable.material .datatable-header .datatable-row-right{background-position:0 0;background-color:#fff;background-repeat:repeat-y;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABCAYAAAD5PA/NAAAAFklEQVQI12PQkNdi1VTQ5gbSwkAsDQARLAIGtOSFUAAAAABJRU5ErkJggg==)}.ngx-datatable.material .datatable-header{border-bottom:1px solid rgba(0,0,0,.12)}.ngx-datatable.material .datatable-header .datatable-header-cell{text-align:left;padding:.9rem 1.2rem;font-weight:400;background-color:#fff;color:rgba(0,0,0,.54);vertical-align:bottom;font-size:12px;font-weight:500}.ngx-datatable.material .datatable-header .datatable-header-cell .datatable-header-cell-wrapper{position:relative}.ngx-datatable.material .datatable-header .datatable-header-cell.longpress .draggable:after{transition:transform .4s ease,opacity .4s ease;opacity:.5;transform:scale(1)}.ngx-datatable.material .datatable-header .datatable-header-cell .draggable:after{content:" ";position:absolute;top:50%;left:50%;margin:-30px 0 0 -30px;height:60px;width:60px;background:#eee;border-radius:100%;opacity:1;filter:none;transform:scale(0);z-index:9999;pointer-events:none}.ngx-datatable.material .datatable-header .datatable-header-cell.dragging .resize-handle{border-right:none}.ngx-datatable.material .datatable-header .resize-handle{border-right:1px solid #eee}.ngx-datatable.material .datatable-body{position:relative}.ngx-datatable.material .datatable-body .datatable-row-detail{background:#f5f5f5;padding:10px}.ngx-datatable.material .datatable-body .datatable-group-header{background:#f5f5f5;border-bottom:1px solid #d9d8d9;border-top:1px solid #d9d8d9}.ngx-datatable.material .datatable-body .datatable-body-row .datatable-body-cell,.ngx-datatable.material .datatable-body .datatable-body-row .datatable-body-group-cell{text-align:left;padding:.9rem 1.2rem;vertical-align:top;border-top:0;color:rgba(0,0,0,.87);transition:width .3s ease;font-size:14px;font-weight:400}.ngx-datatable.material .datatable-body .progress-linear{display:block;position:sticky;width:100%;height:5px;padding:0;margin:0;top:0}.ngx-datatable.material .datatable-body .progress-linear .container{display:block;position:relative;overflow:hidden;width:100%;height:5px;transform:translate(0) scale(1);background-color:#aad1f9}.ngx-datatable.material .datatable-body .progress-linear .container .bar{transition:all .2s linear;animation:query .8s cubic-bezier(.39,.575,.565,1) infinite;transition:transform .2s linear;background-color:#106cc8;position:absolute;left:0;top:0;bottom:0;width:100%;height:5px}.ngx-datatable.material .datatable-footer{border-top:1px solid rgba(0,0,0,.12);font-size:12px;font-weight:400;color:rgba(0,0,0,.54)}.ngx-datatable.material .datatable-footer .page-count{line-height:50px;height:50px;padding:0 1.2rem}.ngx-datatable.material .datatable-footer .datatable-pager{margin:0 10px}.ngx-datatable.material .datatable-footer .datatable-pager li{vertical-align:middle}.ngx-datatable.material .datatable-footer .datatable-pager li.disabled a{color:rgba(0,0,0,.26)!important;background-color:initial!important}.ngx-datatable.material .datatable-footer .datatable-pager li.active a{background-color:hsla(0,0%,62%,.2);font-weight:700}.ngx-datatable.material .datatable-footer .datatable-pager a{height:22px;min-width:24px;line-height:22px;padding:0 6px;border-radius:3px;margin:6px 3px;text-align:center;vertical-align:top;color:rgba(0,0,0,.54);text-decoration:none;vertical-align:bottom}.ngx-datatable.material .datatable-footer .datatable-pager a:hover{color:rgba(0,0,0,.75);background-color:hsla(0,0%,62%,.2)}.ngx-datatable.material .datatable-footer .datatable-pager .datatable-icon-left,.ngx-datatable.material .datatable-footer .datatable-pager .datatable-icon-prev,.ngx-datatable.material .datatable-footer .datatable-pager .datatable-icon-right,.ngx-datatable.material .datatable-footer .datatable-pager .datatable-icon-skip{font-size:20px;line-height:20px;padding:0 3px}.ngx-datatable.material .datatable-summary-row .datatable-body-row,.ngx-datatable.material .datatable-summary-row .datatable-body-row:hover{background-color:#ddd}.ngx-datatable.material .datatable-summary-row .datatable-body-row .datatable-body-cell{font-weight:700}.datatable-checkbox{position:relative;margin:0;cursor:pointer;vertical-align:middle;display:inline-block;box-sizing:border-box;padding:0}.datatable-checkbox input[type=checkbox]{position:relative;margin:0 1rem 0 0;cursor:pointer;outline:none}.datatable-checkbox input[type=checkbox]:before{transition:all .3s ease-in-out;content:"";position:absolute;left:0;z-index:1;width:1rem;height:1rem;border:2px solid #f2f2f2}.datatable-checkbox input[type=checkbox]:checked:before{transform:rotate(-45deg);height:.5rem;border-color:#009688;border-top-style:none;border-right-style:none}.datatable-checkbox input[type=checkbox]:after{content:"";position:absolute;top:0;left:0;width:1rem;height:1rem;background:#fff;cursor:pointer}@keyframes query{0%{opacity:1;transform:translateX(35%) scaleX(.3)}to{opacity:0;transform:translateX(-50%) scaleX(0)}}.ngx-datatable.dark{box-shadow:none;background:#1b1e27;border:1px solid #2f3646;color:#fff;font-size:13px}.ngx-datatable.dark .datatable-header{background:#181b24;color:#72809b}.ngx-datatable.dark .datatable-header .datatable-header-cell{text-align:left;padding:.5rem 1.2rem;font-weight:700}.ngx-datatable.dark .datatable-header .datatable-header-cell .datatable-header-cell-label{line-height:24px}.ngx-datatable.dark .datatable-body{background:#1a1e28}.ngx-datatable.dark .datatable-body .datatable-body-row{border-top:1px solid #2f3646}.ngx-datatable.dark .datatable-body .datatable-body-row .datatable-body-cell{text-align:left;padding:.5rem 1.2rem;vertical-align:top}.ngx-datatable.dark .datatable-body .datatable-body-row:hover{background:#171b24;transition-property:background;transition-duration:.3s;transition-timing-function:linear}.ngx-datatable.dark .datatable-body .datatable-body-row:focus{background-color:#232837}.ngx-datatable.dark .datatable-body .datatable-body-row.active{background-color:#1483ff;color:#fff}.ngx-datatable.dark .datatable-footer{background:#232837;color:#72809b;margin-top:-1px}.ngx-datatable.dark .datatable-footer .page-count{line-height:50px;height:50px;padding:0 1.2rem}.ngx-datatable.dark .datatable-footer .datatable-pager{margin:0 10px;vertical-align:top}.ngx-datatable.dark .datatable-footer .datatable-pager ul li{margin:10px 0}.ngx-datatable.dark .datatable-footer .datatable-pager ul li:not(.disabled).active a,.ngx-datatable.dark .datatable-footer .datatable-pager ul li:not(.disabled):hover a{background-color:#455066;font-weight:700}.ngx-datatable.dark .datatable-footer .datatable-pager a{height:22px;min-width:24px;line-height:22px;padding:0;border-radius:3px;margin:0 3px;text-align:center;vertical-align:top;text-decoration:none;vertical-align:bottom;color:#72809b}.ngx-datatable.dark .datatable-footer .datatable-pager .datatable-icon-left,.ngx-datatable.dark .datatable-footer .datatable-pager .datatable-icon-prev,.ngx-datatable.dark .datatable-footer .datatable-pager .datatable-icon-right,.ngx-datatable.dark .datatable-footer .datatable-pager .datatable-icon-skip{font-size:18px;line-height:27px;padding:0 3px}.ngx-datatable.dark .datatable-summary-row .datatable-body-row,.ngx-datatable.dark .datatable-summary-row .datatable-body-row:hover{background-color:#14171f}.ngx-datatable.dark .datatable-summary-row .datatable-body-row .datatable-body-cell{font-weight:700}@media screen and (max-width:800px){.desktop-hidden{display:initial}.mobile-hidden{display:none}}@media screen and (min-width:800px){.desktop-hidden{display:none}.mobile-hidden{display:initial}}.datatable-row-detail{width:900px;background:#fff}'],encapsulation:2}),e})(),ke=(()=>{class e{constructor(e,t,i,a){this.indexdDb=e,this.menuCrtl=t,this.toastController=i,this.sicronizacionDb=a,this.sicronizacionDb.ticketPendiente(),this.sicronizacionDb.postSyncronizacion()}ngOnInit(){}ionViewWillEnter(){this.menuCrtl.enable(!0)}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(j.a),d.Lb(r.S),d.Lb(r.bb),d.Lb(x.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-list-ticket"]],decls:13,vars:1,consts:[[3,"translucent"],["slot","start"],["slot","end"]],template:function(e,t){1&e&&(d.Qb(0,"ion-header",0),d.Qb(1,"ion-toolbar"),d.Qb(2,"ion-buttons",1),d.Mb(3,"ion-menu-button"),d.Pb(),d.Qb(4,"ion-title"),d.wc(5,"list ticket"),d.Pb(),d.Qb(6,"ion-buttons",2),d.Mb(7,"ion-back-button"),d.Pb(),d.Pb(),d.Pb(),d.Qb(8,"ion-content"),d.Qb(9,"ion-grid"),d.Qb(10,"ion-row"),d.Qb(11,"ion-col"),d.Mb(12,"app-datatable-ticket"),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&e&&d.gc("translucent",!0)},directives:[r.r,r.O,r.f,r.A,r.N,r.c,r.d,r.n,r.q,r.E,r.m,Pe],styles:[""]}),e})();const _e=[{path:"",redirectTo:"list-Activitys",pathMatch:"full"},{path:"new",component:(()=>{class e{constructor(e,t,i,a,o,n,r,s,l,c){this.serviceTicket=e,this.route=t,this.modalController=i,this.formBuilder=a,this.router=o,this.alertCtrl=n,this.routerOutlet=r,this.dbPwaService=s,this.loadingCtrl=l,this.sicronizacionDb=c,this.id_actividad=this.route.snapshot.queryParams.id_actividad,this.builderForm(this.route.snapshot.queryParams.generalContractor,this.route.snapshot.queryParams.codigo,this.route.snapshot.queryParams.nameProyecto,this.route.snapshot.queryParams.dirrecion,this.route.snapshot.queryParams.nameForeman,this.route.snapshot.queryParams.id_proyecto),this.sicronizacionDb.ticketPendiente(),this.sicronizacionDb.postSyncronizacion()}ngOnInit(){}getSignatureSuperIntendente(){return this.new_form_ticket.get("signature_superintendente").value}getSignatureForeman(){return this.new_form_ticket.get("signarute_foreman").value}builderForm(e,t,i,a,n,r){this.new_form_ticket=this.formBuilder.group({assignTicket:["",[o.q.required]],empleado_id:["",[o.q.required]],general_contractor:[e,[o.q.required]],proyect:[t,[o.q.required]],proyect_nombre:[i,[o.q.required]],proyect_address:[a,[o.q.required]],date_work:["",[o.q.required]],foreman_name:[n,[o.q.required]],pco:["",[o.q.required]],horario:["",[o.q.required]],descripcion:["",[o.q.required]],id_proyecto:[r,[o.q.required]],superintendente_name:["",[o.q.required]],finish_date:[null,[o.q.required]],materiales:[[]],imagesInicio:[[]],imagesFinal:[[]],workers:[[]],signarute_foreman:[""],signature_superintendente:[""]})}selectPersonalModal(){return Object(c.a)(this,void 0,void 0,function*(){yield this.modalController.getTop();const e=yield this.modalController.create({component:g,cssClass:"my-custom-class",swipeToClose:!0,componentProps:{tipo:"staff"}});return e.onDidDismiss().then(e=>{if(e.data){const t=e.data;this.new_form_ticket.get("empleado_id").setValue(t.id),this.new_form_ticket.get("assignTicket").setValue(t.text)}}),yield e.present()})}selectWhereModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:g,cssClass:"my-custom-class",componentProps:{tipo:"where"}});return e.onDidDismiss().then(e=>{if(e.data){const t=e.data.text,i=this.new_form_ticket.get("descripcion").value;this.new_form_ticket.get("descripcion").setValue(`${i}\n${t}`)}}),yield e.present()})}selectWhatModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:g,cssClass:"my-custom-class",componentProps:{tipo:"what"}});return e.onDidDismiss().then(e=>{if(e.data){const t=e.data.text,i=this.new_form_ticket.get("descripcion").value;this.new_form_ticket.get("descripcion").setValue(`${i}\n${t}`)}}),yield e.present()})}selectWhyModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:g,cssClass:"my-custom-class",componentProps:{tipo:"why"}});return e.onDidDismiss().then(e=>{if(e.data){const t=e.data.text,i=this.new_form_ticket.get("descripcion").value;this.new_form_ticket.get("descripcion").setValue(`${i}\n${t}`)}}),yield e.present()})}FirmaSuperIntententeModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:_,cssClass:"my-custom-class",componentProps:{tipo:"superintendete",data:this.new_form_ticket.get("signature_superintendente").value}});return e.onDidDismiss().then(e=>{e.data&&this.new_form_ticket.get("signature_superintendente").setValue(e.data)}),yield e.present()})}FirmaForemanModal(){return Object(c.a)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:_,cssClass:"my-custom-class",componentProps:{tipo:"nuevo",data:this.new_form_ticket.get("signarute_foreman").value}});return e.onDidDismiss().then(e=>{e.data&&this.new_form_ticket.get("signarute_foreman").setValue(e.data)}),yield e.present()})}isFieldValid(e){return!this.new_form_ticket.get(e).valid&&this.new_form_ticket.get(e).touched}displayFieldCss(e){return{"has-error":this.isFieldValid(e),"has-feedback":this.isFieldValid(e)}}save(){return Object(c.a)(this,void 0,void 0,function*(){if(console.log(this.new_form_ticket.value),console.log(this.new_form_ticket.status),this.new_form_ticket.valid){if(console.log("form submitted"),this.new_form_ticket.status){const e=yield this.loadingCtrl.create({cssClass:"my-custom-class",message:"Loading"});yield e.present(),this.serviceTicket.postSaveTicket(this.new_form_ticket.value,this.id_actividad).subscribe(t=>Object(c.a)(this,void 0,void 0,function*(){console.log(t),yield e.dismiss(),yield this.alert("Successfully saved"),this.router.navigate(["/ticket/list-Activitys"]),this.new_form_ticket.reset()}),t=>Object(c.a)(this,void 0,void 0,function*(){this.dbPwaService.addNewTicketPendiente(this.new_form_ticket.value,this.id_actividad).subscribe(t=>Object(c.a)(this,void 0,void 0,function*(){this.new_form_ticket.value.materiales.forEach(e=>{this.dbPwaService.addNewTicketMateriales(e,t).subscribe()}),this.new_form_ticket.value.workers.forEach(e=>{this.dbPwaService.addNewTicketClassWorker(e,t).subscribe()}),this.new_form_ticket.value.imagesInicio.forEach(e=>{this.dbPwaService.addNewTicketImageInicio(e,t).subscribe()}),this.new_form_ticket.value.imagesFinal.forEach(e=>{this.dbPwaService.addNewTicketImageFinal(e,t).subscribe()}),yield e.dismiss(),this.alert("Saved to device"),this.router.navigate(["/ticket/list-Activitys"]),this.new_form_ticket.reset()}))}))}}else this.validateAllFormFields(this.new_form_ticket),yield this.alert("Required fields");yield this.serviceTicket.deleteAllImagen()})}alert(e){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.alertCtrl.create({cssClass:"my-custom-class",header:"Alert",subHeader:e,message:"",buttons:["OK"]});yield t.present(),yield t.onDidDismiss()})}validateAllFormFields(e){Object.keys(e.controls).forEach(t=>{const i=e.get(t);i instanceof o.c?i.markAsTouched({onlySelf:!0}):i instanceof o.f&&this.validateAllFormFields(i)})}close(){this.router.navigate(["/ticket/list-Activitys"])}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(b.a),d.Lb(l.a),d.Lb(r.T),d.Lb(o.b),d.Lb(l.g),d.Lb(r.a),d.Lb(r.D),d.Lb(m.a),d.Lb(r.R),d.Lb(x.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-new-ticket"]],decls:152,vars:18,consts:[[3,"translucent"],["slot","start"],["slot","end"],[3,"formGroup"],["size","12"],["position","stacked"],["formControlName","assignTicket","placeholder","select one",3,"click"],["errorMsg","Assign ticket is required",3,"displayError"],["formControlName","general_contractor","value","","readonly","",3,"disabled"],["formControlName","proyect","value","","readonly","",3,"disabled"],["formControlName","proyect_nombre","value","","readonly","",3,"disabled"],["formControlName","proyect_address","value","","readonly","",3,"disabled"],["formControlName","date_work","placeholder","From date","displayFormat","MM/DD/YYYY"],["errorMsg","date work is required",3,"displayError"],["formControlName","foreman_name","value",""],["errorMsg","foreman name is required",3,"displayError"],["formControlName","pco","value",""],["errorMsg","pco is required",3,"displayError"],["formControlName","horario","placeholder","Select One"],["value","day"],["value","night"],["value","overtime"],["value","premium time"],["errorMsg","Total hours is required",3,"displayError"],["type","text","rows","4","formControlName","descripcion","value",""],["errorMsg","Description of work is required",3,"displayError"],["expand","full",3,"click"],["formControlName","materiales"],["formControlName","workers"],["formControlName","superintendente_name","value","","placeholder","name"],["errorMsg","superintendente name of work is required",3,"displayError"],["formControlName","finish_date","placeholder","From date","displayFormat","MM/DD/YYYY"],["errorMsg","finish date is required",3,"displayError"],["formControlName","imagesInicio",3,"tipo"],["formControlName","imagesFinal",3,"tipo"],[3,"src"],["fill","outline","slot","end",3,"click"],["name","pencil-outline"],["expand","full","color","danger",3,"click"]],template:function(e,t){1&e&&(d.Qb(0,"ion-header",0),d.Qb(1,"ion-toolbar"),d.Qb(2,"ion-buttons",1),d.Mb(3,"ion-menu-button"),d.Pb(),d.Qb(4,"ion-title"),d.wc(5,"New ticket"),d.Pb(),d.Qb(6,"ion-buttons",2),d.Mb(7,"ion-back-button"),d.Pb(),d.Pb(),d.Pb(),d.Qb(8,"ion-content"),d.Qb(9,"ion-card"),d.Mb(10,"ion-card-header"),d.Qb(11,"ion-card-content"),d.Qb(12,"form",3),d.Qb(13,"ion-grid"),d.Qb(14,"ion-row"),d.Qb(15,"ion-col",4),d.Qb(16,"ion-item"),d.Qb(17,"ion-label",5),d.wc(18,"Assign ticket to:"),d.Pb(),d.Qb(19,"ion-input",6),d.Yb("click",function(){return t.selectPersonalModal()}),d.Pb(),d.Pb(),d.Mb(20,"app-field-error-display",7),d.Pb(),d.Qb(21,"ion-card-header"),d.Qb(22,"ion-card-subtitle"),d.wc(23,"Extra Work Orden"),d.Pb(),d.Pb(),d.Qb(24,"ion-col",4),d.Qb(25,"ion-item"),d.Qb(26,"ion-label",5),d.wc(27,"General Contractor"),d.Pb(),d.Mb(28,"ion-input",8),d.Pb(),d.Pb(),d.Pb(),d.Qb(29,"ion-col",4),d.Qb(30,"ion-item"),d.Qb(31,"ion-label",5),d.wc(32,"PRECISION WALL TECH PROJECT"),d.Pb(),d.Mb(33,"ion-input",9),d.Pb(),d.Pb(),d.Qb(34,"ion-col",4),d.Qb(35,"ion-item"),d.Qb(36,"ion-label",5),d.wc(37,"Project Name"),d.Pb(),d.Mb(38,"ion-input",10),d.Pb(),d.Pb(),d.Qb(39,"ion-col",4),d.Qb(40,"ion-item"),d.Qb(41,"ion-label",5),d.wc(42,"Project Address"),d.Pb(),d.Mb(43,"ion-input",11),d.Pb(),d.Pb(),d.Qb(44,"ion-col",4),d.Qb(45,"ion-item"),d.Qb(46,"ion-label",5),d.wc(47,"Date of Work"),d.Pb(),d.Mb(48,"ion-datetime",12),d.Pb(),d.Mb(49,"app-field-error-display",13),d.Pb(),d.Qb(50,"ion-col",4),d.Qb(51,"ion-item"),d.Qb(52,"ion-label",5),d.wc(53,"Foreman Name"),d.Pb(),d.Mb(54,"ion-input",14),d.Pb(),d.Mb(55,"app-field-error-display",15),d.Pb(),d.Qb(56,"ion-col",4),d.Qb(57,"ion-item"),d.Qb(58,"ion-label",5),d.wc(59,"PCO#"),d.Pb(),d.Mb(60,"ion-input",16),d.Pb(),d.Mb(61,"app-field-error-display",17),d.Pb(),d.Qb(62,"ion-col",4),d.Qb(63,"ion-item"),d.Qb(64,"ion-label",5),d.wc(65,"Total hours before this ticket"),d.Pb(),d.Qb(66,"ion-select",18),d.Qb(67,"ion-select-option",19),d.wc(68,"Day"),d.Pb(),d.Qb(69,"ion-select-option",20),d.wc(70,"Night"),d.Pb(),d.Qb(71,"ion-select-option",21),d.wc(72,"Overtime"),d.Pb(),d.Qb(73,"ion-select-option",22),d.wc(74,"Premium Time"),d.Pb(),d.Pb(),d.Pb(),d.Mb(75,"app-field-error-display",23),d.Pb(),d.Qb(76,"ion-col",4),d.Qb(77,"ion-item"),d.Qb(78,"ion-label",5),d.wc(79,"Description of work: What? / Where? / Why?"),d.Pb(),d.Mb(80,"ion-textarea",24),d.Pb(),d.Mb(81,"app-field-error-display",25),d.Qb(82,"ion-row"),d.Qb(83,"ion-col"),d.Qb(84,"ion-button",26),d.Yb("click",function(){return t.selectWhatModal()}),d.wc(85,"what?"),d.Pb(),d.Pb(),d.Qb(86,"ion-col"),d.Qb(87,"ion-button",26),d.Yb("click",function(){return t.selectWhereModal()}),d.wc(88,"where?"),d.Pb(),d.Pb(),d.Qb(89,"ion-col"),d.Qb(90,"ion-button",26),d.Yb("click",function(){return t.selectWhyModal()}),d.wc(91,"why?"),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Mb(92,"app-material",27),d.Mb(93,"app-workers",28),d.Qb(94,"ion-card-header"),d.Qb(95,"ion-card-subtitle"),d.wc(96,"Signer verifies PWT, has completed the work stated above under my supervision. Time and material listed above are accurate and approved"),d.Pb(),d.Pb(),d.Qb(97,"ion-row"),d.Qb(98,"ion-col",4),d.Qb(99,"ion-item"),d.Qb(100,"ion-label",5),d.wc(101,"Superintendent's Name:"),d.Pb(),d.Mb(102,"ion-input",29),d.Pb(),d.Mb(103,"app-field-error-display",30),d.Pb(),d.Qb(104,"ion-col",4),d.Qb(105,"ion-item"),d.Qb(106,"ion-label",5),d.wc(107,"Finish Date"),d.Pb(),d.Mb(108,"ion-datetime",31),d.Pb(),d.Mb(109,"app-field-error-display",32),d.Pb(),d.Pb(),d.Qb(110,"ion-card-header"),d.Qb(111,"ion-card-subtitle"),d.wc(112,"Pictures taken"),d.Pb(),d.Pb(),d.Qb(113,"ion-item"),d.Qb(114,"ion-label",5),d.wc(115,"Previous Images"),d.Pb(),d.Pb(),d.Qb(116,"ion-col",4),d.Mb(117,"app-images",33),d.Pb(),d.Qb(118,"ion-item"),d.Qb(119,"ion-label",5),d.wc(120,"Final Images"),d.Pb(),d.Pb(),d.Qb(121,"ion-col",4),d.Mb(122,"app-images",34),d.Pb(),d.Qb(123,"ion-col",4),d.Qb(124,"ion-row"),d.Qb(125,"ion-col"),d.Qb(126,"ion-card"),d.Qb(127,"ion-card-header"),d.Qb(128,"ion-card-subtitle"),d.wc(129,"Superintendent's Signature"),d.Pb(),d.Pb(),d.Mb(130,"ion-img",35),d.Qb(131,"ion-item"),d.Qb(132,"ion-button",36),d.Yb("click",function(){return t.FirmaSuperIntententeModal()}),d.Mb(133,"ion-icon",37),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(134,"ion-col"),d.Qb(135,"ion-card"),d.Qb(136,"ion-card-header"),d.Qb(137,"ion-card-subtitle"),d.wc(138,"Foreman Signature"),d.Pb(),d.Pb(),d.Mb(139,"ion-img",35),d.Qb(140,"ion-item"),d.Qb(141,"ion-button",36),d.Yb("click",function(){return t.FirmaForemanModal()}),d.Mb(142,"ion-icon",37),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(143,"ion-footer"),d.Qb(144,"ion-grid"),d.Qb(145,"ion-row"),d.Qb(146,"ion-col"),d.Qb(147,"ion-button",26),d.Yb("click",function(){return t.save()}),d.wc(148,"Save"),d.Pb(),d.Pb(),d.Qb(149,"ion-col"),d.Qb(150,"ion-button",38),d.Yb("click",function(){return t.close()}),d.wc(151,"Close"),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.gc("translucent",!0),d.zb(12),d.gc("formGroup",t.new_form_ticket),d.zb(8),d.gc("displayError",t.isFieldValid("assignTicket")),d.zb(8),d.gc("disabled",!0),d.zb(5),d.gc("disabled",!0),d.zb(5),d.gc("disabled",!0),d.zb(5),d.gc("disabled",!0),d.zb(6),d.gc("displayError",t.isFieldValid("date_work")),d.zb(6),d.gc("displayError",t.isFieldValid("foreman_name")),d.zb(6),d.gc("displayError",t.isFieldValid("pco")),d.zb(14),d.gc("displayError",t.isFieldValid("horario")),d.zb(6),d.gc("displayError",t.isFieldValid("descripcion")),d.zb(22),d.gc("displayError",t.isFieldValid("superintendente_name")),d.zb(6),d.gc("displayError",t.isFieldValid("finish_date")),d.zb(8),d.gc("tipo","Previous"),d.zb(5),d.gc("tipo","Final"),d.zb(8),d.gc("src",t.getSignatureSuperIntendente()||"assets/img/signature.png"),d.zb(9),d.gc("src",t.getSignatureForeman()||"assets/img/signature.png"))},directives:[r.r,r.O,r.f,r.A,r.N,r.c,r.d,r.n,r.g,r.i,r.h,o.r,o.m,o.g,r.q,r.E,r.m,r.v,r.w,r.u,r.ab,o.l,o.e,M,r.j,r.o,r.Z,r.G,r.H,r.L,r.e,F,T,h,r.t,r.s,r.p],styles:[""]}),e})()},{path:"edit/:id",component:D},{path:"select",component:g},{path:"camera",component:h},{path:"list-Activitys",component:Z},{path:"list-tickets/:id",component:ke}];let xe=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({imports:[[l.j.forChild(_e)],l.j]}),e})(),Qe=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({providers:[b.a,m.a],imports:[[a.c,o.h,r.P,xe,n.g,s.b,o.o]]}),e})()}}]);