(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{nnsM:function(t,o,i){"use strict";i.r(o),i.d(o,"AsistenciaPageModule",function(){return j});var n=i("ofXK"),e=i("3Pt+"),c=i("TEn/"),s=i("tyNb"),a=i("mrSG"),r=i("wd/R"),b=i("fXoL"),l=i("Y6JD"),d=i("Wljr");function h(t,o){if(1&t&&(b.Qb(0,"ion-row",5),b.Ob(1,6),b.Qb(2,"ion-col",1),b.vc(3),b.Pb(),b.Qb(4,"ion-col",2),b.vc(5),b.Pb(),b.Qb(6,"ion-col",2),b.vc(7),b.Qb(8,"ion-thumbnail",7),b.Mb(9,"ion-img",8),b.Pb(),b.Pb(),b.Qb(10,"ion-col",2),b.vc(11),b.Qb(12,"ion-thumbnail",7),b.Mb(13,"ion-img",8),b.Pb(),b.Pb(),b.Qb(14,"ion-col",3),b.Qb(15,"ion-button",9),b.vc(16,"Exit"),b.Pb(),b.Pb(),b.Nb(),b.Pb()),2&t){const t=o.index,i=b.ac();b.zb(1),b.gc("formGroup",i.getFormGroupAt(t)),b.zb(2),b.wc(t+1),b.zb(2),b.xc(" ",i.getFormGroupAt(t).get("nickname").value," "),b.zb(2),b.xc(" ",i.getFormGroupAt(t).get("Hora_Ingreso").value," "),b.zb(2),b.gc("src","https://sof77.com/pwt/fotos/"+i.getFormGroupAt(t).get("foto_ingreso").value),b.zb(2),b.xc(" ",i.getFormGroupAt(t).get("Hora_Salida").value," "),b.zb(2),b.gc("src","https://sof77.com/pwt/fotos/"+i.getFormGroupAt(t).get("foto_salida").value)}}let u=(()=>{class t{constructor(t){this.indexdbAsistencia=t,this.onChange=t=>{},this.onTouch=()=>{}}ngOnInit(){}writeValue(t){console.log(t),this.personal=new e.a(t.map(t=>new e.f({id:new e.c(t.id),nickname:new e.c(t.nickname),nombre:new e.c(t.nombre),Hora_Salida:new e.c(t.Hora_Salida),Hora_Ingreso:new e.c(t.Hora_Ingreso),fecha:new e.c(t.fecha),registro_diario_id:new e.c(t.registro_diario_id),actividad_id:new e.c(t.actividad_id),empleado_id:new e.c(t.empleado_id),foto_ingreso:new e.c(t.foto_ingreso),foto_salida:new e.c(t.foto_salida)}))),this.personal.valueChanges.subscribe(t=>{this.onChange(t)})}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouch=t}getFormGroupAt(t){return this.personal.at(t)}test(){this.getFormGroupAt(0).get("")}}return t.\u0275fac=function(o){return new(o||t)(b.Lb(d.a))},t.\u0275cmp=b.Fb({type:t,selectors:[["app-list-personas"]],features:[b.yb([{provide:e.j,multi:!0,useExisting:Object(b.U)(()=>t)}])],decls:12,vars:1,consts:[[1,"ion-margin"],["size","1"],["size","3"],["size","2"],["class","header-row",4,"ngFor","ngForOf"],[1,"header-row"],[3,"formGroup"],[1,"img"],[3,"src"],["size","small","expand","full"]],template:function(t,o){1&t&&(b.Qb(0,"ion-grid",0),b.Qb(1,"ion-row"),b.Mb(2,"ion-col",1),b.Qb(3,"ion-col",2),b.vc(4,"-Employee-"),b.Pb(),b.Qb(5,"ion-col",2),b.vc(6," Check In"),b.Pb(),b.Qb(7,"ion-col",2),b.vc(8," Check Out"),b.Pb(),b.Qb(9,"ion-col",3),b.vc(10,"Exit/Close"),b.Pb(),b.Pb(),b.tc(11,h,17,7,"ion-row",4),b.Pb()),2&t&&(b.zb(11),b.gc("ngForOf",o.personal.controls))},directives:[c.q,c.E,c.m,n.j,e.m,e.g,c.M,c.t,c.e],styles:[".header-row[_ngcontent-%COMP%]{background:#fff;font-size:12px}ion-col[_ngcontent-%COMP%]{border:1px solid #b3b5b6}.ion-margin[_ngcontent-%COMP%]{font-size:14px}"]}),t})();function p(t,o){if(1&t){const t=b.Rb();b.Qb(0,"ion-card",7),b.Yb("click",function(){b.oc(t);const i=o.$implicit;return b.ac().showEmpleados(i.Actividad_ID)}),b.Qb(1,"ion-card-content"),b.vc(2),b.Mb(3,"br"),b.Qb(4,"strong"),b.vc(5,"contact:"),b.Pb(),b.Mb(6,"br"),b.Qb(7,"strong"),b.vc(8,"Foreman: "),b.Pb(),b.vc(9," hector "),b.Qb(10,"strong"),b.vc(11," Lead: "),b.Pb(),b.vc(12),b.Qb(13,"strong"),b.vc(14,"PWT Super: "),b.Pb(),b.vc(15),b.Pb(),b.Pb()}if(2&t){const t=o.$implicit;b.zb(2),b.zc(" ",t.Fecha,":",t.empresa," ",t.Codigo," ",t.dirrecion," "),b.zb(10),b.xc(" ",t.Lead," "),b.zb(3),b.xc(" ",t.Pwtsuper," ")}}let g=(()=>{class t{constructor(t,o,i,n,c){this.menuCrtl=t,this.sicronizacionDb=o,this.route=i,this.indexdbAsistencia=n,this.navCtrl=c,this.fecha=this.route.snapshot.paramMap.get("fecha"),this.user=this.route.snapshot.queryParams.user,this.sicronizacionDb.verificarConection(),this.sicronizacionDb.postSyncronizacion(),this.load(),this.personal=new e.c([])}ngOnInit(){}load(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.indexdbAsistencia.getAllActividades(r(this.fecha).format("YYYY-MM-DD"),this.user);console.log(t),this.actividades=t})}ionViewWillEnter(){this.menuCrtl.enable(!0)}showEmpleados(t){return Object(a.a)(this,void 0,void 0,function*(){console.log(t);const o=yield this.indexdbAsistencia.getAllEmpleadoActividades(t).toPromise();this.personal.setValue(o)})}}return t.\u0275fac=function(o){return new(o||t)(b.Lb(c.S),b.Lb(l.a),b.Lb(s.a),b.Lb(d.a),b.Lb(c.U))},t.\u0275cmp=b.Fb({type:t,selectors:[["app-list-actividades"]],decls:21,vars:4,consts:[[3,"translucent"],["slot","start"],["slot","end"],[3,"click",4,"ngFor","ngForOf"],["size","small",3,"disabled"],["size","small"],[3,"formControl"],[3,"click"]],template:function(t,o){1&t&&(b.Qb(0,"ion-header",0),b.Qb(1,"ion-toolbar"),b.Qb(2,"ion-buttons",1),b.Mb(3,"ion-menu-button"),b.Pb(),b.Qb(4,"ion-title"),b.vc(5,"Attendance - activities list"),b.Pb(),b.Qb(6,"ion-buttons",2),b.Mb(7,"ion-back-button"),b.Pb(),b.Pb(),b.Pb(),b.Qb(8,"ion-content"),b.Qb(9,"ion-grid"),b.Qb(10,"ion-row"),b.Qb(11,"ion-col"),b.tc(12,p,16,6,"ion-card",3),b.Pb(),b.Pb(),b.Pb(),b.Qb(13,"ion-grid"),b.Qb(14,"ion-row"),b.Qb(15,"ion-col"),b.Qb(16,"ion-button",4),b.vc(17,"Records"),b.Pb(),b.Qb(18,"ion-button",5),b.vc(19,"Reports"),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Mb(20,"app-list-personas",6),b.Pb()),2&t&&(b.gc("translucent",!0),b.zb(12),b.gc("ngForOf",o.actividades),b.zb(4),b.gc("disabled",!0),b.zb(4),b.gc("formControl",o.personal))},directives:[c.r,c.O,c.f,c.A,c.N,c.c,c.d,c.n,c.q,c.E,c.m,n.j,c.e,u,e.l,e.d,c.g,c.h],styles:[""]}),t})();var m=i("tk/3"),f=i("AytR"),P=i("gcOT"),v=i("XNvx");const{Camera:Q,Filesystem:w}=P.d;let y=(()=>{class t{constructor(t,o,i){this.http=t,this.auth=o,this.api=f.a.backend.precisionWall,this.InicioPhotos=[],this.FinPhotos=[],this.Photo_storage="photos",this.convertBlobToBase64=t=>new Promise((o,i)=>{const n=new FileReader;n.onerror=i,n.onload=()=>{o(n.result)},n.readAsDataURL(t)}),this.platform=i,this.auth.getAuthUser$().subscribe(t=>{this.headers=new m.c({"Content-type":"application/json","Access-Control-Allow-Origin":"*","X-Requested-With":"XMLHttpRequest",Authorization:`Bearer ${t.token}`})}),this.headers=new m.c({"Content-type":"application/json","Access-Control-Allow-Origin":"*","X-Requested-With":"XMLHttpRequest",Authorization:`Bearer ${this.auth.getToken()}`})}addNewGalery(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield Q.getPhoto({resultType:P.a.Uri,source:P.b.Camera,quality:75,height:720,width:720});return yield this.savePicture(t)})}savePicture(t){return Object(a.a)(this,void 0,void 0,function*(){const o=yield this.readAsBase64(t),i=(new Date).getTime()+".jpeg",n=yield w.writeFile({path:i,data:o,directory:P.c.Data});return this.platform.is("hybrid"),{filepath:n.uri,webviewPath:o}})}readAsBase64(t){return Object(a.a)(this,void 0,void 0,function*(){if(this.platform.is("hybrid"))return(yield w.readFile({path:t.path})).data;{const o=yield fetch(t.webPath),i=yield o.blob();return yield this.convertBlobToBase64(i)}})}getAllActivities(t){return this.http.post(`${this.api}asistencia/list-activitis`,{from_date:t},{headers:this.headers})}getAllPersonalRegistroDiario(t,o){return this.http.post(`${this.api}asistencia/personal`,{actividadId:t,fecha:o},{headers:this.headers})}loginCheckInOut(t,o){return this.http.post(`${this.api}asistencia/personal`,{usuario:t,"contrase\xf1a":o},{headers:this.headers})}}return t.\u0275fac=function(o){return new(o||t)(b.Ub(m.a),b.Ub(v.a),b.Ub(c.X))},t.\u0275prov=b.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function z(t,o){if(1&t&&b.Mb(0,"ion-img",11),2&t){const t=b.ac();b.gc("src",t.photo.webviewPath)}}let C=(()=>{class t{constructor(t,o){this.modalController=t,this.asistenciaService=o,this.image=!1,this.clock=""}ngOnInit(){this.clockHandle=setInterval(()=>{this.clock=r().format("HH:mm:ss")},1e3)}newPhoto(){return Object(a.a)(this,void 0,void 0,function*(){this.image=!0;const t=yield this.asistenciaService.addNewGalery();this.photo=t,console.log(this.photo)})}close(){this.modalController.dismiss({dismissed:!0})}}return t.\u0275fac=function(o){return new(o||t)(b.Lb(c.T),b.Lb(y))},t.\u0275cmp=b.Fb({type:t,selectors:[["app-check"]],decls:28,vars:3,consts:[["slot","end","color","light",3,"click"],["slot","icon-only","name","close"],["padding",""],["size","12",1,"centrado"],[1,"img"],[3,"src",4,"ngIf"],["type","button",3,"click"],["name","camera-outline"],["position","stacked"],["expand","full",3,"disabled"],["expand","full",3,"click"],[3,"src"]],template:function(t,o){1&t&&(b.Qb(0,"ion-header"),b.Qb(1,"ion-toolbar"),b.Qb(2,"ion-title"),b.vc(3,"Check In "),b.Pb(),b.Qb(4,"ion-button",0),b.Yb("click",function(){return o.close()}),b.Mb(5,"ion-icon",1),b.Pb(),b.Pb(),b.Pb(),b.Qb(6,"ion-content",2),b.Qb(7,"ion-grid"),b.Qb(8,"ion-row"),b.Qb(9,"ion-col",3),b.Qb(10,"ion-thumbnail",4),b.tc(11,z,1,1,"ion-img",5),b.Pb(),b.Qb(12,"ion-button",6),b.Yb("click",function(){return o.newPhoto()}),b.Mb(13,"ion-icon",7),b.vc(14," \xa0 Capture photo "),b.Pb(),b.Pb(),b.Qb(15,"ion-col",3),b.Qb(16,"ion-label",8),b.vc(17,"Time:"),b.Pb(),b.vc(18),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Qb(19,"ion-footer"),b.Qb(20,"ion-grid"),b.Qb(21,"ion-row"),b.Qb(22,"ion-col"),b.Qb(23,"ion-button",9),b.vc(24,"Save"),b.Pb(),b.Pb(),b.Qb(25,"ion-col"),b.Qb(26,"ion-button",10),b.Yb("click",function(){return o.close()}),b.vc(27,"Close"),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb()),2&t&&(b.zb(11),b.gc("ngIf",o.photo),b.zb(7),b.xc(" ",o.clock," "),b.zb(5),b.gc("disabled",!o.photo))},directives:[c.r,c.O,c.N,c.e,c.s,c.n,c.q,c.E,c.m,c.M,n.k,c.w,c.p,c.t],styles:["ion-thumbnail[_ngcontent-%COMP%]{--size:270px}.centrado[_ngcontent-%COMP%]{text-align:center}.img[_ngcontent-%COMP%]{margin:auto;display:block}"]}),t})();function k(t,o){1&t&&(b.Qb(0,"ion-thumbnail",12),b.Mb(1,"ion-img",13),b.Pb())}function M(t,o){if(1&t&&(b.Qb(0,"p"),b.vc(1),b.Pb()),2&t){const t=b.ac().$implicit;b.zb(1),b.wc(t.Hora_Ingreso)}}function _(t,o){if(1&t){const t=b.Rb();b.Qb(0,"ion-icon",14),b.Yb("click",function(){b.oc(t);const o=b.ac().$implicit;return b.ac().ModalCheck(o.empleado_id)}),b.Pb()}}function A(t,o){1&t&&(b.Qb(0,"ion-thumbnail",12),b.Mb(1,"ion-img",13),b.Pb())}function O(t,o){if(1&t&&(b.Qb(0,"p"),b.vc(1),b.Pb()),2&t){const t=b.ac().$implicit;b.zb(1),b.wc(t.Hora_Salida)}}function I(t,o){if(1&t){const t=b.Rb();b.Qb(0,"ion-icon",14),b.Yb("click",function(){b.oc(t);const o=b.ac().$implicit;return b.ac().ModalCheck(o.empleado_id)}),b.Pb()}}function F(t,o){if(1&t&&(b.Qb(0,"ion-col",5),b.Qb(1,"ion-card"),b.Qb(2,"ion-card-header"),b.Qb(3,"ion-card-subtitle"),b.vc(4),b.Pb(),b.Pb(),b.Qb(5,"ion-card-content"),b.Qb(6,"ion-grid"),b.Qb(7,"ion-row"),b.Qb(8,"ion-col",6),b.Qb(9,"ion-label"),b.vc(10," Check In "),b.Pb(),b.tc(11,k,2,0,"ion-thumbnail",7),b.tc(12,M,2,1,"p",8),b.tc(13,_,1,0,"ng-template",null,9,b.uc),b.Pb(),b.Qb(15,"ion-col",6),b.Qb(16,"ion-label"),b.vc(17," Check Out "),b.Pb(),b.tc(18,A,2,0,"ion-thumbnail",7),b.tc(19,O,2,1,"p",8),b.tc(20,I,1,0,"ng-template",null,10,b.uc),b.Pb(),b.Pb(),b.Pb(),b.Qb(22,"ion-button",11),b.vc(23,"Detail reports"),b.Pb(),b.Pb(),b.Pb(),b.Pb()),2&t){const t=o.$implicit,i=b.mc(14),n=b.mc(21);b.zb(4),b.wc(t.nombre),b.zb(7),b.gc("ngIf",t.foto_ingreso)("ngIfElse",i),b.zb(1),b.gc("ngIf",t.foto_ingreso),b.zb(6),b.gc("ngIf",t.foto_salida)("ngIfElse",n),b.zb(1),b.gc("ngIf",t.foto_salida)}}const x=[{path:"",redirectTo:"list-activities"},{path:"list-activities/:fecha",component:g},{path:"list-employee/:actividadID",component:(()=>{class t{constructor(t,o,i,n,e){this.route=t,this.asistenciaService=o,this.indexDbService=i,this.modalController=n,this.sicronizacionDb=e,this.actividadID=parseInt(this.route.snapshot.paramMap.get("actividadID")),this.fecha=this.route.snapshot.queryParams.fecha,this.nombreProyecto=this.route.snapshot.queryParams.proyect,this.sicronizacionDb.verificarConection(),this.sicronizacionDb.postSyncronizacion()}ngOnInit(){this.listPersonalRegistroDiario()}listPersonalRegistroDiario(){const t=r(this.fecha,"dddd DD-MM-YYYY").format("YYYY-MM-DD");this.asistenciaService.getAllPersonalRegistroDiario(this.actividadID,t).subscribe(t=>{this.empleados=t})}ModalCheck(t){return Object(a.a)(this,void 0,void 0,function*(){console.log(t);const o=yield this.modalController.create({component:C,componentProps:{actividadId:this.actividadID,fecha:this.fecha},cssClass:"my-custom-class"});return yield o.present()})}}return t.\u0275fac=function(o){return new(o||t)(b.Lb(s.a),b.Lb(y),b.Lb(d.a),b.Lb(c.T),b.Lb(l.a))},t.\u0275cmp=b.Fb({type:t,selectors:[["app-list-personal"]],decls:16,vars:4,consts:[[3,"translucent"],["slot","start"],["slot","end"],[1,"ion-no-border"],["size","12",4,"ngFor","ngForOf"],["size","12"],[1,"centrado"],["class","img",4,"ngIf","ngIfElse"],[4,"ngIf"],["noFotoEntrada",""],["noFotoSalida",""],["expand","full"],[1,"img"],["src","https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQl-Iur9bkdneD-LrHY7FxrR6LxjVc0ZL0MAg&usqp=CAU"],["name","create-outline",1,"img",3,"click"]],template:function(t,o){1&t&&(b.Qb(0,"ion-header",0),b.Qb(1,"ion-toolbar"),b.Qb(2,"ion-buttons",1),b.Mb(3,"ion-menu-button"),b.Pb(),b.Qb(4,"ion-title"),b.vc(5,"Attendance - employee list"),b.Pb(),b.Qb(6,"ion-buttons",2),b.Mb(7,"ion-back-button"),b.Pb(),b.Pb(),b.Pb(),b.Qb(8,"ion-content"),b.Qb(9,"ion-grid"),b.Qb(10,"ion-header",3),b.Qb(11,"ion-toolbar"),b.Qb(12,"ion-title"),b.vc(13),b.Pb(),b.Pb(),b.Pb(),b.Qb(14,"ion-row"),b.tc(15,F,24,7,"ion-col",4),b.Pb(),b.Pb(),b.Pb()),2&t&&(b.gc("translucent",!0),b.zb(13),b.yc("Proyect - ",o.nombreProyecto," || ",o.fecha,""),b.zb(2),b.gc("ngForOf",o.empleados))},directives:[c.r,c.O,c.f,c.A,c.N,c.c,c.d,c.n,c.q,c.E,n.j,c.m,c.g,c.i,c.j,c.h,c.w,n.k,c.e,c.M,c.t,c.s],styles:["ion-thumbnail[_ngcontent-%COMP%]{--size:120px}.centrado[_ngcontent-%COMP%]{text-align:center}.img[_ngcontent-%COMP%]{margin:auto;display:block}ion-icon[_ngcontent-%COMP%]{font-size:120px}"]}),t})()}];let D=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=b.Jb({type:t}),t.\u0275inj=b.Ib({imports:[[s.j.forChild(x)],s.j]}),t})();var L=i("lDzL");let j=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=b.Jb({type:t}),t.\u0275inj=b.Ib({imports:[[n.c,e.h,c.P,D,L.g,m.b,e.o]]}),t})()}}]);